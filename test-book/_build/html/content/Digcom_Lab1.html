
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Lab Exercise 1: Introduction &#8212; Interactive Digital Communtications</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script src="../_static/tabs.js?v=3ee01567"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/Digcom_Lab1';</script>
    <script src="../_static/custom.js?v=8345a7c9"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Lab Exercise 2: Digital Filters" href="Digcom_Lab2.html" />
    <link rel="prev" title="Interactive python interpreter (IPython) notebook" href="../digital_communications_intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Interactive Digital Communtications - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Interactive Digital Communtications - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Intro to Digital Communications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../digital_communications_intro.html">Interactive python interpreter (IPython) notebook</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lab Exercises</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Lab Exercise 1: Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Digcom_Lab2.html">Lab Exercise 2: Digital Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="Digcom_Lab3.html">Lab Exercise 3: Matched Filters and L-ASK</a></li>
<li class="toctree-l1"><a class="reference internal" href="Digcom_Lab4.html">Lab Exercise 4: Nyquist signaling and L-ASK</a></li>
<li class="toctree-l1"><a class="reference internal" href="Digcom_Lab5.html">Εργαστηριακή Άσκηση 5</a></li>
<li class="toctree-l1"><a class="reference internal" href="Digcom_Lab6.html">Εργαστηριακή Άσκηση 6</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ntua-el17840/Interactive-Digital-Communications" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ntua-el17840/Interactive-Digital-Communications/issues/new?title=Issue%20on%20page%20%2Fcontent/Digcom_Lab1.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/content/Digcom_Lab1.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lab Exercise 1: Introduction</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup">Setup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-packages-we-will-need-later-in-python">Importing packages we will need later in Python</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1-training">Part 1: Training</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-scalar-one-dimensional-quantity">Create a scalar (one-dimensional) quantity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-vector-of-real-values">Create a vector of real values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-matrix-of-real-values">Create a matrix of real values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sum">Sum</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiply">Multiply</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiply-element-wise">Multiply element-wise</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#check-the-length-of-a-vector">Check the length of a vector</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#check-the-size-of-a-matrix">Check the size of a matrix</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#access-specific-elements-of-a-matrix-part-1">Access specific elements of a matrix (Part 1)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#access-specific-elements-of-a-matrix-part-2">Access specific elements of a matrix (Part 2)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#access-a-specific-segment-of-a-vector">Access a specific segment of a vector</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#access-specific-segments-of-a-matrix">Access specific segments of a matrix</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-vector-with-elements-from-0-to-0-5-with-a-step-of-0-1">Create a vector with elements from 0 to 0.5 with a step of 0.1</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2-theory">Part 2: Theory</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-digitization">Sampling - Digitization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spectral-analysis">Spectral Analysis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application-in-practice">Application in Practice</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-sine-wave-signal">Create a sine wave signal</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-discrete-fourier-transform-of-the-sine-wave-signal">Plot the discrete Fourier transform of the sine wave signal</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-periodogram">Plot the periodogram</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-power-of-the-sine-wave-signal">Calculate the power of the sine wave signal</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-3-application-a">Part 3: Application A</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-signal-creation-and-display">Step 1: Signal creation and display</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-add-noise-to-the-signal">Step 2: Add noise to the signal</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-multiplication-of-signals">Step 3: Multiplication of signals</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-4-application-b">Part 4: Application B</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="lab-exercise-1-introduction">
<h1>Lab Exercise 1: Introduction<a class="headerlink" href="#lab-exercise-1-introduction" title="Link to this heading">#</a></h1>
<p>The purpose of the first set of exercises is, on one hand, to familiarize with the programming environment of Python and Matlab, and on the other hand, to introduce the methods of representation and processing of telecommunication signals in these specific programming languages.</p>
<section id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Link to this heading">#</a></h2>
<div class="admonition-live-code admonition">
<p class="admonition-title">Live Code</p>
<p>Press the following button to make python code interactive. It will connect you to a kernel once it says “ready” (might take a bit, especially the first time it runs).</p>
</div>
<div style="text-align: center;">
  <button title="Launch thebe" class="thebelab-button thebe-launch-button" onclick="initThebe()">Python Interactive Code</button>
</div>
<section id="importing-packages-we-will-need-later-in-python">
<h3>Importing packages we will need later in Python<a class="headerlink" href="#importing-packages-we-will-need-later-in-python" title="Link to this heading">#</a></h3>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--1">Python</label><div class="tab-content docutils">
<div class="cell tag_thebe-init docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre id="codecell1"><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="c1"># Ανατρέξτε στην τεκμηρίωση της βιβλιοθήκης scipy.signal</span>
<span class="c1"># https://docs.scipy.org/doc/scipy/reference/signal.html</span>
<span class="kn">from</span> <span class="nn">scipy.fft</span> <span class="kn">import</span> <span class="n">fft</span><span class="p">,</span> <span class="n">fftfreq</span>
<span class="kn">from</span> <span class="nn">scipy.fftpack</span> <span class="kn">import</span> <span class="n">fftshift</span><span class="p">,</span> <span class="n">ifftshift</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">random</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">'ignore'</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">IntRangeSlider</span><span class="p">,</span> <span class="n">widgets</span><span class="p">,</span> <span class="n">Layout</span><span class="p">,</span> <span class="n">HBox</span><span class="p">,</span> <span class="n">VBox</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">clear_output</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Libraries added successfully!"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="part-1-training">
<h2>Part 1: Training<a class="headerlink" href="#part-1-training" title="Link to this heading">#</a></h2>
<section id="create-a-scalar-one-dimensional-quantity">
<h3>Create a scalar (one-dimensional) quantity<a class="headerlink" href="#create-a-scalar-one-dimensional-quantity" title="Link to this heading">#</a></h3>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--1">Python</label><div class="tab-content docutils">
<div class="cell tag_thebe-init docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre id="codecell2"><span></span><span class="n">s</span><span class="o">=</span><span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;s =&#39;</span><span class="p">,</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="nb">disp</span><span class="p">([</span><span class="s">&#39;s = &#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">num2str</span><span class="p">(</span><span class="n">s</span><span class="p">)]);</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-a-vector-of-real-values">
<h3>Create a vector of real values<a class="headerlink" href="#create-a-vector-of-real-values" title="Link to this heading">#</a></h3>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--1">Python</label><div class="tab-content docutils">
<div class="cell tag_thebe-init docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre id="codecell4"><span></span><span class="n">v</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'v ='</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<input class="tab-input" id="tab-set--2-input--2" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">v</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">];</span>
<span class="nb">disp</span><span class="p">([</span><span class="s">&#39;v = &#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">mat2str</span><span class="p">(</span><span class="n">v</span><span class="p">)]);</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-a-matrix-of-real-values">
<h3>Create a matrix of real values<a class="headerlink" href="#create-a-matrix-of-real-values" title="Link to this heading">#</a></h3>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--3-input--1" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--1">Python</label><div class="tab-content docutils">
<div class="cell tag_thebe-init docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre id="codecell6"><span></span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'a ='</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<input class="tab-input" id="tab-set--3-input--2" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">;</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">;</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">];</span>
<span class="nb">disp</span><span class="p">([</span><span class="s">&#39;a = &#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">mat2str</span><span class="p">(</span><span class="n">a</span><span class="p">)]);</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="sum">
<h3>Sum<a class="headerlink" href="#sum" title="Link to this heading">#</a></h3>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--4-input--1" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--1">Python</label><div class="tab-content docutils">
<div class="cell tag_thebe-init docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre id="codecell8"><span></span><span class="n">a</span><span class="o">+</span><span class="mi">5</span>
</pre></div>
</div>
</div>
</div>
</div>
<input class="tab-input" id="tab-set--4-input--2" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">a_plus_5</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="nb">disp</span><span class="p">(</span><span class="n">a_plus_5</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="multiply">
<h3>Multiply<a class="headerlink" href="#multiply" title="Link to this heading">#</a></h3>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--5-input--1" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--1">Python</label><div class="tab-content docutils">
<div class="cell tag_thebe-init docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre id="codecell10"><span></span><span class="n">b</span><span class="o">=</span><span class="n">s</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'b='</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<input class="tab-input" id="tab-set--5-input--2" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="nb">disp</span><span class="p">([</span><span class="s">&#39;b = &#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">mat2str</span><span class="p">(</span><span class="n">b</span><span class="p">)]);</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="multiply-element-wise">
<h3>Multiply element-wise<a class="headerlink" href="#multiply-element-wise" title="Link to this heading">#</a></h3>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--6-input--1" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--1">Python</label><div class="tab-content docutils">
<div class="cell tag_thebe-init docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre id="codecell12"><span></span><span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<input class="tab-input" id="tab-set--6-input--2" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">elementwise_product</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">.*</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="nb">disp</span><span class="p">(</span><span class="n">elementwise_product</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="check-the-length-of-a-vector">
<h3>Check the length of a vector<a class="headerlink" href="#check-the-length-of-a-vector" title="Link to this heading">#</a></h3>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--7-input--1" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--1">Python</label><div class="tab-content docutils">
<div class="cell tag_thebe-init docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre id="codecell14"><span></span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<input class="tab-input" id="tab-set--7-input--2" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">length_v</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">length</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="nb">disp</span><span class="p">(</span><span class="n">length_v</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="check-the-size-of-a-matrix">
<h3>Check the size of a matrix<a class="headerlink" href="#check-the-size-of-a-matrix" title="Link to this heading">#</a></h3>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--8-input--1" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--1">Python</label><div class="tab-content docutils">
<div class="cell tag_thebe-init docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre id="codecell16"><span></span><span class="n">a</span><span class="o">.</span><span class="n">shape</span>   <span class="c1"># για array: np.array(a.shape)</span>
</pre></div>
</div>
</div>
</div>
</div>
<input class="tab-input" id="tab-set--8-input--2" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">shape_a</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">size</span><span class="p">(</span><span class="n">a</span><span class="p">);</span><span class="w">  </span><span class="c">% This will return a 2-element vector: [rows, columns]</span>
<span class="nb">disp</span><span class="p">(</span><span class="n">shape_a</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="access-specific-elements-of-a-matrix-part-1">
<h3>Access specific elements of a matrix (Part 1)<a class="headerlink" href="#access-specific-elements-of-a-matrix-part-1" title="Link to this heading">#</a></h3>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--9-input--1" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--1">Python</label><div class="tab-content docutils">
<div class="cell tag_thebe-init docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre id="codecell18"><span></span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>   <span class="c1"># Η δεικτοδότηση αρχίζει από το 0</span>
</pre></div>
</div>
</div>
</div>
</div>
<input class="tab-input" id="tab-set--9-input--2" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">element_0_1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span><span class="w">  </span><span class="c">% MATLAB indexing starts at 1</span>
<span class="nb">disp</span><span class="p">(</span><span class="n">element_0_1</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="access-specific-elements-of-a-matrix-part-2">
<h3>Access specific elements of a matrix (Part 2)<a class="headerlink" href="#access-specific-elements-of-a-matrix-part-2" title="Link to this heading">#</a></h3>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--10-input--1" name="tab-set--10" type="radio"><label class="tab-label" for="tab-set--10-input--1">Python</label><div class="tab-content docutils">
<div class="cell tag_thebe-init docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre id="codecell20"><span></span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>   <span class="c1"># Αρνητικές τιμές μετρούν από το τέλος, π.χ. το -1 αναφέρεται στο τελευταίο στοιχείο</span>
</pre></div>
</div>
</div>
</div>
</div>
<input class="tab-input" id="tab-set--10-input--2" name="tab-set--10" type="radio"><label class="tab-label" for="tab-set--10-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">element_1_end</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="k">end</span><span class="p">);</span><span class="w">  </span><span class="c">% &#39;end&#39; keyword is used for the last element in MATLAB</span>
<span class="nb">disp</span><span class="p">(</span><span class="n">element_1_end</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="access-a-specific-segment-of-a-vector">
<h3>Access a specific segment of a vector<a class="headerlink" href="#access-a-specific-segment-of-a-vector" title="Link to this heading">#</a></h3>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--11-input--1" name="tab-set--11" type="radio"><label class="tab-label" for="tab-set--11-input--1">Python</label><div class="tab-content docutils">
<div class="cell tag_thebe-init docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre id="codecell22"><span></span><span class="n">v1</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="n">v2</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'v1 ='</span><span class="p">,</span><span class="n">v1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'v2 ='</span><span class="p">,</span><span class="n">v2</span><span class="p">)</span>   <span class="c1"># ΠΡΟΣΟΧΗ: τα στοιχεία [2ο,3ο] δίνονται ως 1:3 και όχι ως 1:2</span>
</pre></div>
</div>
</div>
</div>
</div>
<input class="tab-input" id="tab-set--11-input--2" name="tab-set--11" type="radio"><label class="tab-label" for="tab-set--11-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">v1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">);</span>
<span class="n">v2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="nb">disp</span><span class="p">([</span><span class="s">&#39;v1 = &#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">mat2str</span><span class="p">(</span><span class="n">v1</span><span class="p">)]);</span>
<span class="nb">disp</span><span class="p">([</span><span class="s">&#39;v2 = &#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">mat2str</span><span class="p">(</span><span class="n">v2</span><span class="p">)]);</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="access-specific-segments-of-a-matrix">
<h3>Access specific segments of a matrix<a class="headerlink" href="#access-specific-segments-of-a-matrix" title="Link to this heading">#</a></h3>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--12-input--1" name="tab-set--12" type="radio"><label class="tab-label" for="tab-set--12-input--1">Python</label><div class="tab-content docutils">
<div class="cell tag_thebe-init docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre id="codecell24"><span></span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,:]</span>   <span class="c1"># Ομοίως: οι γραμμές 1 & 2 δίνονται ως 0:2 και όχι ως 0:1</span>
</pre></div>
</div>
</div>
</div>
</div>
<input class="tab-input" id="tab-set--12-input--2" name="tab-set--12" type="radio"><label class="tab-label" for="tab-set--12-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">a_slice</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,:);</span>
<span class="nb">disp</span><span class="p">(</span><span class="n">a_slice</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-a-vector-with-elements-from-0-to-0-5-with-a-step-of-0-1">
<h3>Create a vector with elements from 0 to 0.5 with a step of 0.1<a class="headerlink" href="#create-a-vector-with-elements-from-0-to-0-5-with-a-step-of-0-1" title="Link to this heading">#</a></h3>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--13-input--1" name="tab-set--13" type="radio"><label class="tab-label" for="tab-set--13-input--1">Python</label><div class="tab-content docutils">
<div class="cell tag_thebe-init docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre id="codecell26"><span></span><span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'t='</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<input class="tab-input" id="tab-set--13-input--2" name="tab-set--13" type="radio"><label class="tab-label" for="tab-set--13-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span><span class="mf">0.1</span><span class="p">:</span><span class="mf">0.5</span><span class="p">;</span><span class="w">  </span><span class="c">% The endpoint is inclusive in MATLAB, so you might want to adjust it if you want the exact same output as NumPy</span>
<span class="n">t</span><span class="p">(</span><span class="k">end</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[];</span><span class="w">  </span><span class="c">% Remove the last element to match Python&#39;s exclusive endpoint</span>
<span class="nb">disp</span><span class="p">([</span><span class="s">&#39;t = &#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">mat2str</span><span class="p">(</span><span class="n">t</span><span class="p">)]);</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="part-2-theory">
<h2>Part 2: Theory<a class="headerlink" href="#part-2-theory" title="Link to this heading">#</a></h2>
<section id="sampling-digitization">
<h3>Sampling - Digitization<a class="headerlink" href="#sampling-digitization" title="Link to this heading">#</a></h3>
<p>Primary signals are mainly analog (continuous time). To represent and process them on our computer (or another digital machine), we must first digitize them. Consider a continuous-time signal <span class="math notranslate nohighlight">\(x(t)\)</span> with Fourier transform (Continuous Time Fourier Transform – CTFT):</p>
<div class="math notranslate nohighlight">
\[
 
X(f)=\int_{-\infty}^{\infty} x(t)e^{-j2\pi ft} dt
 
\]</div>
<p><img alt="lab1_1.png" src="../_images/lab1_1.png" /></p>
<p>By sampling <span class="math notranslate nohighlight">\(x(t)\)</span> at a rate <span class="math notranslate nohighlight">\(f_s=1/T_s\)</span>, a discrete-time signal <span class="math notranslate nohighlight">\(x(nT_s)\)</span> is produced. Mathematically, it is represented as a series of delta functions</p>
<div class="math notranslate nohighlight">
\[
 
x_\delta (t)=\sum_{n=-\infty}^{\infty}x(nT_s)\delta(t-nT_s)=x(t)\sum_{n=-\infty}^{\infty}\delta(t-nT_s)
 
\]</div>
<p>with Fourier transform</p>
<div class="math notranslate nohighlight">
\[
 
X_\delta (f)=\sum_{n=-\infty}^{\infty}x(nT_s)e^{-j2\pi fnT_s}=X(f)*1/T_s\sum_{n=-\infty}^{\infty}\delta(f-k/T_s)=1/T_s\sum_{n=-\infty}^{\infty}X(f-k/T_s)
 
\]</div>
<p>which is a periodic function.</p>
<p><img alt="lab1_2.png" src="../_images/lab1_2.png" /></p>
<p>For band-limited signals <span class="math notranslate nohighlight">\(x(t)\)</span> with bandwidth W, assuming that the sampling rate <span class="math notranslate nohighlight">\(fs ≥ 2W\)</span>, it holds that <span class="math notranslate nohighlight">\(X(f) = T_s X_\delta(f)\)</span>, <span class="math notranslate nohighlight">\(0 ≤ f ≤ W\)</span>, meaning, the signal <span class="math notranslate nohighlight">\(X(f)\)</span> results from passing the sampled <span class="math notranslate nohighlight">\(x_\delta(t)\)</span> through an ideal low-pass filter with gain <span class="math notranslate nohighlight">\(T_s\)</span>. From the previous schema, it becomes evident that if the sampling is done with a frequency less than twice the highest frequency <span class="math notranslate nohighlight">\(W\)</span> of the signal (undersampling), then “images” of the spectrum from higher frequencies appear in the signal’s frequency domain, preventing the accurate restoration of the original continuous-time signal. This phenomenon is called aliasing, and the error during the restoration of the original signal is referred to as aliasing error.
Sampling in the time domain is the basis for defining the Discrete Time Fourier Transform (DTFT). For a series of discrete numbers <span class="math notranslate nohighlight">\(x[n]\)</span>, the discrete-time Fourier transform is defined as:</p>
<div class="math notranslate nohighlight">
\[ 
 
X_d(\phi) \triangleq \sum_{n=-\infty}^{\infty} x[n] \exp (-j 2 \pi n \phi)
 
\]</div>
<p>The DTFT is a periodic function with a period of <span class="math notranslate nohighlight">\(1\)</span>, therefore, it is sufficient to compute it in the frequency interval <span class="math notranslate nohighlight">\([0,1]\)</span> or equivalently <span class="math notranslate nohighlight">\([-½,½]\)</span>. Note that the DTFT, although it arises from a series of discrete numbers <span class="math notranslate nohighlight">\(x[n]\)</span>, is a continuous function of the variable <span class="math notranslate nohighlight">\(\phi\)</span> as illustrated in the next schema.</p>
<p><img alt="lab1_3.png" src="../_images/lab1_3.png" /></p>
<p>With the series of discrete numbers arising as a result of sampling, <span class="math notranslate nohighlight">\(x[n]=x(nT_s)\)</span>, the DTFT and the Fourier transform <span class="math notranslate nohighlight">\(X_\delta(f)\)</span> of the sampled signal are connected through the correspondence <span class="math notranslate nohighlight">\(\phi ↔ f/f_s\)</span>. The common practice is to represent the ratio <span class="math notranslate nohighlight">\(f/f_s\)</span> as normalized frequency <span class="math notranslate nohighlight">\(\phi\)</span> (<span class="math notranslate nohighlight">\(f_D\)</span>, in your notes) and the real frequencies to arise as multiples of it (usually fractional). To link the DTFT with the Fourier transform <span class="math notranslate nohighlight">\(X(f)\)</span> of the signal, an additional conversion to the sampling period by multiplying by <span class="math notranslate nohighlight">\(T_s\)</span> (or dividing by <span class="math notranslate nohighlight">\(f_s\)</span>) is required.
Analogous to sampling signals in time, we can sample in the frequency domain by taking discrete values <span class="math notranslate nohighlight">\(X(kf_o)\)</span> of the Fourier transform corresponding to a frequency analysis <span class="math notranslate nohighlight">\(f_o=1/T_o\)</span>. This is equivalent to the periodic repetition of the continuous-time signal <span class="math notranslate nohighlight">\(x(t)\)</span> every <span class="math notranslate nohighlight">\(Τ_ο\)</span>, since the periodic signal</p>
<div class="math notranslate nohighlight">
\[
 
x_p(t)=\sum_{n=-\infty}^{\infty} x\left(t-n T_{o}\right)
 
\]</div>
<p>has Fourier transform</p>
<div class="math notranslate nohighlight">
\[
 
X(f) \sum_{n=-\infty}^{\infty} \exp \left(-j 2 \pi f n T_{o}\right)=X(f) \frac{1}{T_{o}} \sum_{k=-\infty}^{\infty} \delta\left(f-k / T_{o}\right)=\frac{1}{T_{o}} \sum_{k=-\infty}^{\infty} X\left(k / T_{o}\right) \delta\left(f-k / T_{o}\right)
 
\]</div>
<p>Therefore, <span class="math notranslate nohighlight">\(X[k] = X(kf_o)/Τ_o\)</span> are the coefficients of the Fourier series expansion of the periodic signal <span class="math notranslate nohighlight">\(x_p(t)\)</span>. Obviously, for signals <span class="math notranslate nohighlight">\(x(t)\)</span> of finite duration, where <span class="math notranslate nohighlight">\(x(t)=0\)</span> for <span class="math notranslate nohighlight">\(|t| ≥ T\)</span>, assuming that the period <span class="math notranslate nohighlight">\(T_o ≥ 2T\)</span>, it holds that <span class="math notranslate nohighlight">\(x(t) = x_p(t)\)</span> for <span class="math notranslate nohighlight">\(|t| ≤ T\)</span>.
In practice, signals have a very long duration to be analyzed in their entirety. Thus, we apply a rectangular time window to retain only their most significant part for the observation period and <span class="math notranslate nohighlight">\(x(t)= 0\)</span> elsewhere. In computing the DTFT <span class="math notranslate nohighlight">\(X_d(\phi)\)</span> of such a truncated signal, instead of an infinite sum, we are limited to a finite-length <span class="math notranslate nohighlight">\(L\)</span> series of numbers <span class="math notranslate nohighlight">\(x[n]\)</span>, therefore</p>
<div class="math notranslate nohighlight">
\[ 
 
X_d(\phi)=\sum_{n=0}^{L-1} x[n] \exp (-j 2 \pi n \phi)
 
\]</div>
<p>The sampling of <span class="math notranslate nohighlight">\(X_d(\phi)\)</span> in the frequency domain at <span class="math notranslate nohighlight">\(N\)</span> equidistant normalized frequencies <span class="math notranslate nohighlight">\(0\)</span>, <span class="math notranslate nohighlight">\(1/N\)</span>, <span class="math notranslate nohighlight">\(2/N\)</span>, <span class="math notranslate nohighlight">\(…\)</span>, <span class="math notranslate nohighlight">\((N-1)/N\)</span>, gives</p>
<div class="math notranslate nohighlight">
\[ 
 
X[k]=X_{d}\left(\frac{k}{N}\right)=\sum_{n=0}^{N-1} x[n] \exp \left(-j 2 \pi n \frac{k}{N}\right), \quad 0 \leq k \leq N-1
 
\]</div>
<p>where, if <span class="math notranslate nohighlight">\(N≥L\)</span>, we set <span class="math notranslate nohighlight">\(x[n]=0\)</span> for <span class="math notranslate nohighlight">\(n≥L\)</span>. The last relationship is recognized as the Discrete Fourier Transform (DFT), which for a finite series <span class="math notranslate nohighlight">\(xn\)</span>, <span class="math notranslate nohighlight">\(n=0\)</span>, <span class="math notranslate nohighlight">\(1\)</span>, <span class="math notranslate nohighlight">\(…\)</span>, <span class="math notranslate nohighlight">\(N-1\)</span>, is defined as:</p>
<div class="math notranslate nohighlight">
\[ 
 
X_{k} \triangleq \sum_{n=0}^{N-1} x_{n} \exp \left(-j 2 \pi n \frac{k}{N}\right), \quad 0 \leq k \leq N-1
 
\]</div>
<p>and its inverse is</p>
<div class="math notranslate nohighlight">
\[ 
 
x_{n}=\frac{1}{N} \sum_{k=0}^{N-1} X_{k} \exp \left(j 2 \pi n \frac{k}{N}\right), \quad 0 \leq n \leq N-1
 
\]</div>
<p>The <span class="math notranslate nohighlight">\(X_d(\phi)\)</span> as DTFT is a periodic function and if the original series xn was periodic (and we didn’t apply the window), then <span class="math notranslate nohighlight">\(X_d(\phi)\)</span> would be zero everywhere except at the sampling points <span class="math notranslate nohighlight">\(k/N\)</span>. That is, if we consider a finite-length series of numbers that repeats periodically, the discrete-time Fourier transform of it (DTFT) is also periodic and discrete. Moreover, the DFT and its inverse IDFT, if we did not limit the indices <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(k\)</span> between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(N-1\)</span>, would be periodic functions. Therefore, the finite series xn can be considered as a periodic discrete-time signal observed only during a period and the DFT, the series <span class="math notranslate nohighlight">\(X_k\)</span>, as the samples with resolution <span class="math notranslate nohighlight">\(1/N\)</span> of the DTFT <span class="math notranslate nohighlight">\(X_d(\phi)\)</span> in the domain of normalized frequencies <span class="math notranslate nohighlight">\([0,1]\)</span>, as shown in the next schema.</p>
<p><img alt="lab1_4.png" src="../_images/lab1_4.png" /></p>
</section>
<section id="spectral-analysis">
<h3>Spectral Analysis<a class="headerlink" href="#spectral-analysis" title="Link to this heading">#</a></h3>
<p>To calculate the energy or power of the waveform <span class="math notranslate nohighlight">\(x(t)\)</span>, depending on the case of the signal, it holds</p>
<div class="math notranslate nohighlight">
\[
 
E_{X}=\int_{-\infty}^{\infty} x^{2}(t) d t=\int_{-\infty}^{\infty}|X(f)|^{2} d f
 
\]</div>
<div class="math notranslate nohighlight">
\[ 
 
P_{X}=\lim _{T \rightarrow \infty} \frac{1}{T} \int_{-T / 2}^{T / 2} x^{2}(t) d t=\int_{-\infty}^{\infty} S_{X}(f) d f
 
\]</div>
<p>where for power signals <span class="math notranslate nohighlight">\(S_Χ(f)\)</span> is the power spectral density (PSD) of <span class="math notranslate nohighlight">\(x(t)\)</span>. For discrete-time signals resulting from sampling of <span class="math notranslate nohighlight">\(x(t)\)</span> with period <span class="math notranslate nohighlight">\(T_s\)</span>, the corresponding relations for calculating the energy or power become</p>
<div class="math notranslate nohighlight">
\[ 
 
E_{X}=T_{s} \sum_{n=-\infty}^{\infty} x^{2}[n]
 
\]</div>
<div class="math notranslate nohighlight">
\[ 
 
P_{X}=\lim _{N \rightarrow \infty} \frac{1}{2 N+1} \sum_{n=-N}^{N} x^{2}[n]
 
\]</div>
<p>A simple way to estimate the power spectral density of the waveform <span class="math notranslate nohighlight">\(x(t)\)</span> is to take the DTFT of the signal’s samples and then square the magnitude of the result. This estimator is called a periodogram. The periodogram of a finite-length <span class="math notranslate nohighlight">\(L\)</span> signal <span class="math notranslate nohighlight">\(x[n]\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[ 
 
P_{x x}(f) \triangleq \frac{\left|X_{d}\left(f / f_{s}\right)\right|^{2}}{f_{s} L}
 
\]</div>
<p>where <span class="math notranslate nohighlight">\(X_d(\phi)\)</span> the DTFT of the signal. As the length <span class="math notranslate nohighlight">\(L\)</span> tends to infinity, the periodogram <span class="math notranslate nohighlight">\(P_{xx}(f)\)</span> approaches the power spectral density <span class="math notranslate nohighlight">\(S_Χ(f)\)</span>. The calculation of the periodogram at a finite number of frequencies <span class="math notranslate nohighlight">\(kf_s/N\)</span>, <span class="math notranslate nohighlight">\(k=0\)</span>, <span class="math notranslate nohighlight">\(1\)</span>, <span class="math notranslate nohighlight">\(…\)</span>, <span class="math notranslate nohighlight">\(N\)</span> gives</p>
<div class="math notranslate nohighlight">
\[ 
 
P_{x x}[k]=\frac{\left|X_{k}\right|^{2}}{f_{s} L}, \quad k=0,1, \ldots, N-1
 
\]</div>
<p>where <span class="math notranslate nohighlight">\(X_k\)</span> is the DFT of the finite-length <span class="math notranslate nohighlight">\(L\)</span> series of signal samples. The power of the signal is then</p>
<div class="math notranslate nohighlight">
\[ 
 
P_{X}=\frac{1}{f_{s} L} \sum_{k=0}^{N-1}\left|X_{k}\right|^{2} f_{o}=\frac{1}{N L} \sum_{k=0}^{N-1}\left|X_{k}\right|^{2}=\frac{1}{L} \sum_{n=0}^{L-1}\left|x_{n}\right|^{2}
 
\]</div>
<p>where the last equality results from the Parseval’s theorem, which for the DFT case is expressed as:</p>
<div class="math notranslate nohighlight">
\[ 
 
\sum_{n=0}^{N-1}\left|x_{n}\right|^{2}=\frac{1}{N} \sum_{k=0}^{N-1}\left|X_{k}\right|^{2}
 
\]</div>
<p>In the special case of periodic signals we have</p>
<div class="math notranslate nohighlight">
\[ 
 
S_x(f) = \sum_{k=-\infty}^{\infty} |X[k]|^2 \delta(f - k/T_0)
 
\]</div>
<div class="math notranslate nohighlight">
\[ 
 
P_x = \sum_{k=-\infty}^{\infty} |X[k]|^2
 
\]</div>
<p>where <span class="math notranslate nohighlight">\(X[k]\)</span> are the coefficients of the Fourier series expansion and <span class="math notranslate nohighlight">\(T_o\)</span> the period of the signal.</p>
</section>
<section id="application-in-practice">
<h3>Application in Practice<a class="headerlink" href="#application-in-practice" title="Link to this heading">#</a></h3>
<section id="create-a-sine-wave-signal">
<h4>Create a sine wave signal<a class="headerlink" href="#create-a-sine-wave-signal" title="Link to this heading">#</a></h4>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Code<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--14-input--1" name="tab-set--14" type="radio"><label class="tab-label" for="tab-set--14-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># ==============================================================================</span>
<span class="c1"># 2.1 Create a Sinusoidal Signal</span>
<span class="c1"># ==============================================================================</span>
<span class="n">Fs</span> <span class="o">=</span> <span class="mi">2000</span>                  <span class="c1"># Sampling frequency in Hz</span>
<span class="n">Ts</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">Fs</span>                <span class="c1"># Sampling period in seconds</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">0.1</span>                    <span class="c1"># Signal duration in seconds</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Ts</span><span class="p">)</span>    <span class="c1"># Time vector for signal</span>
<span class="n">A</span> <span class="o">=</span> <span class="mi">1</span>                      <span class="c1"># Signal amplitude</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>  <span class="c1"># Generate sinusoidal signal</span>
<span class="n">L</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>                 <span class="c1"># Length of the signal</span>

<span class="c1"># Plot the sinusoidal signal in time domain</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Sinusoidal Signal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pause</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Pause to view the plot, press any key in the console to continue</span>



</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--14-input--2" name="tab-set--14" type="radio"><label class="tab-label" for="tab-set--14-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% ==============================================================================</span>
<span class="c">% 2.1 Create a Sinusoidal Signal</span>
<span class="c">% ==============================================================================</span>
<span class="n">Fs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2000</span><span class="p">;</span><span class="w">                 </span><span class="c">% Sampling frequency in Hz</span>
<span class="n">Ts</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">Fs</span><span class="p">;</span><span class="w">               </span><span class="c">% Sampling period in seconds</span>
<span class="n">T</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span><span class="w">                   </span><span class="c">% Signal duration in seconds</span>
<span class="n">t</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span><span class="n">Ts</span><span class="p">:</span><span class="n">T</span><span class="o">-</span><span class="n">Ts</span><span class="p">;</span><span class="w">             </span><span class="c">% Time vector for signal</span>
<span class="n">A</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">                     </span><span class="c">% Signal amplitude</span>
<span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">sin</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">pi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t</span><span class="p">);</span><span class="w"> </span><span class="c">% Generate sinusoidal signal</span>
<span class="n">L</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">length</span><span class="p">(</span><span class="n">x</span><span class="p">);</span><span class="w">             </span><span class="c">% Length of the signal</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span><span class="w">                </span><span class="c">% Plot the sinusoidal signal in time domain</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;Sinusoidal Signal&#39;</span><span class="p">);</span><span class="c">% Title for the plot</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Time (s)&#39;</span><span class="p">);</span><span class="w">        </span><span class="c">% X-axis label</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Amplitude&#39;</span><span class="p">);</span><span class="w">       </span><span class="c">% Y-axis label</span>
<span class="nb">pause</span><span class="p">;</span><span class="w">                     </span><span class="c">% Pause to view the plot, press any key to continue</span>
</pre></div>
</div>
</div>
</div>
</div>
</details><div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/162abd163ab53285efdeebfd0b8c1d8107ceacc32264c47e38badc21475160ff.png" src="../_images/162abd163ab53285efdeebfd0b8c1d8107ceacc32264c47e38badc21475160ff.png" />
</div>
</div>
</section>
<section id="plot-the-discrete-fourier-transform-of-the-sine-wave-signal">
<h4>Plot the discrete Fourier transform of the sine wave signal<a class="headerlink" href="#plot-the-discrete-fourier-transform-of-the-sine-wave-signal" title="Link to this heading">#</a></h4>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Code<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--15-input--1" name="tab-set--15" type="radio"><label class="tab-label" for="tab-set--15-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ==============================================================================</span>
<span class="c1"># 2.2 Plot Fourier Transform (FT) of the Signal</span>
<span class="c1"># ==============================================================================</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">L</span>                  <span class="c1"># Length of Fourier Transform</span>
<span class="n">Fo</span> <span class="o">=</span> <span class="n">Fs</span> <span class="o">/</span> <span class="n">N</span>                <span class="c1"># Frequency resolution</span>
<span class="n">Fx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>      <span class="c1"># Discrete Fourier Transform (DFT) of the signal</span>
<span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="n">Fo</span>  <span class="c1"># Frequency vector</span>

<span class="c1"># Plot the magnitude of the DFT</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Fx</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;FFT of the Signal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pause</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Pause to view the plot, press any key in the console to continue</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pause</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>


</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--15-input--2" name="tab-set--15" type="radio"><label class="tab-label" for="tab-set--15-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% ==============================================================================</span>
<span class="c">% 2.2 Plot Fourier Transform (FT) of the Signal</span>
<span class="c">% ==============================================================================</span>
<span class="n">N</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">;</span><span class="w">                 </span><span class="c">% Length of Fourier Transform</span>
<span class="n">Fo</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Fs</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w">               </span><span class="c">% Frequency resolution</span>
<span class="n">Fx</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">fft</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">);</span><span class="w">            </span><span class="c">% Discrete Fourier Transform (DFT) of the signal</span>
<span class="n">freq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Fo</span><span class="p">;</span><span class="w">       </span><span class="c">% Frequency vector</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">Fx</span><span class="p">));</span><span class="w">       </span><span class="c">% Plot the magnitude of the DFT</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;FFT of the Signal&#39;</span><span class="p">);</span><span class="c">% Title for the plot</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Frequency (Hz)&#39;</span><span class="p">);</span><span class="w">  </span><span class="c">% X-axis label</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Magnitude&#39;</span><span class="p">);</span><span class="w">       </span><span class="c">% Y-axis label</span>
<span class="nb">pause</span><span class="p">;</span><span class="w">                     </span><span class="c">% Pause to view the plot, press any key to continue</span>
<span class="nb">axis</span><span class="p">([</span><span class="mi">0</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">]);</span><span class="w">       </span><span class="c">% Set axis limits</span>
<span class="nb">pause</span><span class="p">;</span><span class="w">                     </span><span class="c">% Pause, press any key to continue</span>
</pre></div>
</div>
</div>
</div>
</div>
</details><div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/eddb197c3f88cd80ec8c06b0a19f4875d513359bbb1c07dc6e0663b07f5ff10a.png" src="../_images/eddb197c3f88cd80ec8c06b0a19f4875d513359bbb1c07dc6e0663b07f5ff10a.png" />
</div>
</div>
</section>
<section id="plot-the-periodogram">
<h4>Plot the periodogram<a class="headerlink" href="#plot-the-periodogram" title="Link to this heading">#</a></h4>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Code<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--16-input--1" name="tab-set--16" type="radio"><label class="tab-label" for="tab-set--16-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ==============================================================================</span>
<span class="c1"># 2.3 Plot Signal Periodogram</span>
<span class="c1"># ==============================================================================</span>
<span class="n">power</span> <span class="o">=</span> <span class="p">(</span><span class="n">Fx</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">Fx</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">Fs</span> <span class="o">*</span> <span class="n">L</span><span class="p">)</span>  <span class="c1"># Calculate spectral density</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">power</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Periodogram&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Power&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pause</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>



</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--16-input--2" name="tab-set--16" type="radio"><label class="tab-label" for="tab-set--16-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% ==============================================================================</span>
<span class="c">% 2.3 Plot Signal Periodogram</span>
<span class="c">% ==============================================================================</span>
<span class="n">power</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Fx</span><span class="w"> </span><span class="o">.*</span><span class="w"> </span><span class="nb">conj</span><span class="p">(</span><span class="n">Fx</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">Fs</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">L</span><span class="p">;</span><span class="w"> </span><span class="c">% Calculate spectral density</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span><span class="w"> </span><span class="n">power</span><span class="p">);</span><span class="w">         </span><span class="c">% Plot the periodogram</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;{\bf Periodogram}&#39;</span><span class="p">);</span><span class="c">% Title for the plot with bold characters</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Frequency (Hz)&#39;</span><span class="p">);</span><span class="w">  </span><span class="c">% X-axis label</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Power&#39;</span><span class="p">);</span><span class="w">           </span><span class="c">% Y-axis label</span>
</pre></div>
</div>
</div>
</div>
</div>
</details><div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/53bfce46baf9225a64949aee8e46dcfd86b3e2b0252db55eacc5ee4c7d8fbe35.png" src="../_images/53bfce46baf9225a64949aee8e46dcfd86b3e2b0252db55eacc5ee4c7d8fbe35.png" />
</div>
</div>
</section>
<section id="calculate-the-power-of-the-sine-wave-signal">
<h4>Calculate the power of the sine wave signal<a class="headerlink" href="#calculate-the-power-of-the-sine-wave-signal" title="Link to this heading">#</a></h4>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Code<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--17-input--1" name="tab-set--17" type="radio"><label class="tab-label" for="tab-set--17-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ==============================================================================</span>
<span class="c1"># 2.4 Calculate Signal Power</span>
<span class="c1"># ==============================================================================</span>
<span class="n">power_theory</span> <span class="o">=</span> <span class="n">A</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span>                <span class="c1"># Theoretical power based on signal amplitude</span>
<span class="n">dB</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">power_theory</span><span class="p">)</span>       <span class="c1"># Convert power to decibels (dB)</span>
<span class="n">power_time_domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">L</span>  <span class="c1"># Calculate power in time domain</span>
<span class="n">power_frequency_domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">power</span><span class="p">)</span> <span class="o">*</span> <span class="n">Fo</span>  <span class="c1"># Calculate power in frequency domain</span>

<span class="c1"># Display calculated power values</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Power (Theory): </span><span class="si">{</span><span class="n">power_theory</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Power (dB): </span><span class="si">{</span><span class="n">dB</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Power (Time Domain): </span><span class="si">{</span><span class="n">power_time_domain</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Power (Frequency Domain): </span><span class="si">{</span><span class="n">power_frequency_domain</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--17-input--2" name="tab-set--17" type="radio"><label class="tab-label" for="tab-set--17-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% ==============================================================================</span>
<span class="c">% 2.4 Calculate Signal Power</span>
<span class="c">% ==============================================================================</span>
<span class="n">power_theory</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">A</span>^<span class="mi">2</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">            </span><span class="c">% Theoretical power based on signal amplitude</span>
<span class="n">dB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">log10</span><span class="p">(</span><span class="n">power_theory</span><span class="p">);</span><span class="w">     </span><span class="c">% Convert power to decibels (dB)</span>
<span class="n">power_time_domain</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.^</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">L</span><span class="p">;</span><span class="w"> </span><span class="c">% Calculate power in time domain</span>
<span class="n">power_frequency_domain</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">power</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Fo</span><span class="p">;</span><span class="w"> </span><span class="c">% Calculate power in frequency domain</span>

<span class="c">% Display calculated power values</span>
<span class="nb">disp</span><span class="p">([</span><span class="s">&#39;Power (Theory): &#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">num2str</span><span class="p">(</span><span class="n">power_theory</span><span class="p">)]);</span>
<span class="nb">disp</span><span class="p">([</span><span class="s">&#39;Power (dB): &#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">num2str</span><span class="p">(</span><span class="n">dB</span><span class="p">)]);</span>
<span class="nb">disp</span><span class="p">([</span><span class="s">&#39;Power (Time Domain): &#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">num2str</span><span class="p">(</span><span class="n">power_time_domain</span><span class="p">)]);</span>
<span class="nb">disp</span><span class="p">([</span><span class="s">&#39;Power (Frequency Domain): &#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">num2str</span><span class="p">(</span><span class="n">power_frequency_domain</span><span class="p">)]);</span>
</pre></div>
</div>
</div>
</div>
</div>
</details><ul class="simple">
<li><p>Power (Theory): 0.5</p></li>
<li><p>Power (dB): -3.010299956639812</p></li>
<li><p>Power (Time Domain): 0.5000000000000001</p></li>
<li><p>Power (Frequency Domain): 0.5000000000000001</p></li>
</ul>
</section>
</section>
</section>
<section id="part-3-application-a">
<h2>Part 3: Application A<a class="headerlink" href="#part-3-application-a" title="Link to this heading">#</a></h2>
<section id="step-1-signal-creation-and-display">
<h3>Step 1: Signal creation and display<a class="headerlink" href="#step-1-signal-creation-and-display" title="Link to this heading">#</a></h3>
<p>Next, you will apply what you have learned in a more complex example of signal generation that includes modulation and noise addition. For convenience, incomplete PYTHON/MATLAB code with comments is provided, which you need to complete and save.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Code<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--18-input--1" name="tab-set--18" type="radio"><label class="tab-label" for="tab-set--18-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="c1"># ==============================================================================</span>
    <span class="c1"># Part 1: Create the signal</span>
    <span class="c1"># ==============================================================================</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

    <span class="c1"># Close all figure windows</span>
    <span class="n">______</span>

    <span class="c1"># Clear workspace</span>
    <span class="c1"># In Python, variables need to be explicitly deleted if needed. Typically, just overwrite or ignore.</span>

    <span class="c1"># Clear command window</span>
    <span class="c1"># This is not applicable in Python in the same way as in MATLAB.</span>

    <span class="n">Fs</span> <span class="o">=</span> <span class="mi">4000</span>  <span class="c1"># Sampling frequency in Hz</span>
    <span class="n">Ts</span> <span class="o">=</span> <span class="n">___</span>  <span class="c1"># Sampling period</span>
    <span class="n">L</span> <span class="o">=</span> <span class="mi">3000</span>  <span class="c1"># Signal length (number of samples)</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">L</span> <span class="o">*</span> <span class="n">Ts</span>  <span class="c1"># Signal duration</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="o">*</span> <span class="n">Ts</span>  <span class="c1"># Timestamps of signal calculation</span>

    <span class="c1"># Signal creation</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">200</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> \
        <span class="o">+</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">300</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span> \
        <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">400</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>

    <span class="c1"># Plot signal x in time</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Time domain plot of x&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t (sec)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># block=False allows the script to continue while the plot is shown</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">pause</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Pause for 1 second; adjust as needed</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>  <span class="c1"># Adjust axes</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">pause</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Pause for 1 second; adjust as needed</span>

    <span class="c1"># Calculate Fourier Transform</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">L</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>  <span class="c1"># FFT length</span>
    <span class="n">Fo</span> <span class="o">=</span> <span class="n">___</span>  <span class="c1"># Frequency analysis step</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="n">Fo</span>  <span class="c1"># Frequency vector</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">___</span>  <span class="c1"># DFT for N points, fill in with the correct function</span>

    <span class="c1"># Plot signal in frequency domain</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">[:</span><span class="n">N</span> <span class="o">//</span> <span class="mi">2</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="n">N</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]))</span>  <span class="c1"># Plot signal only for positive frequency values</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Frequency domain plot of x&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;f (Hz)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">pause</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># For a two-sided signal plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">f</span> <span class="o">-</span> <span class="n">Fs</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># Shift frequency vector</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>  <span class="c1"># Shift the zero to the center</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Two sided spectrum of x&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;f (Hz)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">pause</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Calculate power of signal</span>
    <span class="n">power</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">X</span><span class="p">))</span> <span class="o">/</span> <span class="n">N</span> <span class="o">/</span> <span class="n">L</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">power</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Power&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Periodogram&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">pause</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--18-input--2" name="tab-set--18" type="radio"><label class="tab-label" for="tab-set--18-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% ==============================================================================</span>
<span class="c">% Part 1 Create the signal</span>
<span class="c">% ==============================================================================</span>
<span class="n">_________</span><span class="w"> </span><span class="s">%</span><span class="w"> </span><span class="s">close</span><span class="w"> </span><span class="s">all</span><span class="w"> </span><span class="s">figure</span><span class="w"> </span><span class="s">windows</span>
<span class="n">_________</span><span class="w"> </span><span class="s">%</span><span class="w"> </span><span class="s">clear</span><span class="w"> </span><span class="s">workspace</span>
<span class="n">_________</span><span class="w"> </span><span class="s">%</span><span class="w"> </span><span class="s">clear</span><span class="w"> </span><span class="s">command</span><span class="w"> </span><span class="s">window</span>
<span class="n">Fs</span><span class="p">=</span><span class="mi">4000</span><span class="p">;</span><span class="w"> </span><span class="c">% sampling frequency 4000 Hz</span>
<span class="n">Ts</span><span class="p">=</span><span class="n">____</span><span class="p">;</span><span class="w"> </span><span class="c">% sampling period</span>
<span class="n">L</span><span class="p">=</span><span class="mi">3000</span><span class="p">;</span><span class="w"> </span><span class="c">% signal length (number of samples)</span>
<span class="n">T</span><span class="p">=</span><span class="n">L</span><span class="o">*</span><span class="n">Ts</span><span class="p">;</span><span class="w"> </span><span class="c">% signal duration</span>
<span class="n">t</span><span class="p">=</span><span class="mi">0</span><span class="p">:</span><span class="n">Ts</span><span class="p">:(</span><span class="n">L</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Ts</span><span class="p">;</span><span class="w"> </span><span class="c">% timestamps of signal calculation</span>
<span class="n">x</span><span class="p">=</span><span class="nb">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="mi">200</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="k">...</span><span class="c"> % sinusoidal signal of frequency 200 Hz</span>
<span class="o">+</span><span class="w"> </span><span class="mf">0.3</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="mi">300</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span><span class="k">...</span><span class="c"> % plus sinusoidal signal of frequency 300 Hz</span>
<span class="o">+</span><span class="w"> </span><span class="nb">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="mi">400</span><span class="o">*</span><span class="n">t</span><span class="p">);</span><span class="w"> </span><span class="c">% plus sinusoidal signal of frequency 400 Hz</span>
<span class="c">% Plot signal x in time</span>
<span class="nb">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="c">% open a new figure window</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="c">% plot the signal</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;Time domain plot of x&#39;</span><span class="p">)</span><span class="w"> </span><span class="c">% plot title</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;t (sec)&#39;</span><span class="p">)</span><span class="w"> </span><span class="c">% x axis label</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Amplitude&#39;</span><span class="p">)</span><span class="w"> </span><span class="c">% y axis label</span>
<span class="nb">pause</span><span class="w"> </span><span class="c">% pause, press any key to continue</span>
<span class="nb">axis</span><span class="p">([</span><span class="mi">0</span><span class="w"> </span><span class="mf">0.3</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="w"> </span><span class="mi">2</span><span class="p">])</span><span class="w"> </span><span class="c">% x axis values from 0 to 0.3 sec and</span>
<span class="c">% y axis values from -2 to 2</span>
<span class="nb">pause</span><span class="w"> </span><span class="c">% pause, press any key to continue</span>
<span class="c">% Calculate Fourier Transform</span>
<span class="n">N</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span>^<span class="nb">nextpow2</span><span class="p">(</span><span class="n">L</span><span class="p">);</span><span class="w"> </span><span class="c">% FFT length</span>
<span class="c">% nextpow2 calculates next power of 2</span>
<span class="c">% grater or equal to L</span>
<span class="n">Fo</span><span class="p">=</span><span class="n">____</span><span class="p">;</span><span class="w"> </span><span class="c">% frequency analysis</span>
<span class="n">f</span><span class="p">=(</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Fo</span><span class="p">;</span><span class="w"> </span><span class="c">% frequency vector</span>
<span class="n">X</span><span class="p">=</span><span class="n">________</span><span class="p">;</span><span class="w"> </span><span class="c">% DFT for Ν points</span>
<span class="c">% Plot signal in frequency domain</span>
<span class="c">% As signal is real you can plot the one sided signal(positive frequency values)</span>
<span class="nb">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="c">% open a new figure window</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">_____</span><span class="p">)),</span><span class="nb">abs</span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">_____</span><span class="p">)))</span><span class="w"> </span><span class="c">% plot signal only for positive</span>
<span class="c">%frequency values</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;Frequency domain plot of x&#39;</span><span class="p">)</span><span class="w"> </span><span class="c">% plot title</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;f (Hz)&#39;</span><span class="p">)</span><span class="w"> </span><span class="c">% set x axis label</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Amplitude&#39;</span><span class="p">)</span><span class="w"> </span><span class="c">% set y axis label</span>
<span class="nb">pause</span><span class="w"> </span><span class="c">% pause, press any key to continue</span>
<span class="c">% in order to plot the 2-sided signal you can use fftshift matlab</span>
<span class="c">% function, type help fftshift for more details</span>
<span class="nb">figure</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="c">% open a new figure window</span>
<span class="n">f</span><span class="p">=</span><span class="n">f</span><span class="o">-</span><span class="n">Fs</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="c">% shift frequency vector to the left by –Fs/2</span>
<span class="n">X</span><span class="p">=</span><span class="nb">fftshift</span><span class="p">(</span><span class="n">X</span><span class="p">);</span><span class="w"> </span><span class="c">% create 2-sided signal</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">X</span><span class="p">));</span><span class="nb">title</span><span class="p">(</span><span class="s">&#39;Two sided spectrum of x&#39;</span><span class="p">);</span><span class="w"> </span><span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;f (Hz)&#39;</span><span class="p">);</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="nb">pause</span><span class="w"> </span><span class="c">% pause, press any key to continue</span>
<span class="c">% Calculate power of signal</span>
<span class="n">power</span><span class="p">=</span><span class="n">X</span><span class="o">.*</span><span class="nb">conj</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">/</span><span class="n">N</span><span class="o">/</span><span class="n">L</span><span class="p">;</span><span class="w"> </span><span class="c">% Calculate power of signal</span>
<span class="nb">figure</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="c">% open a new figure window</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">power</span><span class="p">)</span><span class="w"> </span><span class="c">% plot signal power to frequency</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Frequency (Hz)&#39;</span><span class="p">)</span><span class="w"> </span><span class="c">% x axis label</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Power&#39;</span><span class="p">)</span><span class="w"> </span><span class="c">% y axis label</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;{\bf Periodogram}&#39;</span><span class="p">)</span><span class="w"> </span><span class="c">% plot title</span>
<span class="nb">pause</span>
</pre></div>
</div>
</div>
</div>
</div>
</details><div class="cell tag_thebe-init tag_hide-code-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Callback function to update graphs</span>
<span class="c1"># Updated callback function to accept three frequency inputs</span>

<span class="c1"># Create three IntText widgets for input frequencies</span>
<span class="n">freq1_input</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntText</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Freq 1 (Hz):&#39;</span><span class="p">,</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">freq2_input</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntText</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Freq 2 (Hz):&#39;</span><span class="p">,</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">freq3_input</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntText</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">1500</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Freq 3 (Hz):&#39;</span><span class="p">,</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Fourier transform</span>
    <span class="k">def</span> <span class="nf">nextpow2</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">*=</span> <span class="mi">2</span>
        <span class="k">return</span> <span class="n">n</span>

<span class="k">def</span> <span class="nf">update_graph</span><span class="p">(</span><span class="n">freq1</span><span class="p">,</span> <span class="n">freq2</span><span class="p">,</span> <span class="n">freq3</span><span class="p">):</span>
    <span class="n">Fs</span> <span class="o">=</span> <span class="mi">8000</span>  <span class="c1"># Hardcoded for simplicity, adjust as needed</span>
    <span class="n">Ts</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">Fs</span>
    <span class="n">L</span> <span class="o">=</span> <span class="n">Fs</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">L</span> <span class="o">*</span> <span class="n">Ts</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="o">*</span> <span class="n">Ts</span>  <span class="c1"># Adjusted to include the last sample</span>

    

    
    <span class="k">global</span> <span class="n">new_x</span>
    <span class="n">new_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">freq1</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> \
            <span class="o">+</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">freq2</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> \
            <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">freq3</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>

    
    <span class="c1"># Plotting</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
    
    <span class="c1"># Calculate the midpoint of the arrays</span>
    <span class="n">point</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_x</span><span class="p">)</span> <span class="o">//</span> <span class="mi">10</span>

    <span class="c1"># Plotting only the first half of new_x</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="n">point</span><span class="p">],</span> <span class="n">new_x</span><span class="p">[:</span><span class="n">point</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#00CC96&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Time domain plot of x&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t (sec)&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">N</span> <span class="o">=</span> <span class="n">nextpow2</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>                 <span class="c1"># Length of Fourier transform</span>
    <span class="n">Fo</span> <span class="o">=</span> <span class="n">Fs</span> <span class="o">/</span> <span class="n">N</span>                     <span class="c1"># Frequency resolution</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="n">Fo</span>        <span class="c1"># Frequency vector</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">new_x</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>            <span class="c1"># Compute DFT for N points</span>

    <span class="c1"># Frequency domain plot</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">],</span> <span class="nb">abs</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#1F77B4&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Frequency domain plot of x&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;f (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Shift frequencies to center</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">f</span> <span class="o">-</span> <span class="n">Fs</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

    <span class="c1"># Two-sided spectrum of x</span>
    <span class="n">f_shifted</span> <span class="o">=</span> <span class="n">f</span> 

    <span class="c1"># Two-sided spectrum plot</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f_shifted</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#1F77B4&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Two sided spectrum of x&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;f (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Calculate power</span>
    <span class="n">power</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">X</span><span class="p">))</span> <span class="o">/</span> <span class="n">N</span> <span class="o">/</span> <span class="n">L</span>

    <span class="c1"># Periodogram plot</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f_shifted</span><span class="p">,</span> <span class="n">power</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#1F77B4&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Periodogram&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Power&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>




<span class="n">ui</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">freq1_input</span><span class="p">,</span> <span class="n">freq2_input</span><span class="p">,</span> <span class="n">freq3_input</span><span class="p">])</span>

<span class="c1"># Adjusted to map the new frequency inputs</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">interactive_output</span><span class="p">(</span><span class="n">update_graph</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;freq1&#39;</span><span class="p">:</span> <span class="n">freq1_input</span><span class="p">,</span> <span class="s1">&#39;freq2&#39;</span><span class="p">:</span> <span class="n">freq2_input</span><span class="p">,</span> <span class="s1">&#39;freq3&#39;</span><span class="p">:</span> <span class="n">freq3_input</span><span class="p">})</span>

<span class="c1"># Display the widgets and output</span>
<span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Clear the previous plot</span>
<span class="n">display</span><span class="p">(</span><span class="n">ui</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span>  <span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">19</span><span class="p">],</span> <span class="n">line</span> <span class="mi">10</span>
    <span class="k">def</span> <span class="nf">nextpow2</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="o">^</span>
<span class="ne">IndentationError</span>: unexpected indent
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-2-add-noise-to-the-signal">
<h3>Step 2: Add noise to the signal<a class="headerlink" href="#step-2-add-noise-to-the-signal" title="Link to this heading">#</a></h3>
<p>Complete the code to create the noise signal n using the randn function. The noise vector n should be the same size as the sine wave x from the first part. Plot the noise signal in the interval from 0 to 0.2 sec and scale from -2 to 2. Calculate the periodogram of n and plot the power spectral density of the noise signal. Add the noise signal and x to get the noisy signal s. Plot the noisy signal s in the time domain in the area from 0 to 0.2 sec and scale from -2 to 2 as well as its bilateral spectrum.</p>
<div class="cell tag_thebe-init tag_hide-code-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Function to calculate the next highest power of 2</span>
<span class="k">def</span> <span class="nf">nextpow2</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">i</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">*=</span> <span class="mi">2</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">count</span>

<span class="c1"># Updated function to accept three frequency inputs</span>
<span class="k">def</span> <span class="nf">update_plots</span><span class="p">(</span><span class="n">freq1</span><span class="p">,</span> <span class="n">freq2</span><span class="p">,</span> <span class="n">freq3</span><span class="p">):</span>
    <span class="n">Fs</span> <span class="o">=</span> <span class="mi">8000</span>                    <span class="c1"># Sampling frequency</span>
    <span class="n">Ts</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">Fs</span>                    <span class="c1"># Sampling period</span>
    <span class="n">L</span> <span class="o">=</span> <span class="mi">8000</span>                     <span class="c1"># Length of signal (number of samples)</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">L</span> <span class="o">*</span> <span class="n">Ts</span>                   <span class="c1"># Duration of signal</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="o">*</span> <span class="n">Ts</span>     <span class="c1"># Time vector, adjusted to include the last sample</span>

    <span class="c1"># Create the signal using the three input frequencies</span>
    <span class="n">new_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">freq1</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.8</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">freq2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">freq3</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
    <span class="n">rand_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">new_x</span><span class="p">))</span>  <span class="c1"># Generate random noise</span>

    <span class="c1"># Plotting setup</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
    
    <span class="c1"># Time domain plot of n</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">rand_n</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#00CC96&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Time domain plot of n&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t (sec)&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># Correction for N calculation using bitwise operator</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="n">nextpow2</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>  <span class="c1"># Corrected the exponentiation operator</span>
    <span class="n">Fo</span> <span class="o">=</span> <span class="n">Fs</span> <span class="o">/</span> <span class="n">N</span>   
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="n">Fo</span>
    <span class="n">f_shifted</span> <span class="o">=</span> <span class="n">f</span> <span class="o">-</span> <span class="n">Fs</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">rand_N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">rand_n</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
    <span class="n">rand_N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">rand_N</span><span class="p">)</span>
    <span class="n">power_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">rand_N</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">rand_N</span><span class="p">))</span> <span class="o">/</span> <span class="n">N</span> <span class="o">/</span> <span class="n">L</span>
    
    <span class="c1"># Frequency domain plot of x</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f_shifted</span><span class="p">,</span> <span class="n">power_n</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#1F77B4&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Frequency domain plot of x&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;f (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># Two sided spectrum of x</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">new_x</span> <span class="o">+</span> <span class="n">rand_n</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#00CC96&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Two sided spectrum of x&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t (sec)&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># Two sided spectrum of s</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f_shifted</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">S</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#1F77B4&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Two sided spectrum of s&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;f (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Create three IntText widgets for input frequencies</span>
<span class="n">freq1_input</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntText</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Freq 1 (Hz):&#39;</span><span class="p">,</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">freq2_input</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntText</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Freq 2 (Hz):&#39;</span><span class="p">,</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">freq3_input</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntText</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">1500</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Freq 3 (Hz):&#39;</span><span class="p">,</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Display the input boxes and output</span>
<span class="n">ui</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">freq1_input</span><span class="p">,</span> <span class="n">freq2_input</span><span class="p">,</span> <span class="n">freq3_input</span><span class="p">])</span>

<span class="c1"># Adjusted to map the new frequency inputs</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">interactive_output</span><span class="p">(</span><span class="n">update_plots</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;freq1&#39;</span><span class="p">:</span> <span class="n">freq1_input</span><span class="p">,</span> <span class="s1">&#39;freq2&#39;</span><span class="p">:</span> <span class="n">freq2_input</span><span class="p">,</span> <span class="s1">&#39;freq3&#39;</span><span class="p">:</span> <span class="n">freq3_input</span><span class="p">})</span>

<span class="c1"># Display the UI</span>
<span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Clear the previous plot</span>
<span class="n">display</span><span class="p">(</span><span class="n">ui</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "b0193c4ef4944398b11043af86fcc96d", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "c51aede42242443496ceb1565fc9e89d", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
<section id="step-3-multiplication-of-signals">
<h3>Step 3: Multiplication of signals<a class="headerlink" href="#step-3-multiplication-of-signals" title="Link to this heading">#</a></h3>
<p>Complete the code for creating a sine wave signal of 1500 Hz frequency and multiply it with the previous signal s. The two signals should be of the same size. Plot the result in the time domain in the area from 0 to 0.2 sec and scale from -2 to 2 as well as in the frequency domain using the fftshift function.</p>
<div class="cell tag_thebe-init tag_hide-code-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the next highest power of 2</span>
<span class="c1"># Function to calculate the next highest power of 2</span>
<span class="k">def</span> <span class="nf">nextpow2</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">i</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">*=</span> <span class="mi">2</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">count</span>

<span class="c1"># Function to update plots with input frequencies</span>
<span class="k">def</span> <span class="nf">update_plots</span><span class="p">(</span><span class="n">freq1</span><span class="p">,</span> <span class="n">freq2</span><span class="p">,</span> <span class="n">freq3</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">freq1</span> <span class="o">&gt;</span> <span class="mi">500</span> <span class="ow">or</span> <span class="n">freq2</span> <span class="o">&gt;</span> <span class="mi">500</span> <span class="ow">or</span> <span class="n">freq3</span> <span class="o">&gt;</span> <span class="mi">500</span><span class="p">:</span>
        <span class="c1"># Clear the output and display a warning message if any frequency is greater than 500</span>
        <span class="k">with</span> <span class="n">output</span><span class="p">:</span>
            <span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">warning_html</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span>
                <span class="n">value</span><span class="o">=</span><span class="s2">&quot;&lt;div style=&#39;color: black; background-color: #ffffcc; padding: 10px; border-radius: 5px; font-size: 16px; text-align: center;&#39;&gt;&quot;</span> 
                      <span class="s2">&quot;&lt;b&gt;⚠️ Warning:&lt;/b&gt; Frequency should not exceed 500&lt;/div&gt;&quot;</span><span class="p">,</span>
                <span class="n">placeholder</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">display</span><span class="p">(</span><span class="n">warning_html</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Proceed with the plot if all frequencies are within the limit</span>
        <span class="k">with</span> <span class="n">output</span><span class="p">:</span>
            <span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Clear any existing plots or warnings</span>
            <span class="n">Fc</span> <span class="o">=</span> <span class="mi">1500</span>  <span class="c1"># Carrier frequency</span>
            <span class="n">Fs</span> <span class="o">=</span> <span class="mi">8000</span>  <span class="c1"># Sampling frequency</span>
            <span class="n">Ts</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">Fs</span>  <span class="c1"># Sampling period</span>
            <span class="n">L</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Fs</span><span class="p">)</span>  <span class="c1"># Length of signal, approximated to Fs for a 1-second signal</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># Time vector</span>

            <span class="c1"># Create the composite signal s</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">freq1</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">freq2</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">freq3</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
            <span class="c1"># Create the carrier signal z</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">Fc</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
            <span class="c1"># Modulating signal</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">s</span> <span class="o">*</span> <span class="n">z</span>

            <span class="c1"># Plotting the modulated signal in time domain</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
            
            <span class="c1"># Calculate the midpoint of the arrays</span>
            <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#00CC96&#39;</span><span class="p">)</span>
            <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Time domain plot of modulated signal y&#39;</span><span class="p">)</span>
            <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (sec)&#39;</span><span class="p">)</span>
            <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
            <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
            <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

            <span class="c1"># Fourier transform</span>
            <span class="n">N</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">nextpow2</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
            <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
            <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">Fs</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">Fs</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
            
            <span class="c1"># Frequency domain plot</span>
            <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Y</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#1F77B4&#39;</span><span class="p">)</span>
            <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Frequency domain plot of modulated signal y&#39;</span><span class="p">)</span>
            <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
            <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude&#39;</span><span class="p">)</span>
            <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Create a label to show a warning above the text boxes</span>
<span class="n">warning_label</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;Make sure the frequencies do not exceed 500 Hz&quot;</span><span class="p">)</span>

<span class="c1"># Widgets for frequency input</span>
<span class="n">freq1_input</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntText</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Freq 1 (Hz):&#39;</span><span class="p">,</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">freq2_input</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntText</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Freq 2 (Hz):&#39;</span><span class="p">,</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">freq3_input</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntText</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Freq 3 (Hz):&#39;</span><span class="p">,</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Function to check the frequency values and display warning next to the inputs if needed</span>
<span class="k">def</span> <span class="nf">check_frequencies</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">input_widget</span> <span class="ow">in</span> <span class="p">[</span><span class="n">freq1_input</span><span class="p">,</span> <span class="n">freq2_input</span><span class="p">,</span> <span class="n">freq3_input</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">input_widget</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="mi">500</span><span class="p">:</span>
            <span class="n">input_widget</span><span class="o">.</span><span class="n">description_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;yellow&#39;</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">input_widget</span><span class="o">.</span><span class="n">description_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">}</span>

<span class="c1"># Attach the check_frequencies function to the &#39;value&#39; trait of the input widgets</span>
<span class="n">freq1_input</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">check_frequencies</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)</span>
<span class="n">freq2_input</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">check_frequencies</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)</span>
<span class="n">freq3_input</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">check_frequencies</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)</span>

<span class="c1"># Output widget where plots or warnings will be displayed</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">()</span>

<span class="c1"># Display the input widgets and the output</span>
<span class="n">ui</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">warning_label</span><span class="p">,</span> <span class="n">freq1_input</span><span class="p">,</span> <span class="n">freq2_input</span><span class="p">,</span> <span class="n">freq3_input</span><span class="p">])</span>

<span class="c1"># Adjusted to map the new frequency inputs</span>
<span class="n">widgets</span><span class="o">.</span><span class="n">interactive_output</span><span class="p">(</span><span class="n">update_plots</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;freq1&#39;</span><span class="p">:</span> <span class="n">freq1_input</span><span class="p">,</span> <span class="s1">&#39;freq2&#39;</span><span class="p">:</span> <span class="n">freq2_input</span><span class="p">,</span> <span class="s1">&#39;freq3&#39;</span><span class="p">:</span> <span class="n">freq3_input</span><span class="p">})</span>

<span class="c1"># Display the UI</span>
<span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">ui</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "89cd2d385cf247038ec9dfbce7cedd54", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "bede4e62c99741089c3d5abaefbf36f3", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
</section>
<section id="part-4-application-b">
<h2>Part 4: Application B<a class="headerlink" href="#part-4-application-b" title="Link to this heading">#</a></h2>
<p>Write a Python spectral analysis function, similar to <code class="docutils literal notranslate"><span class="pre">signal.welch()</span></code>: it will accept as input a real signal vector as well as the sampling frequency, <span class="math notranslate nohighlight">\(F_s\)</span>, and will plot the one-sided spectral density of the signal in the range <span class="math notranslate nohighlight">\([0-F_s/2)\)</span>. The signal will be segmented into sections of length equal to the power of <span class="math notranslate nohighlight">\(2\)</span> closest to <span class="math notranslate nohighlight">\(1/8\)</span> of its total length, but not less than 256. The sections will overlap by <span class="math notranslate nohighlight">\(50%\)</span>. The last section, if shorter than the others, will be ignored. The spectrum of each section will be calculated with FFT and the mean value of all sections will be taken. The function should be tested with the signal from example 1.1 and the result compared with that of <code class="docutils literal notranslate"><span class="pre">signal.welch()</span></code>.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Code<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--19-input--1" name="tab-set--19" type="radio"><label class="tab-label" for="tab-set--19-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ==============================================================================</span>
<span class="c1"># Custom nextpow2 and pwelch functions</span>
<span class="c1"># ==============================================================================</span>
<span class="k">def</span> <span class="nf">nextpow2</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">*=</span> <span class="mi">2</span>
        <span class="k">return</span> <span class="n">n</span>

<span class="k">def</span> <span class="nf">pwelch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">Fs</span><span class="p">):</span>                    
    <span class="n">Ts</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Fs</span>                    
    <span class="n">L</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>                 
    <span class="n">T</span><span class="o">=</span><span class="n">L</span><span class="o">*</span><span class="n">Ts</span>                     
    <span class="n">N</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="n">nextpow2</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
    <span class="n">Fo</span><span class="o">=</span><span class="n">Fs</span><span class="o">/</span><span class="n">N</span>                   
    <span class="n">f</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="n">Fo</span>       
     
    <span class="n">window_size</span> <span class="o">=</span> <span class="n">nextpow2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">window_size</span><span class="o">&lt;</span><span class="mi">256</span><span class="p">):</span>
        <span class="n">window_size</span><span class="o">=</span><span class="mi">256</span>
    <span class="n">windows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">//</span><span class="p">(</span><span class="n">window_size</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">indexer</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">window_size</span><span class="p">)[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span> <span class="p">(</span><span class="n">window_size</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">windows</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">windowed_x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">indexer</span><span class="p">]</span>

    <span class="n">avg_pwr</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">window</span> <span class="ow">in</span> <span class="n">windowed_x</span><span class="p">:</span>
        <span class="n">window</span> <span class="o">=</span> <span class="n">window</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">hanning</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">window</span><span class="p">))</span>
        <span class="n">L</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">window</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>                 
        <span class="n">T</span><span class="o">=</span><span class="n">L</span><span class="o">*</span><span class="n">Ts</span>                     
        <span class="n">N</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="n">nextpow2</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
        <span class="n">Fo</span><span class="o">=</span><span class="n">Fs</span><span class="o">/</span><span class="n">N</span>                   
        <span class="n">f</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="n">Fo</span>
        <span class="n">window_fft</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">window</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
        <span class="n">power</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">window_fft</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">window_fft</span><span class="p">))</span><span class="o">/</span><span class="n">N</span><span class="o">/</span><span class="n">L</span>
        <span class="n">avg_pwr</span><span class="o">=</span><span class="n">avg_pwr</span><span class="o">+</span><span class="n">power</span>
    <span class="n">avg_pwr</span><span class="o">=</span><span class="n">avg_pwr</span><span class="o">/</span><span class="n">windows</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mf">18.5</span><span class="p">,</span> <span class="mf">10.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">)],</span><span class="n">avg_pwr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">)])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Power&#39;</span><span class="p">,</span>
           <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Periodogram pwelch()&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">f</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">)],</span> <span class="n">avg_pwr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">)]</span>

<span class="c1"># ==============================================================================</span>
<span class="c1"># Test the functions &amp; plot the results</span>
<span class="c1"># ==============================================================================   </span>
<span class="n">Fs</span><span class="o">=</span><span class="n">______</span>
<span class="n">f1</span><span class="p">,</span><span class="n">Pxx1</span> <span class="o">=</span> <span class="n">pwelch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">Fs</span><span class="p">)</span>
<span class="n">f2</span><span class="p">,</span><span class="n">Pxx2</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">welch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">fs</span><span class="o">=</span><span class="n">Fs</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mf">18.5</span><span class="p">,</span> <span class="mf">10.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f2</span><span class="p">,</span><span class="n">Pxx2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Power&#39;</span><span class="p">,</span>
       <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Periodogram signal.welch()&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--19-input--2" name="tab-set--19" type="radio"><label class="tab-label" for="tab-set--19-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% ==============================================================================</span>
<span class="c">% Custom nextpow2 and pwelch functions</span>
<span class="c">% ==============================================================================</span>
<span class="k">function</span><span class="w"> </span>N<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">nextpow2</span><span class="p">(</span>i<span class="p">)</span>
<span class="w">    </span><span class="n">n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nb">i</span>
<span class="w">        </span><span class="n">n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">N</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">log2</span><span class="p">(</span><span class="n">n</span><span class="p">);</span><span class="w"> </span><span class="c">% This returns the exponent N such that 2^N = n, aligning with MATLAB&#39;s built-in nextpow2 behavior.</span>
<span class="k">end</span>

<span class="k">function</span><span class="w"> </span><span class="nf">[f, avgPwr] = pwelch</span><span class="p">(</span>x, Fs<span class="p">)</span>
<span class="w">    </span><span class="n">Ts</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="n">Fs</span><span class="p">;</span>
<span class="w">    </span><span class="n">L</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="n">T</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">L</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Ts</span><span class="p">;</span>
<span class="w">    </span><span class="n">N</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span>^<span class="nb">nextpow2</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
<span class="w">    </span><span class="n">Fo</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Fs</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">N</span><span class="p">;</span>
<span class="w">    </span><span class="n">f</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Fo</span><span class="p">;</span>
<span class="w">    </span>
<span class="w">    </span><span class="n">windowSize</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">nextpow2</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">windowSize</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">256</span><span class="p">)</span>
<span class="w">        </span><span class="n">windowSize</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">256</span><span class="p">;</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">windows</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">floor</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">windowSize</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="n">indexer</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">bsxfun</span><span class="p">(@</span><span class="nb">plus</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">windowSize</span><span class="p">)</span><span class="o">&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">windowSize</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">windows</span><span class="o">-</span><span class="mi">1</span><span class="p">));</span>
<span class="w">    </span><span class="n">windowedX</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">indexer</span><span class="p">);</span>
<span class="w">    </span>
<span class="w">    </span><span class="n">avgPwr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="nb">size</span><span class="p">(</span><span class="n">windowedX</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="w">        </span><span class="n">window</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">windowedX</span><span class="p">(:,</span><span class="w"> </span><span class="nb">i</span><span class="p">)</span><span class="w"> </span><span class="o">.*</span><span class="w"> </span><span class="n">hanning</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">windowedX</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span>
<span class="w">        </span><span class="n">L</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">length</span><span class="p">(</span><span class="n">window</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
<span class="w">        </span><span class="n">T</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">L</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Ts</span><span class="p">;</span>
<span class="w">        </span><span class="n">N</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span>^<span class="nb">nextpow2</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
<span class="w">        </span><span class="n">Fo</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Fs</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">N</span><span class="p">;</span>
<span class="w">        </span><span class="n">f</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Fo</span><span class="p">;</span>
<span class="w">        </span><span class="n">windowFFT</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">fft</span><span class="p">(</span><span class="n">window</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">);</span>
<span class="w">        </span><span class="n">power</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">windowFFT</span><span class="w"> </span><span class="o">.*</span><span class="w"> </span><span class="nb">conj</span><span class="p">(</span><span class="n">windowFFT</span><span class="p">))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">N</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">);</span>
<span class="w">        </span><span class="n">avgPwr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">avgPwr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">power</span><span class="p">;</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">avgPwr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">avgPwr</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">windows</span><span class="p">;</span>
<span class="w">    </span>
<span class="w">    </span><span class="nb">figure</span><span class="p">;</span>
<span class="w">    </span><span class="nb">set</span><span class="p">(</span><span class="nb">gcf</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Position&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">1850</span><span class="p">,</span><span class="w"> </span><span class="mi">1050</span><span class="p">]);</span>
<span class="w">    </span><span class="nb">plot</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">floor</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span><span class="w"> </span><span class="n">avgPwr</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">floor</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">)));</span>
<span class="w">    </span><span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Frequency (Hz)&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Power&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="nb">title</span><span class="p">(</span><span class="s">&#39;Periodogram pwelch()&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="n">grid</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
<span class="w">    </span>
<span class="w">    </span><span class="n">f</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">floor</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">));</span>
<span class="w">    </span><span class="n">avgPwr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">avgPwr</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">floor</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">));</span>
<span class="k">end</span>

<span class="c">% ==============================================================================</span>
<span class="c">% Test the functions &amp; plot the results</span>
<span class="c">% ==============================================================================</span>
<span class="n">Fs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">_______</span><span class="p">;</span><span class="w"> </span><span class="c">% Define your sampling frequency</span>
<span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">10000</span><span class="p">);</span><span class="w"> </span><span class="c">% Example data, replace with your actual data</span>

<span class="p">[</span><span class="n">f1</span><span class="p">,</span><span class="w"> </span><span class="n">Pxx1</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">pwelch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">Fs</span><span class="p">);</span>
<span class="p">[</span><span class="n">f2</span><span class="p">,</span><span class="w"> </span><span class="n">Pxx2</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">pwelch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">Fs</span><span class="p">,</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="n">Fs</span><span class="p">);</span><span class="w"> </span><span class="c">% MATLAB&#39;s built-in function</span>

<span class="nb">figure</span><span class="p">;</span>
<span class="nb">set</span><span class="p">(</span><span class="nb">gcf</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Position&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">1850</span><span class="p">,</span><span class="w"> </span><span class="mi">1050</span><span class="p">]);</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">f2</span><span class="p">,</span><span class="w"> </span><span class="n">Pxx2</span><span class="p">);</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Frequency (Hz)&#39;</span><span class="p">);</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Power&#39;</span><span class="p">);</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;Periodogram signal.welch()&#39;</span><span class="p">);</span>
<span class="n">grid</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
</div>
</details><div class="cell tag_thebe-init tag_hide-code-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">nextpow2</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">i</span><span class="p">:</span> <span class="n">n</span> <span class="o">*=</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="n">n</span>

<span class="k">def</span> <span class="nf">pwelch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">Fs</span><span class="p">):</span>                    
    <span class="n">Ts</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Fs</span>                    
    <span class="n">L</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>          
    <span class="n">T</span><span class="o">=</span><span class="n">L</span><span class="o">*</span><span class="n">Ts</span>                     
    <span class="n">N</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="n">nextpow2</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
    <span class="n">Fo</span><span class="o">=</span><span class="n">Fs</span><span class="o">/</span><span class="n">N</span>                   
    <span class="n">f</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="n">Fo</span>       
        
    <span class="n">window_size</span> <span class="o">=</span> <span class="n">nextpow2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">window_size</span><span class="o">&lt;</span><span class="mi">256</span><span class="p">):</span>
        <span class="n">window_size</span><span class="o">=</span><span class="mi">256</span>
    <span class="n">windows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">//</span><span class="p">(</span><span class="n">window_size</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">indexer</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">window_size</span><span class="p">)[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span> <span class="p">(</span><span class="n">window_size</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">windows</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">windowed_x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">indexer</span><span class="p">]</span>

    <span class="n">avg_pwr</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">window</span> <span class="ow">in</span> <span class="n">windowed_x</span><span class="p">:</span>
        <span class="n">window</span> <span class="o">=</span> <span class="n">window</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">hanning</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">window</span><span class="p">))</span>
        <span class="n">L</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">window</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>                 
        <span class="n">T</span><span class="o">=</span><span class="n">L</span><span class="o">*</span><span class="n">Ts</span>                     
        <span class="n">N</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="n">nextpow2</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
        <span class="n">Fo</span><span class="o">=</span><span class="n">Fs</span><span class="o">/</span><span class="n">N</span>                   
        <span class="n">f</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="n">Fo</span>
        <span class="n">window_fft</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">window</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
        <span class="n">power</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">window_fft</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">window_fft</span><span class="p">))</span><span class="o">/</span><span class="n">N</span><span class="o">/</span><span class="n">L</span>
        <span class="n">avg_pwr</span><span class="o">=</span><span class="n">avg_pwr</span><span class="o">+</span><span class="n">power</span>
    <span class="n">avg_pwr</span><span class="o">=</span><span class="n">avg_pwr</span><span class="o">/</span><span class="n">windows</span>


    <span class="k">return</span> <span class="n">f</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">)],</span> <span class="n">avg_pwr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">)]</span>

<span class="c1"># Function to update plots based on slider value</span>
<span class="k">def</span> <span class="nf">update_plots</span><span class="p">(</span><span class="n">Fs</span><span class="p">):</span>
    <span class="n">L</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">T</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">Fs</span>  <span class="c1"># Update sampling period</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="o">*</span> <span class="n">T</span>  <span class="c1"># Update time vector</span>
    
    <span class="c1"># Recompute signal x with new sampling frequency</span>
    <span class="n">last_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">30</span> <span class="o">*</span> <span class="n">t1</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">80</span> <span class="o">*</span> <span class="p">(</span><span class="n">t1</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="n">t1</span><span class="p">)</span>
    
    <span class="c1"># Compute pwelch</span>
    <span class="n">f1</span><span class="p">,</span> <span class="n">Pxx1</span> <span class="o">=</span> <span class="n">pwelch</span><span class="p">(</span><span class="n">last_x</span><span class="p">,</span> <span class="n">Fs</span><span class="p">)</span>
    
    <span class="c1"># Compute signal.welch</span>
    <span class="n">f2</span><span class="p">,</span> <span class="n">Pxx2</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">welch</span><span class="p">(</span><span class="n">last_x</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">Fs</span><span class="p">)</span>
    
    <span class="c1"># Plot</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    
    <span class="c1"># Plot custom pwelch</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span> <span class="n">Pxx1</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Power&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Periodogram pwelch()&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    
    <span class="c1"># Plot signal.welch</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f2</span><span class="p">,</span> <span class="n">Pxx2</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Power&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Periodogram signal.welch()&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Create slider for Fs</span>
<span class="n">Fs_slider</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span>
    <span class="n">value</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
    <span class="nb">min</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="nb">max</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> 
    <span class="n">step</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Sampling Frequency (Fs):&#39;</span><span class="p">,</span>
    <span class="n">layout</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">),</span>
    <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;initial&#39;</span><span class="p">},</span> 
    <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>


<span class="n">html_label</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span>
    <span class="n">value</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    </span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="p">)</span>

<span class="c1"># Display the sliders and output</span>
<span class="n">vbox_layout</span> <span class="o">=</span> <span class="n">Layout</span><span class="p">(</span><span class="n">display</span><span class="o">=</span><span class="s1">&#39;flex&#39;</span><span class="p">,</span> <span class="n">flex_flow</span><span class="o">=</span><span class="s1">&#39;column&#39;</span><span class="p">,</span> <span class="n">align_items</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>

<span class="n">ui</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">html_label</span><span class="p">,</span> <span class="n">Fs_slider</span><span class="p">],</span> <span class="n">layout</span><span class="o">=</span><span class="n">vbox_layout</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">interactive_output</span><span class="p">(</span><span class="n">update_plots</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;Fs&#39;</span><span class="p">:</span> <span class="n">Fs_slider</span><span class="p">})</span>

<span class="c1"># Display the slider</span>
<span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Clear the previous plot</span>
<span class="n">display</span><span class="p">(</span><span class="n">ui</span><span class="p">,</span><span class="n">out</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "8aaa602ab65c4e289975db9b22a806cd", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "85b2de64fc884335aba1bb5edcd67e95", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "ntua-el17840/Interactive-Digital-Communications",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../digital_communications_intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Interactive python interpreter (IPython) notebook</p>
      </div>
    </a>
    <a class="right-next"
       href="Digcom_Lab2.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lab Exercise 2: Digital Filters</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup">Setup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-packages-we-will-need-later-in-python">Importing packages we will need later in Python</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1-training">Part 1: Training</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-scalar-one-dimensional-quantity">Create a scalar (one-dimensional) quantity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-vector-of-real-values">Create a vector of real values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-matrix-of-real-values">Create a matrix of real values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sum">Sum</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiply">Multiply</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiply-element-wise">Multiply element-wise</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#check-the-length-of-a-vector">Check the length of a vector</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#check-the-size-of-a-matrix">Check the size of a matrix</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#access-specific-elements-of-a-matrix-part-1">Access specific elements of a matrix (Part 1)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#access-specific-elements-of-a-matrix-part-2">Access specific elements of a matrix (Part 2)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#access-a-specific-segment-of-a-vector">Access a specific segment of a vector</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#access-specific-segments-of-a-matrix">Access specific segments of a matrix</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-vector-with-elements-from-0-to-0-5-with-a-step-of-0-1">Create a vector with elements from 0 to 0.5 with a step of 0.1</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2-theory">Part 2: Theory</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-digitization">Sampling - Digitization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spectral-analysis">Spectral Analysis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application-in-practice">Application in Practice</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-sine-wave-signal">Create a sine wave signal</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-discrete-fourier-transform-of-the-sine-wave-signal">Plot the discrete Fourier transform of the sine wave signal</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-periodogram">Plot the periodogram</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-power-of-the-sine-wave-signal">Calculate the power of the sine wave signal</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-3-application-a">Part 3: Application A</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-signal-creation-and-display">Step 1: Signal creation and display</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-add-noise-to-the-signal">Step 2: Add noise to the signal</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-multiplication-of-signals">Step 3: Multiplication of signals</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-4-application-b">Part 4: Application B</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By ECE - NTUA
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>