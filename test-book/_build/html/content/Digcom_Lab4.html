

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Lab Exercise 4: Nyquist signaling and L-ASK &#8212; Interactive Digital Communtications</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script src="../_static/tabs.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/custom.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/Digcom_Lab4';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Lab Exercise 5" href="Digcom_Lab5.html" />
    <link rel="prev" title="Lab Exercise 3: Matched Filters and L-ASK" href="Digcom_Lab3.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Interactive Digital Communtications - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Interactive Digital Communtications - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">About</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../digital_communications_intro.html">Digital Communications and Interactivity</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lab Exercises</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Digcom_Lab1.html">Lab Exercise 1: Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Digcom_Lab2.html">Lab Exercise 2: Digital Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="Digcom_Lab3.html">Lab Exercise 3: Matched Filters and L-ASK</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Lab Exercise 4: Nyquist signaling and L-ASK</a></li>
<li class="toctree-l1"><a class="reference internal" href="Digcom_Lab5.html">Lab Exercise 5</a></li>
<li class="toctree-l1"><a class="reference internal" href="Digcom_Lab6.html">Εργαστηριακή Άσκηση 6</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ntua-el17840/Interactive-Digital-Communications" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ntua-el17840/Interactive-Digital-Communications/issues/new?title=Issue%20on%20page%20%2Fcontent/Digcom_Lab4.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/content/Digcom_Lab4.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lab Exercise 4: Nyquist signaling and L-ASK</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup">Setup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-packages-we-will-need-later-in-python">Importing packages we will need later in Python</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1-useful-code">Part 1: Useful Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2-signal-generation-with-nyquist-filters-time-and-frequency-plots">Part 2: Signal generation with Nyquist filters – Time and frequency plots</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-3-performance-calculation-ber-vs-eb-no">Part 3: Performance calculation: BER vs Eb/No.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-4-the-effect-of-the-coding-method-gray-or-other">Part 4: The effect of the coding method: Gray or other</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-5-calculation-of-system-parameters">Part 5: Calculation of system parameters</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="lab-exercise-4-nyquist-signaling-and-l-ask">
<h1>Lab Exercise 4: Nyquist signaling and L-ASK<a class="headerlink" href="#lab-exercise-4-nyquist-signaling-and-l-ask" title="Permalink to this heading">#</a></h1>
<p>After studying Chapter 4 of the notes and, in particular, Example 4.2, write and run
code for the following:</p>
<section id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this heading">#</a></h2>
<div class="admonition-live-code admonition">
<p class="admonition-title">Live Code</p>
<p>Press the following button to make python code interactive. It will connect you to a kernel once it says “ready” (might take a bit, especially the first time it runs).</p>
</div>
<div style="text-align: center;">
  <button title="Launch thebe" class="thebelab-button thebe-launch-button" onclick="initThebe()">Python Interactive Code</button>
</div><section id="importing-packages-we-will-need-later-in-python">
<h3>Importing packages we will need later in Python<a class="headerlink" href="#importing-packages-we-will-need-later-in-python" title="Permalink to this heading">#</a></h3>
<div class="cell tag_thebe-init tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">scipy.signal</span>
<span class="kn">import</span> <span class="nn">scipy.special</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">erfc</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">log</span><span class="p">,</span> <span class="n">log2</span><span class="p">,</span> <span class="n">sqrt</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">IntSlider</span><span class="p">,</span> <span class="n">FloatSlider</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">Layout</span><span class="p">,</span> <span class="n">Dropdown</span><span class="p">,</span> <span class="n">IntText</span><span class="p">,</span> <span class="n">HBox</span><span class="p">,</span> <span class="n">VBox</span><span class="p">,</span> <span class="n">Output</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">clear_output</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Libraries added successfully!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="part-1-useful-code">
<h2>Part 1: Useful Code<a class="headerlink" href="#part-1-useful-code" title="Permalink to this heading">#</a></h2>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Use the provided code as a foundation for the rest of the exercise.</p>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Code<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># The function grayCode accepts a number n and returns an array g containing</span>
<span class="c1"># the Gray coding for numbers with n bits.</span>
<span class="c1"># This is done by recursively calling the function gray_code_recurse</span>
<span class="k">def</span> <span class="nf">grayCode</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">gray_code_recurse</span> <span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
        <span class="n">k</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">char</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="o">+</span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">g</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="o">+</span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="n">gray_code_recurse</span> <span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">g</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">]</span>
    <span class="n">gray_code_recurse</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">g</span>


<span class="c1"># The function naturalBinaryCoding accepts a number n and returns an array</span>
<span class="c1"># with binary numbers with n bits (or equivalently up to the number 2**n, which results</span>
<span class="c1"># by left shifting 1 by n bits)</span>
<span class="k">def</span> <span class="nf">naturalBinaryCoding</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">binary_levels</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">binary_levels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;{:0</span><span class="si">{}</span><span class="s1">b}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">binary_levels</span>


<span class="c1"># The function generateRandomBits generates n_bits random binary digits</span>
<span class="k">def</span> <span class="nf">generateRandomBits</span><span class="p">(</span><span class="n">n_bits</span><span class="p">):</span>
    <span class="n">bitstream</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_bits</span><span class="p">):</span>
        <span class="n">random_bit</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">bitstream</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">random_bit</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bitstream</span>


<span class="c1"># The function createLevels divides the range [-A, A] into L-1 equal intervals,</span>
<span class="c1"># so that it always contains the endpoints of the range</span>
<span class="k">def</span> <span class="nf">createLevels</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">L</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">step</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">A</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">L</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
        <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="n">A</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">step</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span>


<span class="c1"># The function createSymbols takes an array with bits as an argument and</span>
<span class="c1"># groups neighboring digits into symbols with length k</span>
<span class="k">def</span> <span class="nf">createSymbols</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">bitstream</span><span class="p">):</span>
    <span class="n">n_bits</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bitstream</span><span class="p">)</span>
    <span class="n">symbols</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_bits</span> <span class="o">-</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="n">symbol</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
            <span class="n">symbol</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">bitstream</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">])</span>
        <span class="n">symbols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">symbols</span>


<span class="c1"># The function rootRaisedCosine creates a root raised cosine pulse</span>
<span class="c1"># with a roll-off coefficient and order determined by the sampling rate (nsample)</span>
<span class="c1"># and the delay it will introduce (delay)</span>
<span class="k">def</span> <span class="nf">rootRaisedCosine</span><span class="p">(</span><span class="n">nsamp</span><span class="p">,</span> <span class="n">roll_off</span><span class="p">,</span> <span class="n">delay</span><span class="p">):</span>
    <span class="n">F0</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="n">nsamp</span>
    <span class="n">Fd</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">Fs</span> <span class="o">=</span> <span class="n">Fd</span> <span class="o">*</span> <span class="n">nsamp</span>
    <span class="n">Td</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">Fd</span>
    <span class="n">Ts</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">Fs</span>
    <span class="n">F1</span> <span class="o">=</span> <span class="n">F0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">roll_off</span><span class="p">)</span>
    <span class="n">F2</span> <span class="o">=</span> <span class="n">F0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">roll_off</span><span class="p">)</span>
    <span class="n">filter_order</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">nsamp</span> <span class="o">*</span> <span class="n">delay</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">filter_order</span><span class="p">,</span> <span class="n">Td</span><span class="p">)</span>
    <span class="n">h</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)):</span>
        <span class="n">t_shifted</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">filter_order</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="n">t_shifted</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">h</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">F0</span><span class="p">)</span> <span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">roll_off</span> <span class="o">*</span> <span class="p">((</span><span class="mi">4</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="k">elif</span> <span class="n">t_shifted</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">8</span> <span class="o">/</span> <span class="n">roll_off</span> <span class="o">/</span> <span class="n">F0</span> <span class="ow">or</span> <span class="n">t_shifted</span> <span class="o">==</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">8</span> <span class="o">/</span> <span class="n">roll_off</span> <span class="o">/</span> <span class="n">F0</span> <span class="p">:</span>
            <span class="n">h</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">roll_off</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">F0</span><span class="p">))</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">/</span> <span class="n">roll_off</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">/</span> <span class="n">roll_off</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">factor1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">F0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">64</span> <span class="o">*</span> <span class="n">roll_off</span><span class="o">*</span> <span class="n">roll_off</span> <span class="o">*</span> <span class="n">F0</span> <span class="o">*</span> <span class="n">F0</span> <span class="o">*</span> <span class="n">t_shifted</span> <span class="o">*</span> <span class="n">t_shifted</span><span class="p">)</span>
            <span class="n">factor2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">F1</span> <span class="o">*</span> <span class="n">t_shifted</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">F0</span> <span class="o">*</span> <span class="n">t_shifted</span><span class="p">)</span>
            <span class="n">factor3</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">roll_off</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">F2</span> <span class="o">*</span> <span class="n">t_shifted</span><span class="p">)</span> 
            <span class="n">h</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">factor1</span> <span class="o">*</span> <span class="p">(</span><span class="n">factor2</span> <span class="o">+</span> <span class="n">factor3</span><span class="p">))</span>


    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">h</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Root raised cosine filter of order </span><span class="si">%d</span><span class="s1"> and roll-off factor </span><span class="si">%.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">filter_order</span><span class="p">,</span> <span class="n">roll_off</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">h</span>


<span class="c1"># The function upSample increases the number of samples of a signal signal by adding nsamp-1</span>
<span class="c1"># zeros after each sample of the signal</span>
<span class="k">def</span> <span class="nf">upSample</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">nsamp</span><span class="p">):</span>
    <span class="n">upSampled</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span> <span class="o">*</span> <span class="n">nsamp</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="n">nsamp</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">upSampled</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">signal</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="n">nsamp</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">upSampled</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">upSampled</span>


<span class="c1"># The function downSample reduces the sampling frequency of a signal signal by a factor of nsamp</span>
<span class="c1"># by keeping only the samples that are multiples of nsamp (0, nsamp, 2*nsamp, ...)</span>
<span class="k">def</span> <span class="nf">downSample</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">nsamp</span><span class="p">):</span>
    <span class="n">downSampled</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">signal</span><span class="p">),</span> <span class="n">nsamp</span><span class="p">):</span>
        <span class="n">downSampled</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">signal</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        
    <span class="k">return</span> <span class="n">downSampled</span>


<span class="c1"># Adds white Gaussian noise with mean value μ (mu) and variance σ^2 (sigma)</span>
<span class="k">def</span> <span class="nf">generateAWGN</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    <span class="n">noise</span> <span class="o">=</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">signal</span><span class="p">))</span> <span class="o">+</span> <span class="n">mu</span>
    <span class="k">return</span> <span class="n">noise</span>
    
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="nf">[grayCodeOutput, naturalBinaryOutput, randomBitsOutput, createLevelsOutput, createSymbolsOutput, rootRaisedCosineOutput, upSampleOutput, downSampleOutput, generateAWGNOutput] = communicationFunctions</span><span class="p">(</span>n, A, L, k, nsamp, roll_off, delay, n_bits, mu, sigma<span class="p">)</span>
<span class="w">    </span>#<span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">grayCode</span><span class="w"> </span><span class="n">accepts</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">array</span><span class="w"> </span><span class="n">g</span><span class="w"> </span><span class="n">containing</span>
<span class="w">    </span>#<span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Gray</span><span class="w"> </span><span class="n">coding</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">numbers</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">bits</span><span class="p">.</span>
<span class="w">    </span>#<span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">recursively</span><span class="w"> </span><span class="n">calling</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">gray_code_recurse</span>
<span class="w">    </span><span class="k">function</span><span class="w"> </span>g<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">grayCode</span><span class="p">(</span>n<span class="p">)</span>
<span class="w">        </span><span class="n">g</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="s">&#39;0&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;1&#39;</span><span class="p">};</span>
<span class="w">        </span><span class="n">gray_code_recurse</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="w">        </span><span class="k">function</span><span class="w"> </span><span class="nf">gray_code_recurse</span><span class="p">(</span>g, n<span class="p">)</span>
<span class="w">            </span><span class="n">k</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">length</span><span class="p">(</span><span class="n">g</span><span class="p">);</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                </span><span class="k">return</span><span class="p">;</span>
<span class="w">            </span><span class="k">else</span>
<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">k</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span>
<span class="w">                    </span><span class="nb">char</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="s">&#39;1&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">g</span><span class="p">{</span><span class="nb">i</span><span class="p">}];</span>
<span class="w">                    </span><span class="n">g</span><span class="p">{</span><span class="k">end</span><span class="o">+</span><span class="mi">1</span><span class="p">}</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">char</span><span class="p">;</span>
<span class="w">                </span><span class="k">end</span>
<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">k</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span>
<span class="w">                    </span><span class="n">g</span><span class="p">{</span><span class="nb">i</span><span class="p">}</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="s">&#39;0&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">g</span><span class="p">{</span><span class="nb">i</span><span class="p">}];</span>
<span class="w">                </span><span class="k">end</span>
<span class="w">                </span><span class="n">gray_code_recurse</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="w">            </span><span class="k">end</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>


<span class="w">    </span>#<span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">naturalBinaryCoding</span><span class="w"> </span><span class="n">accepts</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">array</span>
<span class="w">    </span>#<span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="nb">binary</span><span class="w"> </span><span class="n">numbers</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">bits</span><span class="w"> </span><span class="p">(</span><span class="n">or</span><span class="w"> </span><span class="n">equivalently</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="mi">2</span><span class="o">**</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="nb">which</span><span class="w"> </span><span class="n">results</span>
<span class="w">    </span>#<span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">left</span><span class="w"> </span><span class="n">shifting</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">bits</span><span class="p">)</span>
<span class="w">    </span><span class="k">function</span><span class="w"> </span>binary_levels<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">naturalBinaryCoding</span><span class="p">(</span>n<span class="p">)</span>
<span class="w">        </span><span class="n">binary_levels</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span>^<span class="n">n</span><span class="p">);</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">:(</span><span class="mi">2</span>^<span class="n">n</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<span class="w">            </span><span class="n">binary_levels</span><span class="p">{</span><span class="nb">i</span><span class="o">+</span><span class="mi">1</span><span class="p">}</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">dec2bin</span><span class="p">(</span><span class="nb">i</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">);</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>


<span class="w">    </span>#<span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">generateRandomBits</span><span class="w"> </span><span class="n">generates</span><span class="w"> </span><span class="n">n_bits</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="nb">binary</span><span class="w"> </span><span class="n">digits</span>
<span class="w">    </span><span class="k">function</span><span class="w"> </span>bitstream<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">generateRandomBits</span><span class="p">(</span>n_bits<span class="p">)</span>
<span class="w">        </span><span class="n">bitstream</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">randi</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n_bits</span><span class="p">);</span>
<span class="w">    </span><span class="k">end</span>


<span class="w">    </span>#<span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">createLevels</span><span class="w"> </span><span class="n">divides</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">range</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">]</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">L</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">intervals</span><span class="p">,</span>
<span class="w">    </span>#<span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="nb">contains</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">endpoints</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">range</span>
<span class="w">    </span><span class="k">function</span><span class="w"> </span>y<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">createLevels</span><span class="p">(</span>A, L<span class="p">)</span>
<span class="w">        </span><span class="nb">step</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">A</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">L</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">        </span><span class="n">y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">-</span><span class="n">A</span><span class="p">:</span><span class="nb">step</span><span class="p">:</span><span class="n">A</span><span class="p">;</span>
<span class="w">    </span><span class="k">end</span>


<span class="w">    </span>#<span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">createSymbols</span><span class="w"> </span><span class="n">takes</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">array</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">bits</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="n">and</span>
<span class="w">    </span>#<span class="w"> </span><span class="n">groups</span><span class="w"> </span><span class="n">neighboring</span><span class="w"> </span><span class="n">digits</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">symbols</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="nb">length</span><span class="w"> </span><span class="n">k</span><span class="w"> </span>
<span class="w">    </span><span class="k">function</span><span class="w"> </span>symbols<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">createSymbols</span><span class="p">(</span>k, bitstream<span class="p">)</span>
<span class="w">        </span><span class="n">symbols</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{};</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">k</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">bitstream</span><span class="p">)</span><span class="o">-</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span>
<span class="w">            </span><span class="n">symbols</span><span class="p">{</span><span class="k">end</span><span class="o">+</span><span class="mi">1</span><span class="p">}</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">num2str</span><span class="p">(</span><span class="n">bitstream</span><span class="p">(</span><span class="nb">i</span><span class="p">:</span><span class="nb">i</span><span class="o">+</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">));</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>


<span class="w">    </span>#<span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">rootRaisedCosine</span><span class="w"> </span><span class="n">creates</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">raised</span><span class="w"> </span><span class="n">cosine</span><span class="w"> </span><span class="n">pulse</span>
<span class="w">    </span>#<span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">roll</span><span class="o">-</span><span class="n">off</span><span class="w"> </span><span class="n">coefficient</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">determined</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sampling</span><span class="w"> </span><span class="n">rate</span><span class="w"> </span><span class="p">(</span><span class="n">nsample</span><span class="p">)</span>
<span class="w">    </span>#<span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">delay</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">introduce</span><span class="w"> </span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>
<span class="w">    </span><span class="k">function</span><span class="w"> </span>h<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">rootRaisedCosine</span><span class="p">(</span>nsamp, roll_off, delay<span class="p">)</span>
<span class="w">        </span><span class="n">h</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rcosdesign</span><span class="p">(</span><span class="n">roll_off</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">delay</span><span class="p">,</span><span class="w"> </span><span class="n">nsamp</span><span class="p">);</span>
<span class="w">        </span><span class="n">t</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
<span class="w">        </span><span class="nb">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">);</span>
<span class="w">        </span><span class="n">grid</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
<span class="w">        </span><span class="nb">title</span><span class="p">(</span><span class="nb">sprintf</span><span class="p">(</span><span class="s">&#39;Root raised cosine filter of order %d and roll-off factor %.1f&#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">length</span><span class="p">(</span><span class="n">h</span><span class="p">),</span><span class="w"> </span><span class="n">roll_off</span><span class="p">));</span>
<span class="w">    </span><span class="k">end</span>


<span class="w">    </span>#<span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">upSample</span><span class="w"> </span><span class="n">increases</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">samples</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">adding</span><span class="w"> </span><span class="n">nsamp</span><span class="o">-</span><span class="mi">1</span>
<span class="w">    </span>#<span class="w"> </span><span class="nb">zeros</span><span class="w"> </span><span class="n">after</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">sample</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">signal</span>
<span class="w">    </span><span class="k">function</span><span class="w"> </span>upSampled<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">upSample</span><span class="p">(</span>signal, nsamp<span class="p">)</span>
<span class="w">        </span><span class="n">upSampled</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">length</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span><span class="o">*</span><span class="n">nsamp</span><span class="p">);</span>
<span class="w">        </span><span class="n">upSampled</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nsamp</span><span class="p">:</span><span class="k">end</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">signal</span><span class="p">;</span>
<span class="w">    </span><span class="k">end</span>


<span class="w">    </span>#<span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">downSample</span><span class="w"> </span><span class="n">reduces</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sampling</span><span class="w"> </span><span class="n">frequency</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nb">factor</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">nsamp</span>
<span class="w">    </span>#<span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">keeping</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">samples</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">multiples</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">nsamp</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">nsamp</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">nsamp</span><span class="p">,</span><span class="w"> </span><span class="k">...</span><span class="c">)</span>
<span class="w">    </span><span class="k">function</span><span class="w"> </span>downSampled<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">downSample</span><span class="p">(</span>signal, nsamp<span class="p">)</span>
<span class="w">        </span><span class="n">downSampled</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">signal</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nsamp</span><span class="p">:</span><span class="k">end</span><span class="p">);</span>
<span class="w">    </span><span class="k">end</span>


<span class="w">    </span>#<span class="w"> </span><span class="n">Adds</span><span class="w"> </span><span class="n">white</span><span class="w"> </span><span class="n">Gaussian</span><span class="w"> </span><span class="n">noise</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="nb">mean</span><span class="w"> </span><span class="n">value</span><span class="w"> </span>μ<span class="w"> </span><span class="p">(</span><span class="n">mu</span><span class="p">)</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">variance</span><span class="w"> </span>σ^<span class="mi">2</span><span class="w"> </span><span class="p">(</span><span class="n">sigma</span><span class="p">)</span>
<span class="w">    </span><span class="k">function</span><span class="w"> </span>noisySignal<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">generateAWGN</span><span class="p">(</span>signal, mu, sigma<span class="p">)</span>
<span class="w">        </span><span class="n">noise</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">sigma</span><span class="o">.*</span><span class="nb">randn</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">signal</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">mu</span><span class="p">;</span>
<span class="w">        </span><span class="n">noisySignal</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">noise</span><span class="p">;</span>
<span class="w">    </span><span class="k">end</span>


<span class="w">    </span><span class="c">% Execute the functions and store their output</span>
<span class="w">    </span><span class="n">grayCodeOutput</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">grayCode</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
<span class="w">    </span><span class="n">naturalBinaryOutput</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">naturalBinaryCoding</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
<span class="w">    </span><span class="n">randomBitsOutput</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">generateRandomBits</span><span class="p">(</span><span class="n">n_bits</span><span class="p">);</span>
<span class="w">    </span><span class="n">createLevelsOutput</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">createLevels</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="p">);</span>
<span class="w">    </span><span class="n">createSymbolsOutput</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">createSymbols</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">randomBitsOutput</span><span class="p">);</span>
<span class="w">    </span><span class="n">rootRaisedCosineOutput</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rootRaisedCosine</span><span class="p">(</span><span class="n">nsamp</span><span class="p">,</span><span class="w"> </span><span class="n">roll_off</span><span class="p">,</span><span class="w"> </span><span class="n">delay</span><span class="p">);</span>
<span class="w">    </span><span class="n">upSampleOutput</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">upSample</span><span class="p">(</span><span class="n">randomBitsOutput</span><span class="p">,</span><span class="w"> </span><span class="n">nsamp</span><span class="p">);</span>
<span class="w">    </span><span class="n">downSampleOutput</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">downSample</span><span class="p">(</span><span class="n">upSampleOutput</span><span class="p">,</span><span class="w"> </span><span class="n">nsamp</span><span class="p">);</span>
<span class="w">    </span><span class="n">generateAWGNOutput</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">generateAWGN</span><span class="p">(</span><span class="n">randomBitsOutput</span><span class="p">,</span><span class="w"> </span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">sigma</span><span class="p">);</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
</div>
</details></section>
<section id="part-2-signal-generation-with-nyquist-filters-time-and-frequency-plots">
<h2>Part 2: Signal generation with Nyquist filters – Time and frequency plots<a class="headerlink" href="#part-2-signal-generation-with-nyquist-filters-time-and-frequency-plots" title="Permalink to this heading">#</a></h2>
<p>Generate a random binary sequence of 10000 bits and then a corresponding 8-ASK
baseband signal, with the following characteristics:</p>
<ul class="simple">
<li><p>Gray coding</p></li>
<li><p>Nyquist root raised cosine signaling, with roll-off =0.40</p></li>
<li><p>Over-sampling with nsamp=20 samples per base period T</p></li>
<li><p>Transmitter filter class: 200 (10 periods, group_delay=5T)</p></li>
</ul>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>To Gray encode a binary vector, x, into L-ASK symbols, use the following code segment,
where step is the distance (or increment) between adjacent L-ASK points.</p>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Code<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">def</span> <span class="nf">bi2de</span><span class="p">(</span><span class="n">binary_array</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert binary array to decimal. Equivalent to MATLAB&#39;s bi2de for &#39;left-msb&#39;.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">binary_array</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">gray_encode_to_l_ask_symbols</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a binary vector x into L-ASK symbols using Gray encoding.</span>
<span class="sd">    L: Number of levels</span>
<span class="sd">    step: Distance between adjacent L-ASK points</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">k</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">L</span><span class="p">))</span>
    <span class="n">mapping</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">step</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">step</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">mapping</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">mapping</span> <span class="o">+</span> <span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">step</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">mapping</span> <span class="o">-</span> <span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">step</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
    
    <span class="c1"># Reshape x into k bits per symbol, convert to decimal, then map to symbols</span>
    <span class="n">xsym</span> <span class="o">=</span> <span class="p">[</span><span class="n">bi2de</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">k</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">k</span><span class="p">)]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">mapping</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xsym</span><span class="p">])</span>
    
    <span class="k">return</span> <span class="n">y</span>

</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span>y<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">grayEncodeToLAskSymbols</span><span class="p">(</span>x, L, step<span class="p">)</span>
<span class="w">    </span><span class="c">% x: Input binary vector</span>
<span class="w">    </span><span class="c">% L: Number of levels</span>
<span class="w">    </span><span class="c">% step: Distance between adjacent L-ASK points</span>

<span class="w">    </span><span class="n">k</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">log</span><span class="p">(</span><span class="n">L</span><span class="p">);</span><span class="w"> </span><span class="c">% Calculate bits per symbol based on the number of levels</span>
<span class="w">    </span><span class="n">mapping</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="nb">step</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="o">-</span><span class="nb">step</span><span class="o">/</span><span class="mi">2</span><span class="p">];</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="nb">j</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span><span class="n">k</span>
<span class="w">            </span><span class="n">mapping</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="n">mapping</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span>^<span class="p">(</span><span class="nb">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">step</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="o">-</span><span class="n">mapping</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span>^<span class="p">(</span><span class="nb">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">step</span><span class="o">/</span><span class="mi">2</span><span class="p">];</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>

<span class="w">    </span><span class="c">% Convert binary vector to decimal indices</span>
<span class="w">    </span><span class="n">xsym</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">bi2de</span><span class="p">(</span><span class="nb">reshape</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="nb">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">k</span><span class="p">).</span><span class="o">&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;left-msb&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[];</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">xsym</span><span class="p">)</span>
<span class="w">        </span><span class="n">y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="n">y</span><span class="w"> </span><span class="n">mapping</span><span class="p">(</span><span class="n">xsym</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)];</span><span class="w"> </span><span class="c">% Map to L-ASK symbols using the mapping vector</span>
<span class="w">    </span><span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
</div>
</details><p><strong>Question 2.1:</strong> Briefly explain its function and, in particular, the role of the mapping vector (see also Hint in the
next question).</p>
<p><strong>Question 2.2:</strong> Calculate the signal at the output of the matched filter at the receiver.
Show part of this signal (with the plot command) of 10T duration.</p>
<p><strong>Question 2.3:</strong> Superimpose (with the stem command) on this part the corresponding
samples of the input signal in the basic period grid T (before over-sampling).</p>
<p><strong>Question 2.4:</strong> Plot (using the pwelch command) the spectrum of the signal at the
receiver and explain its shape and amplitude.</p>
<div class="cell tag_thebe-init tag_hide-code-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The function grayCode accepts a number n and returns an array g containing</span>
<span class="c1"># the Gray coding for numbers with n bits.</span>
<span class="c1"># This is done by recursively calling the function gray_code_recurse</span>
<span class="k">def</span> <span class="nf">grayCode</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">gray_code_recurse</span> <span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
        <span class="n">k</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">char</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="o">+</span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">g</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="o">+</span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="n">gray_code_recurse</span> <span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">g</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">]</span>
    <span class="n">gray_code_recurse</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">g</span>


<span class="c1"># The function naturalBinaryCoding accepts a number n and returns an array</span>
<span class="c1"># with binary numbers with n bits (or equivalently up to the number 2**n, which results</span>
<span class="c1"># by left shifting 1 by n bits)</span>
<span class="k">def</span> <span class="nf">naturalBinaryCoding</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">binary_levels</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">binary_levels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;{:0</span><span class="si">{}</span><span class="s1">b}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">binary_levels</span>


<span class="c1"># The function generateRandomBits generates n_bits random binary digits</span>
<span class="k">def</span> <span class="nf">generateRandomBits</span><span class="p">(</span><span class="n">n_bits</span><span class="p">):</span>
    <span class="n">bitstream</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_bits</span><span class="p">):</span>
        <span class="n">random_bit</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">bitstream</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">random_bit</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bitstream</span>


<span class="c1"># The function createLevels divides the range [-A, A] into L-1 equal intervals,</span>
<span class="c1"># so that it always contains the endpoints of the range</span>
<span class="k">def</span> <span class="nf">createLevels</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">L</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">step</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">A</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">L</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
        <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="n">A</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">step</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span>


<span class="c1"># The function createSymbols takes an array with bits as an argument and</span>
<span class="c1"># groups neighboring digits into symbols with length k</span>
<span class="k">def</span> <span class="nf">createSymbols</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">bitstream</span><span class="p">):</span>
    <span class="n">n_bits</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bitstream</span><span class="p">)</span>
    <span class="n">symbols</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_bits</span> <span class="o">-</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="n">symbol</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
            <span class="n">symbol</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">bitstream</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">])</span>
        <span class="n">symbols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">symbols</span>


<span class="c1"># The function rootRaisedCosine creates a root raised cosine pulse</span>
<span class="c1"># with a roll-off coefficient and order determined by the sampling rate (nsample)</span>
<span class="c1"># and the delay it will introduce (delay)</span>
<span class="k">def</span> <span class="nf">rootRaisedCosine</span><span class="p">(</span><span class="n">nsamp</span><span class="p">,</span> <span class="n">roll_off</span><span class="p">,</span> <span class="n">delay</span><span class="p">):</span>
    <span class="n">F0</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="n">nsamp</span>
    <span class="n">Fd</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">Fs</span> <span class="o">=</span> <span class="n">Fd</span> <span class="o">*</span> <span class="n">nsamp</span>
    <span class="n">Td</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">Fd</span>
    <span class="n">Ts</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">Fs</span>
    <span class="n">F1</span> <span class="o">=</span> <span class="n">F0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">roll_off</span><span class="p">)</span>
    <span class="n">F2</span> <span class="o">=</span> <span class="n">F0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">roll_off</span><span class="p">)</span>
    <span class="n">filter_order</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">nsamp</span> <span class="o">*</span> <span class="n">delay</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">filter_order</span><span class="p">,</span> <span class="n">Td</span><span class="p">)</span>
    <span class="n">h</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)):</span>
        <span class="n">t_shifted</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">filter_order</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="n">t_shifted</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">h</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">F0</span><span class="p">)</span> <span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">roll_off</span> <span class="o">*</span> <span class="p">((</span><span class="mi">4</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="k">elif</span> <span class="n">t_shifted</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">8</span> <span class="o">/</span> <span class="n">roll_off</span> <span class="o">/</span> <span class="n">F0</span> <span class="ow">or</span> <span class="n">t_shifted</span> <span class="o">==</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">8</span> <span class="o">/</span> <span class="n">roll_off</span> <span class="o">/</span> <span class="n">F0</span> <span class="p">:</span>
            <span class="n">h</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">roll_off</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">F0</span><span class="p">))</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">/</span> <span class="n">roll_off</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">/</span> <span class="n">roll_off</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">factor1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">F0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">64</span> <span class="o">*</span> <span class="n">roll_off</span><span class="o">*</span> <span class="n">roll_off</span> <span class="o">*</span> <span class="n">F0</span> <span class="o">*</span> <span class="n">F0</span> <span class="o">*</span> <span class="n">t_shifted</span> <span class="o">*</span> <span class="n">t_shifted</span><span class="p">)</span>
            <span class="n">factor2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">F1</span> <span class="o">*</span> <span class="n">t_shifted</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">F0</span> <span class="o">*</span> <span class="n">t_shifted</span><span class="p">)</span>
            <span class="n">factor3</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">roll_off</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">F2</span> <span class="o">*</span> <span class="n">t_shifted</span><span class="p">)</span> 
            <span class="n">h</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">factor1</span> <span class="o">*</span> <span class="p">(</span><span class="n">factor2</span> <span class="o">+</span> <span class="n">factor3</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">t</span><span class="p">,</span><span class="n">h</span>


<span class="c1"># The function upSample increases the number of samples of a signal signal by adding nsamp-1</span>
<span class="c1"># zeros after each sample of the signal</span>
<span class="k">def</span> <span class="nf">upSample</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">nsamp</span><span class="p">):</span>
    <span class="n">upSampled</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span> <span class="o">*</span> <span class="n">nsamp</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="n">nsamp</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">upSampled</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">signal</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="n">nsamp</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">upSampled</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">upSampled</span>


<span class="c1"># The function downSample reduces the sampling frequency of a signal signal by a factor of nsamp</span>
<span class="c1"># by keeping only the samples that are multiples of nsamp (0, nsamp, 2*nsamp, ...)</span>
<span class="k">def</span> <span class="nf">downSample</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">nsamp</span><span class="p">):</span>
    <span class="n">downSampled</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">signal</span><span class="p">),</span> <span class="n">nsamp</span><span class="p">):</span>
        <span class="n">downSampled</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">signal</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        
    <span class="k">return</span> <span class="n">downSampled</span>


<span class="c1"># Adds white Gaussian noise with mean value μ (mu) and variance σ^2 (sigma)</span>
<span class="k">def</span> <span class="nf">generateAWGN</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    <span class="n">noise</span> <span class="o">=</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">signal</span><span class="p">))</span> <span class="o">+</span> <span class="n">mu</span>
    <span class="k">return</span> <span class="n">noise</span>


<span class="c1"># Loading animation</span>
<span class="n">loading</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    &lt;div style=&#39;display: flex; justify-content: center; align-items: center; height: 80px;&#39;&gt;</span>
<span class="s2">        &lt;div class=&#39;loader&#39; style=&#39;border: 12px solid #f3f3f3; /* Light grey */</span>
<span class="s2">                                     border-top: 12px solid #01cc97; /* Blue */</span>
<span class="s2">                                     border-radius: 50%;</span>
<span class="s2">                                     width: 40px;</span>
<span class="s2">                                     height: 40px;</span>
<span class="s2">                                     animation: spin 2s linear infinite;&#39;&gt;&lt;/div&gt;</span>
<span class="s2">    &lt;/div&gt;</span>
<span class="s2">    &lt;style&gt;</span>
<span class="s2">    @keyframes spin {</span>
<span class="s2">        0% { transform: rotate(0deg); }</span>
<span class="s2">        100% { transform: rotate(360deg); }</span>
<span class="s2">    }</span>
<span class="s2">    &lt;/style&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="n">done</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        &lt;div style=&#39;display: flex; justify-content: center; align-items: center; height: 80px;&#39;&gt;</span>
<span class="s2">            &lt;div style=&#39;font-size: 40px; color: #01cc97;&#39;&gt;&amp;#10003;&lt;/div&gt;</span>
<span class="s2">        &lt;/div&gt;</span>
<span class="s2">        &quot;&quot;&quot;</span>
<span class="n">loader_html1</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span>
  <span class="n">value</span><span class="o">=</span><span class="n">loading</span>
<span class="p">)</span>
<span class="n">timer_html1</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span>
    <span class="n">value</span><span class="o">=</span><span class="s2">&quot;Elapsed time: - seconds&quot;</span>
<span class="p">)</span>

<span class="c1"># Output widget for dynamic updates</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">Output</span><span class="p">()</span>

<span class="k">global</span> <span class="n">filt</span><span class="p">,</span> <span class="n">g_delay</span><span class="p">,</span> <span class="n">g_nsamp</span>
<span class="k">def</span> <span class="nf">interactive_signal_processing1</span><span class="p">(</span><span class="n">n_bits</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">roll_off</span><span class="p">,</span> <span class="n">nsamp</span><span class="p">,</span> <span class="n">delay</span><span class="p">):</span>
    <span class="c1"># Start timer</span>
    <span class="n">loader_html1</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">loading</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="k">global</span> <span class="n">filt</span><span class="p">,</span> <span class="n">g_delay</span><span class="p">,</span> <span class="n">g_nsamp</span>
    <span class="n">g_delay</span> <span class="o">=</span> <span class="n">delay</span>
    <span class="n">g_nsamp</span> <span class="o">=</span> <span class="n">nsamp</span>
    <span class="n">bitstream</span> <span class="o">=</span> <span class="n">generateRandomBits</span><span class="p">(</span><span class="n">n_bits</span><span class="p">)</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">L</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">k</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">log2</span><span class="p">(</span><span class="n">L</span><span class="p">))</span>
    <span class="n">y_levels</span> <span class="o">=</span> <span class="n">createLevels</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span>
    <span class="n">symbols</span> <span class="o">=</span> <span class="n">createSymbols</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">bitstream</span><span class="p">)</span>
    <span class="n">gray_encoding</span> <span class="o">=</span> <span class="n">grayCode</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>

    <span class="n">x_gray</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_levels</span><span class="p">[</span><span class="n">gray_encoding</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">symbol</span><span class="p">)]</span> <span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="n">symbols</span><span class="p">]</span>
    <span class="n">t_filter</span><span class="p">,</span> <span class="n">filt</span> <span class="o">=</span> <span class="n">rootRaisedCosine</span><span class="p">(</span><span class="n">nsamp</span><span class="p">,</span> <span class="n">roll_off</span><span class="p">,</span> <span class="n">delay</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">upSample</span><span class="p">(</span><span class="n">x_gray</span><span class="p">,</span> <span class="n">nsamp</span><span class="p">)</span>
    <span class="n">y_transmitted</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">filt</span><span class="p">)</span>
    <span class="n">y_received</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">y_transmitted</span><span class="p">,</span> <span class="n">filt</span><span class="p">)</span>
    <span class="n">y_final</span> <span class="o">=</span> <span class="n">downSample</span><span class="p">(</span><span class="n">y_received</span><span class="p">,</span> <span class="n">nsamp</span><span class="p">)</span>
    <span class="n">y_final</span> <span class="o">=</span> <span class="n">y_final</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">delay</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_final</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">delay</span><span class="p">]</span>
    <span class="k">with</span> <span class="n">output</span><span class="p">:</span>
        <span class="n">output</span><span class="o">.</span><span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Clear previous output</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>  <span class="c1"># Create a figure object</span>

        <span class="c1"># First subplot - Root Raised Cosine Filter</span>
        <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># First plot in the first row, first column</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_filter</span><span class="p">,</span> <span class="n">filt</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Root Raised Cosine Filter&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Second subplot - Continuous signal with stems</span>
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># Second plot in the first row, second column</span>
        <span class="n">t_continuous</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_transmitted</span><span class="p">[:</span><span class="mi">10</span><span class="o">*</span><span class="n">nsamp</span><span class="p">]))</span>  <span class="c1"># Time vector for continuous signal</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_continuous</span><span class="p">,</span> <span class="n">y_transmitted</span><span class="p">[:</span><span class="mi">10</span><span class="o">*</span><span class="n">nsamp</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Filtered Signal&#39;</span><span class="p">)</span>

        <span class="c1"># Generating stem positions for original symbols</span>
        <span class="n">t_symbols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="o">*</span><span class="n">nsamp</span><span class="p">,</span> <span class="n">nsamp</span><span class="p">)</span>  <span class="c1"># Stem positions every nsamp samples</span>

        <span class="c1"># Get the corresponding y-values from y_transmitted at the stem positions</span>
        <span class="n">y_stems</span> <span class="o">=</span> <span class="n">y_transmitted</span><span class="p">[</span><span class="n">t_symbols</span><span class="p">]</span>

        <span class="n">ax2</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">t_symbols</span><span class="p">,</span> <span class="n">y_stems</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;C1-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;C1o&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original Symbols&#39;</span><span class="p">)</span>

        <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Signal Visualization&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Third subplot - Signal Visualization</span>
        <span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># Third plot in the second row, first column</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">[:</span><span class="mi">10</span><span class="p">]))</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y_final</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x_gray</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Signal Visualization&#39;</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Received&#39;</span><span class="p">,</span><span class="s1">&#39;Transmittted&#39;</span><span class="p">])</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Fourth subplot - Power Spectral Density of the Received Signal</span>
        <span class="n">ax4</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>  <span class="c1"># Fourth plot in the second row, second column</span>
        <span class="n">f</span><span class="p">,</span> <span class="n">Pxx_den</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">welch</span><span class="p">(</span><span class="n">y_received</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hamming&#39;</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">8192</span><span class="p">)</span>
        <span class="n">Pxx_den</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Pxx_den</span><span class="p">)</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Pxx_den</span><span class="p">)</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Power Spectral Density of the Received Signal&#39;</span><span class="p">)</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Normalized Frequency&#39;</span><span class="p">)</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Power/Frequency [dB]&#39;</span><span class="p">)</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>  <span class="c1"># Adjust the layout</span>
            
        <span class="c1"># Show elapsed time</span>
        <span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="n">timer_html1</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Elapsed time: </span><span class="si">{</span><span class="n">elapsed_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds&quot;</span>
        <span class="n">loader_html1</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">done</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="c1"># Widget setup</span>
<span class="n">n_bits_slider1</span> <span class="o">=</span> <span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Bitstream Length&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;initial&#39;</span><span class="p">},</span> <span class="n">layout</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">),</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">roll_off_slider1</span> <span class="o">=</span> <span class="n">FloatSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Roll-off Factor&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;initial&#39;</span><span class="p">},</span> <span class="n">layout</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">),</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">L_dropdown1</span> <span class="o">=</span> <span class="n">Dropdown</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)],</span> <span class="n">value</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;ASK Levels&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;initial&#39;</span><span class="p">},</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">nsamp_slider1</span> <span class="o">=</span> <span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;nsamp&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;initial&#39;</span><span class="p">},</span> <span class="n">layout</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">),</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">delay_slider1</span> <span class="o">=</span> <span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Group Delay&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;initial&#39;</span><span class="p">},</span> <span class="n">layout</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">),</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">w</span> <span class="o">=</span> <span class="n">interactive</span><span class="p">(</span><span class="n">interactive_signal_processing1</span><span class="p">,</span> <span class="n">n_bits</span><span class="o">=</span><span class="n">n_bits_slider1</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="n">L_dropdown1</span><span class="p">,</span> <span class="n">roll_off</span><span class="o">=</span><span class="n">roll_off_slider1</span><span class="p">,</span> <span class="n">nsamp</span><span class="o">=</span><span class="n">nsamp_slider1</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delay_slider1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">update_filter_order1</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="n">filter_order1</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">nsamp_slider1</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="n">delay_slider1</span><span class="o">.</span><span class="n">value</span>
    <span class="n">filter_order_display1</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">filter_order1</span>

<span class="c1"># Observers</span>
<span class="n">nsamp_slider1</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">update_filter_order1</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)</span>
<span class="n">delay_slider1</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">update_filter_order1</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)</span>

<span class="c1"># Display filter order</span>
<span class="n">filter_order_display1</span> <span class="o">=</span> <span class="n">IntText</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">nsamp_slider1</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="n">delay_slider1</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Filter Order:&#39;</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">inputs</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">n_bits_slider1</span><span class="p">,</span> <span class="n">roll_off_slider1</span><span class="p">,</span> <span class="n">nsamp_slider1</span><span class="p">,</span> <span class="n">delay_slider1</span><span class="p">,</span> <span class="n">filter_order_display1</span><span class="p">,</span> <span class="n">L_dropdown1</span><span class="p">])</span>

<span class="c1"># Group the loader and timer together (they will appear next to each other horizontally)</span>
<span class="n">loader_timer_box</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">loader_html1</span><span class="p">,</span> <span class="n">timer_html1</span><span class="p">],</span> <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">margin</span><span class="o">=</span><span class="s1">&#39;0 0 0 20px&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">))</span>

<span class="n">ui</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="n">inputs</span><span class="p">,</span> <span class="n">loader_timer_box</span><span class="p">],</span> <span class="n">layout</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="n">align_items</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">flex_flow</span><span class="o">=</span><span class="s1">&#39;row nowrap&#39;</span><span class="p">))</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">flex</span> <span class="o">=</span> <span class="s1">&#39;1 1 auto&#39;</span>  <span class="c1"># Flex-grow, flex-shrink, flex-basis</span>
<span class="n">loader_timer_box</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">flex</span> <span class="o">=</span> <span class="s1">&#39;0 1 auto&#39;</span>  <span class="c1"># No flex-grow, flex-shrink, fixed basis as needed</span>

<span class="c1"># Layout</span>
<span class="n">display</span><span class="p">(</span><span class="n">ui</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>

<span class="c1"># Initial update of filter order</span>
<span class="n">update_filter_order</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "3bc954c7fef0486ab882cd9be3180a58"}</script><script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "3d00eb75a93248be908395711831c248"}</script><div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">273</span>
<span class="g g-Whitespace">    </span><span class="mi">270</span> <span class="n">display</span><span class="p">(</span><span class="n">ui</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">272</span> <span class="c1"># Initial update of filter order</span>
<span class="ne">--&gt; </span><span class="mi">273</span> <span class="n">update_filter_order</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;update_filter_order&#39; is not defined
</pre></div>
</div>
</div>
</div>
</section>
<section id="part-3-performance-calculation-ber-vs-eb-no">
<h2>Part 3: Performance calculation: BER vs Eb/No.<a class="headerlink" href="#part-3-performance-calculation-ber-vs-eb-no" title="Permalink to this heading">#</a></h2>
<p>Study of the effect of parameters: Nyquist filter order and roll-off</p>
<p>For 8-ASK, obtain the BER-Eb/No curve theoretically and by simulation</p>
<ul class="simple">
<li><p>with roll-off=0.1 and filter order</p>
<ol class="arabic simple">
<li><p>80 (4 periods, group_delay =2T)</p></li>
<li><p>160 (8 periods, group_delay =4T)</p></li>
<li><p>320 (16 periods, group_delay =8T).</p></li>
</ol>
</li>
<li><p>with roll-off=0.2 and filter order as in cases a,b,c above.</p></li>
<li><p>with roll-off=0.4 and filter class as in cases a,b,c above</p></li>
</ul>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>For Maximum Likelihood estimation, compare each received symbol (sample at the output
of the matched filter) with the elements of the mapping vector. The position of the closest
element in the vector will also give the corresponding codeword. The following code snippet is an
implementation of this forator.</p>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Code<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="o">%</span> <span class="n">yr</span><span class="p">:</span> <span class="n">the</span> <span class="n">received</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">at</span> <span class="n">the</span> <span class="n">matched</span> <span class="nb">filter</span> <span class="n">output</span>
<span class="o">%</span> <span class="n">xr</span><span class="p">:</span> <span class="n">the</span> <span class="n">encoded</span> <span class="n">bit</span> <span class="n">word</span><span class="p">,</span> <span class="n">k</span> <span class="n">bits</span>
<span class="n">m</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="nb">min</span><span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">yr</span> <span class="o">-</span> <span class="n">val</span><span class="p">),</span> <span class="n">idx</span><span class="p">)</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mapping</span><span class="p">))</span>
<span class="n">xr</span> <span class="o">=</span> <span class="n">de2bi</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="s1">&#39;left-msb&#39;</span><span class="p">)</span>

</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--2-input--2" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% yr: the received symbol, at the matched filter output</span>
<span class="c">% xr: the encoded bit word, k bits</span>
<span class="p">[</span><span class="n">m</span><span class="p">,</span><span class="nb">j</span><span class="p">]=</span><span class="nb">min</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">mapping</span><span class="o">-</span><span class="n">yr</span><span class="p">));</span>
<span class="n">xr</span><span class="p">=</span><span class="n">de2bi</span><span class="p">(</span><span class="nb">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="s">&#39;left-msb&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>
</details><div class="cell tag_thebe-init tag_hide-code-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Loading animation</span>
<span class="n">loading</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    &lt;div style=&#39;display: flex; justify-content: center; align-items: center; height: 80px;&#39;&gt;</span>
<span class="s2">        &lt;div class=&#39;loader&#39; style=&#39;border: 12px solid #f3f3f3; /* Light grey */</span>
<span class="s2">                                     border-top: 12px solid #01cc97; /* Blue */</span>
<span class="s2">                                     border-radius: 50%;</span>
<span class="s2">                                     width: 40px;</span>
<span class="s2">                                     height: 40px;</span>
<span class="s2">                                     animation: spin 2s linear infinite;&#39;&gt;&lt;/div&gt;</span>
<span class="s2">    &lt;/div&gt;</span>
<span class="s2">    &lt;style&gt;</span>
<span class="s2">    @keyframes spin {</span>
<span class="s2">        0% { transform: rotate(0deg); }</span>
<span class="s2">        100% { transform: rotate(360deg); }</span>
<span class="s2">    }</span>
<span class="s2">    &lt;/style&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="n">done</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        &lt;div style=&#39;display: flex; justify-content: center; align-items: center; height: 80px;&#39;&gt;</span>
<span class="s2">            &lt;div style=&#39;font-size: 40px; color: #01cc97;&#39;&gt;&amp;#10003;&lt;/div&gt;</span>
<span class="s2">        &lt;/div&gt;</span>
<span class="s2">        &quot;&quot;&quot;</span>
<span class="n">loader_html2</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span>
  <span class="n">value</span><span class="o">=</span><span class="n">loading</span>
<span class="p">)</span>
<span class="n">timer_html2</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span>
    <span class="n">value</span><span class="o">=</span><span class="s2">&quot;Elapsed time: - seconds&quot;</span>
<span class="p">)</span>

<span class="c1"># This function wraps the signal processing and BER calculation, making parameters adjustable via sliders</span>
<span class="k">def</span> <span class="nf">interactive_signal_processing2</span><span class="p">(</span><span class="n">n_bits</span><span class="o">=</span><span class="mi">80000</span><span class="p">,</span> <span class="n">roll_off</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">nsamp</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="mi">16</span><span class="p">):</span>
    <span class="c1"># Start timer</span>
    <span class="n">loader_html2</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">loading</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="n">bitstream</span> <span class="o">=</span> <span class="n">generateRandomBits</span><span class="p">(</span><span class="n">n_bits</span><span class="p">)</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">L</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">k</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">log2</span><span class="p">(</span><span class="n">L</span><span class="p">))</span>
    <span class="n">y_levels</span> <span class="o">=</span> <span class="n">createLevels</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span>
    <span class="n">symbols</span> <span class="o">=</span> <span class="n">createSymbols</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">bitstream</span><span class="p">)</span>
    <span class="n">gray_encoding</span> <span class="o">=</span> <span class="n">grayCode</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>

    <span class="n">x_gray</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_levels</span><span class="p">[</span><span class="n">gray_encoding</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">symbol</span><span class="p">)]</span> <span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="n">symbols</span><span class="p">]</span>
    <span class="n">t_filter</span><span class="p">,</span> <span class="n">filt</span> <span class="o">=</span> <span class="n">rootRaisedCosine</span><span class="p">(</span><span class="n">nsamp</span><span class="p">,</span> <span class="n">roll_off</span><span class="p">,</span> <span class="n">delay</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">upSample</span><span class="p">(</span><span class="n">x_gray</span><span class="p">,</span> <span class="n">nsamp</span><span class="p">)</span>
    <span class="n">y_transmitted</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">filt</span><span class="p">)</span>

    <span class="c1"># Calculating BER theoretically and via simulation</span>
    <span class="n">berTheoretical</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">berSimulation</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">EbN0_max</span> <span class="o">=</span> <span class="mi">20</span>

    <span class="k">for</span> <span class="n">EbN0_db</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">EbN0_max</span><span class="p">):</span>
        <span class="n">EbN0</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">EbN0_db</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">SNR_db</span> <span class="o">=</span> <span class="n">EbN0_db</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">nsamp</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">k</span><span class="p">)</span>
        <span class="n">SNR</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">SNR_db</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">P</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">y_transmitted</span> <span class="o">*</span> <span class="n">y_transmitted</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_transmitted</span><span class="p">)</span>
        <span class="n">Pn</span> <span class="o">=</span> <span class="n">P</span> <span class="o">/</span> <span class="n">SNR</span>

        <span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">Pn</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_transmitted</span><span class="p">))</span>
        <span class="n">y_noisy</span> <span class="o">=</span> <span class="n">y_transmitted</span> <span class="o">+</span> <span class="n">noise</span>

        <span class="n">z_received</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">y_noisy</span><span class="p">,</span> <span class="n">filt</span><span class="p">)</span>
        <span class="n">z_final</span> <span class="o">=</span> <span class="n">downSample</span><span class="p">(</span><span class="n">z_received</span><span class="p">,</span> <span class="n">nsamp</span><span class="p">)</span>
        <span class="n">z_final</span> <span class="o">=</span> <span class="n">z_final</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">delay</span> <span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">z_final</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">delay</span><span class="p">]</span>

        <span class="n">errors</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">z_final</span><span class="p">)):</span>
            <span class="n">differences</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_levels</span> <span class="o">-</span> <span class="n">z_final</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">differences</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">y_levels</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">!=</span> <span class="n">x_gray</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">errors</span> <span class="o">+=</span> <span class="mi">1</span>
        
        <span class="n">berSimulation</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">errors</span> <span class="o">/</span> <span class="n">n_bits</span><span class="p">)</span>
        <span class="n">Pe</span> <span class="o">=</span> <span class="p">(</span><span class="n">L</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">L</span> <span class="o">*</span> <span class="n">erfc</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">k</span> <span class="o">/</span> <span class="p">(</span><span class="n">L</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">EbN0</span><span class="p">))</span>
        <span class="n">berTheoretical</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Pe</span> <span class="o">/</span> <span class="n">k</span><span class="p">)</span>
    
    <span class="c1"># Plotting the BER</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span> <span class="n">berTheoretical</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Theoretical&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">berSimulation</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Simulation&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Eb/N0 (dB)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Bit Error Rate&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;BER Curve for L-ASK&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># Show elapsed time</span>
    <span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
    <span class="n">timer_html2</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Elapsed time: </span><span class="si">{</span><span class="n">elapsed_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds&quot;</span>
    <span class="n">loader_html2</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">done</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Creating sliders and dropdown</span>
<span class="n">n_bits_slider2</span> <span class="o">=</span> <span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">80000</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Binary Sequence Length&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;initial&#39;</span><span class="p">},</span> <span class="n">layout</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">),</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">roll_off_slider2</span> <span class="o">=</span> <span class="n">FloatSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Roll-off Factor&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;initial&#39;</span><span class="p">},</span> <span class="n">layout</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">),</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">nsamp_slider2</span> <span class="o">=</span> <span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;nsamp&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;initial&#39;</span><span class="p">},</span> <span class="n">layout</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">),</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">delay_slider2</span> <span class="o">=</span> <span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Group Delay&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;initial&#39;</span><span class="p">},</span> <span class="n">layout</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">),</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">L_dropdown2</span> <span class="o">=</span> <span class="n">Dropdown</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)],</span> <span class="n">value</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;ASK Levels&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;initial&#39;</span><span class="p">},</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Reordering the widgets</span>
<span class="n">interactive_plot</span> <span class="o">=</span> <span class="n">interactive</span><span class="p">(</span><span class="n">interactive_signal_processing2</span><span class="p">,</span> <span class="n">n_bits</span><span class="o">=</span><span class="n">n_bits_slider2</span><span class="p">,</span> <span class="n">roll_off</span><span class="o">=</span><span class="n">roll_off_slider2</span><span class="p">,</span> <span class="n">nsamp</span><span class="o">=</span><span class="n">nsamp_slider2</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delay_slider2</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="n">L_dropdown2</span><span class="p">)</span>

<span class="c1"># Display filter order</span>
<span class="n">filter_order_display2</span> <span class="o">=</span> <span class="n">IntText</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">nsamp_slider2</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="n">delay_slider2</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Filter Order:&#39;</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">update_filter_order2</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="n">filter_order2</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">nsamp_slider2</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="n">delay_slider2</span><span class="o">.</span><span class="n">value</span>
    <span class="n">filter_order_display2</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">filter_order2</span>

<span class="c1"># Observers</span>
<span class="n">nsamp_slider2</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">update_filter_order2</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)</span>
<span class="n">delay_slider2</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">update_filter_order2</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)</span>

<span class="n">input_widgets</span> <span class="o">=</span> <span class="n">VBox</span><span class="p">([</span><span class="n">n_bits_slider2</span><span class="p">,</span> <span class="n">roll_off_slider2</span><span class="p">,</span> <span class="n">nsamp_slider2</span><span class="p">,</span> <span class="n">delay_slider2</span><span class="p">,</span> <span class="n">filter_order_display2</span><span class="p">,</span> <span class="n">L_dropdown2</span><span class="p">],</span> <span class="n">layout</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="n">flex</span><span class="o">=</span><span class="s1">&#39;1 1 auto&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">))</span>
<span class="n">plot_output</span> <span class="o">=</span> <span class="n">interactive_plot</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># The output plot</span>

<span class="c1"># Group the loader and timer together (they will appear next to each other horizontally)</span>
<span class="n">loader_timer_box</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">loader_html2</span><span class="p">,</span> <span class="n">timer_html2</span><span class="p">],</span> <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">margin</span><span class="o">=</span><span class="s1">&#39;0 0 0 20px&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">))</span>

<span class="c1"># Create a VBox that includes both the input widgets and the loading animation</span>
<span class="n">inputs_and_loader</span> <span class="o">=</span> <span class="n">HBox</span><span class="p">([</span><span class="n">input_widgets</span><span class="p">,</span> <span class="n">loader_timer_box</span><span class="p">])</span>

<span class="c1"># Create an HBox to hold everything in a horizontal layout</span>
<span class="n">ui</span> <span class="o">=</span> <span class="n">VBox</span><span class="p">([</span><span class="n">inputs_and_loader</span><span class="p">,</span> <span class="n">plot_output</span><span class="p">])</span>

<span class="c1"># Display the UI components</span>
<span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Clear the previous output</span>
<span class="n">display</span><span class="p">(</span><span class="n">ui</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "3226219cd5654d01abbd94bae0cf3b23", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
<section id="part-4-the-effect-of-the-coding-method-gray-or-other">
<h2>Part 4: The effect of the coding method: Gray or other<a class="headerlink" href="#part-4-the-effect-of-the-coding-method-gray-or-other" title="Permalink to this heading">#</a></h2>
<p>Produce BER-Eb/No curves for 16-ASK and 8-ASK with other coding (not Gray), e.g.
with mapping=-(L-1):step:(L-1), and compare them with the theoretical ones.
What do you observe?</p>
<div class="cell tag_thebe-init tag_hide-code-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Loading animation</span>
<span class="n">loading</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    &lt;div style=&#39;display: flex; justify-content: center; align-items: center; height: 80px;&#39;&gt;</span>
<span class="s2">        &lt;div class=&#39;loader&#39; style=&#39;border: 12px solid #f3f3f3; /* Light grey */</span>
<span class="s2">                                     border-top: 12px solid #01cc97; /* Blue */</span>
<span class="s2">                                     border-radius: 50%;</span>
<span class="s2">                                     width: 40px;</span>
<span class="s2">                                     height: 40px;</span>
<span class="s2">                                     animation: spin 2s linear infinite;&#39;&gt;&lt;/div&gt;</span>
<span class="s2">    &lt;/div&gt;</span>
<span class="s2">    &lt;style&gt;</span>
<span class="s2">    @keyframes spin {</span>
<span class="s2">        0% { transform: rotate(0deg); }</span>
<span class="s2">        100% { transform: rotate(360deg); }</span>
<span class="s2">    }</span>
<span class="s2">    &lt;/style&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="n">done</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        &lt;div style=&#39;display: flex; justify-content: center; align-items: center; height: 80px;&#39;&gt;</span>
<span class="s2">            &lt;div style=&#39;font-size: 40px; color: #01cc97;&#39;&gt;&amp;#10003;&lt;/div&gt;</span>
<span class="s2">        &lt;/div&gt;</span>
<span class="s2">        &quot;&quot;&quot;</span>
<span class="n">loader_html3</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span>
  <span class="n">value</span><span class="o">=</span><span class="n">loading</span>
<span class="p">)</span>
<span class="n">timer_html3</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span>
    <span class="n">value</span><span class="o">=</span><span class="s2">&quot;Elapsed time: - seconds&quot;</span>
<span class="p">)</span>

<span class="k">def</span> <span class="nf">interactive_signal_processing_with_natural</span><span class="p">(</span><span class="n">n_bits</span><span class="o">=</span><span class="mi">80000</span><span class="p">,</span> <span class="n">roll_off</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">nsamp</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="mi">16</span><span class="p">):</span>
    <span class="c1"># Start timer</span>
    <span class="n">loader_html3</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">loading</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="c1"># Common setup</span>
    <span class="n">bitstream</span> <span class="o">=</span> <span class="n">generateRandomBits</span><span class="p">(</span><span class="n">n_bits</span><span class="p">)</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">L</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">k</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">log2</span><span class="p">(</span><span class="n">L</span><span class="p">))</span>
    <span class="n">y_levels</span> <span class="o">=</span> <span class="n">createLevels</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span>
    <span class="n">symbols</span> <span class="o">=</span> <span class="n">createSymbols</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">bitstream</span><span class="p">)</span>

    <span class="c1"># Gray encoding setup</span>
    <span class="n">gray_encoding</span> <span class="o">=</span> <span class="n">grayCode</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="n">x_gray</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_levels</span><span class="p">[</span><span class="n">gray_encoding</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">symbol</span><span class="p">)]</span> <span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="n">symbols</span><span class="p">]</span>

    <span class="c1"># Natural encoding setup</span>
    <span class="n">natural_encoding</span> <span class="o">=</span> <span class="n">naturalBinaryCoding</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="n">x_natural</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_levels</span><span class="p">[</span><span class="n">natural_encoding</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">symbol</span><span class="p">)]</span> <span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="n">symbols</span><span class="p">]</span>

    <span class="c1"># Root raised cosine filter (common for both Gray and Natural)</span>
    <span class="n">t_filter</span><span class="p">,</span> <span class="n">filt</span> <span class="o">=</span> <span class="n">rootRaisedCosine</span><span class="p">(</span><span class="n">nsamp</span><span class="p">,</span> <span class="n">roll_off</span><span class="p">,</span> <span class="n">delay</span><span class="p">)</span>

    <span class="c1"># Transmission simulation for Gray encoding</span>
    <span class="n">y_gray</span> <span class="o">=</span> <span class="n">upSample</span><span class="p">(</span><span class="n">x_gray</span><span class="p">,</span> <span class="n">nsamp</span><span class="p">)</span>
    <span class="n">y_transmitted_gray</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">y_gray</span><span class="p">,</span> <span class="n">filt</span><span class="p">)</span>

    <span class="c1"># Transmission simulation for Natural encoding</span>
    <span class="n">y_natural</span> <span class="o">=</span> <span class="n">upSample</span><span class="p">(</span><span class="n">x_natural</span><span class="p">,</span> <span class="n">nsamp</span><span class="p">)</span>
    <span class="n">y_transmitted_natural</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">y_natural</span><span class="p">,</span> <span class="n">filt</span><span class="p">)</span>

    <span class="c1"># Calculate BER for Gray encoding</span>
    <span class="n">berTheoretical</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">berSimulation_gray</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">berSimulation_natural</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># For natural encoding</span>
    <span class="n">EbN0_max</span> <span class="o">=</span> <span class="mi">20</span>

    <span class="k">for</span> <span class="n">EbN0_db</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">EbN0_max</span><span class="p">):</span>
        <span class="c1"># Convert Eb/N0 from dB to linear scale</span>
        <span class="n">EbN0</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">EbN0_db</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">)</span>
        <span class="n">SNR_db</span> <span class="o">=</span> <span class="n">EbN0_db</span> <span class="o">-</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">nsamp</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">k</span><span class="p">)</span>
        <span class="n">SNR</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">SNR_db</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">)</span>

        <span class="c1"># Calculate the power of the transmitted signal and the noise power to achieve the desired SNR</span>
        <span class="n">P</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">y_transmitted_gray</span> <span class="o">*</span> <span class="n">y_transmitted_gray</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_transmitted_gray</span><span class="p">)</span>
        <span class="n">P_db</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
        <span class="n">Pn_db</span> <span class="o">=</span> <span class="n">P_db</span> <span class="o">-</span> <span class="n">SNR_db</span>
        <span class="n">Pn</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">Pn_db</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">)</span>

        <span class="c1"># Add noise (common for both Gray and Natural)</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Pn</span><span class="p">)</span>
        <span class="n">noise</span> <span class="o">=</span> <span class="n">generateAWGN</span><span class="p">(</span><span class="n">y_transmitted_gray</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
        <span class="n">y_noisy_gray</span> <span class="o">=</span> <span class="n">y_transmitted_gray</span> <span class="o">+</span> <span class="n">noise</span>
        <span class="n">y_noisy_natural</span> <span class="o">=</span> <span class="n">y_transmitted_natural</span> <span class="o">+</span> <span class="n">noise</span>

        <span class="c1"># Receiver simulation for Gray encoding</span>
        <span class="n">z_received_gray</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">y_noisy_gray</span><span class="p">,</span> <span class="n">filt</span><span class="p">)</span>
        <span class="n">z_final_gray</span> <span class="o">=</span> <span class="n">downSample</span><span class="p">(</span><span class="n">z_received_gray</span><span class="p">,</span> <span class="n">nsamp</span><span class="p">)</span>
        <span class="n">z_final_gray</span> <span class="o">=</span> <span class="n">z_final_gray</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">delay</span> <span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">z_final_gray</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">delay</span><span class="p">]</span>

        <span class="c1"># Receiver simulation for Natural encoding (Code 1)</span>
        <span class="n">z_received_natural</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">y_noisy_natural</span><span class="p">,</span> <span class="n">filt</span><span class="p">)</span>
        <span class="n">z_final_natural</span> <span class="o">=</span> <span class="n">downSample</span><span class="p">(</span><span class="n">z_received_natural</span><span class="p">,</span> <span class="n">nsamp</span><span class="p">)</span>
        <span class="n">z_final_natural</span> <span class="o">=</span> <span class="n">z_final_natural</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">delay</span> <span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">z_final_natural</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">delay</span><span class="p">]</span>

        <span class="c1"># Error calculation for Gray encoding</span>
        <span class="c1"># Decision for the level corresponding to the symbol received for Gray encoding</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">z_final_gray</span><span class="p">)):</span>
            <span class="c1"># Array with the differences of the signal from the levels</span>
            <span class="n">differences</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_levels</span> <span class="o">-</span> <span class="n">z_final_gray</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> 
            <span class="n">m</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">differences</span><span class="p">)</span> <span class="c1"># Find the minimum distance</span>
            <span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">differences</span> <span class="o">==</span> <span class="n">m</span><span class="p">)</span>
            <span class="n">z_final_gray</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_levels</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        
        <span class="c1"># We assume that each error in Gray encoding results in one incorrect bit</span>
        <span class="n">error</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">z_final_gray</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">x_gray</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">z_final_gray</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">error</span> <span class="o">+=</span> <span class="mi">1</span>
        
        <span class="c1"># BER calculation = number of errors / number of bits</span>
        <span class="n">berSimulation_gray</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error</span><span class="o">/</span><span class="n">n_bits</span><span class="p">)</span>

        <span class="c1"># Error calculation for Natural encoding </span>
        <span class="c1"># Decision for the level corresponding to the symbol received</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">z_final_natural</span><span class="p">)):</span>
            <span class="n">differences</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_levels</span> <span class="o">-</span> <span class="n">z_final_natural</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">m</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">differences</span><span class="p">)</span>
            <span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">differences</span> <span class="o">==</span> <span class="n">m</span><span class="p">)</span>
            <span class="n">z_final_natural</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_levels</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        
        <span class="c1"># The final_symbols contains the bits that were decided to be received</span>
        <span class="n">final_symbols</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">z_final_natural</span><span class="p">)):</span>
            <span class="c1"># Mapping each decided level to its binary encoding</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">y_levels</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">z_final_natural</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">final_symbols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">natural_encoding</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>

        <span class="c1"># For each incorrect symbol, we need to check how many bits were wrong,</span>
        <span class="c1"># as the encoding of neighboring levels no longer differs by only one bit </span>
        <span class="n">error</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">z_final_natural</span><span class="p">)):</span>
            <span class="c1"># If a symbol is wrong, check how many digits were received incorrectly</span>
            <span class="k">if</span> <span class="n">x_natural</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">z_final_natural</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="n">i</span><span class="p">])):</span>
                    <span class="k">if</span> <span class="n">symbols</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">!=</span> <span class="n">final_symbols</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]:</span>
                        <span class="n">error</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">berSimulation_natural</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error</span><span class="o">/</span><span class="n">n_bits</span><span class="p">)</span>
        <span class="c1"># Theoretical BER calculation (common for both Gray and Natural)</span>
        <span class="n">Pe</span> <span class="o">=</span> <span class="p">(</span><span class="n">L</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">L</span> <span class="o">*</span> <span class="n">erfc</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">k</span> <span class="o">/</span> <span class="p">(</span><span class="n">L</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">EbN0</span><span class="p">))</span>
        <span class="n">berTheoretical</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Pe</span> <span class="o">/</span> <span class="n">k</span><span class="p">)</span>

    <span class="c1"># Plotting the BER for both Gray and Natural encoding</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">EbN0_max</span><span class="p">),</span> <span class="n">berTheoretical</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Theoretical&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">EbN0_max</span><span class="p">),</span> <span class="n">berSimulation_gray</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gray&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">EbN0_max</span><span class="p">),</span> <span class="n">berSimulation_natural</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Natural&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Eb/N0 (dB)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Bit Error Rate&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;BER Curve for L-ASK&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Show elapsed time</span>
    <span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
    <span class="n">timer_html3</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Elapsed time: </span><span class="si">{</span><span class="n">elapsed_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds&quot;</span>
    <span class="n">loader_html3</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">done</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="c1"># Creating sliders and dropdown</span>
<span class="n">n_bits_slider1</span> <span class="o">=</span> <span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">80000</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Binary Sequence Length&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;initial&#39;</span><span class="p">},</span> <span class="n">layout</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">),</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">roll_off_slider1</span> <span class="o">=</span> <span class="n">FloatSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Roll-off Factor&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;initial&#39;</span><span class="p">},</span> <span class="n">layout</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">),</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">nsamp_slider1</span> <span class="o">=</span> <span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;nsamp&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;initial&#39;</span><span class="p">},</span> <span class="n">layout</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">),</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">delay_slider1</span> <span class="o">=</span> <span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Group Delay&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;initial&#39;</span><span class="p">},</span> <span class="n">layout</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">),</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">L_dropdown1</span> <span class="o">=</span> <span class="n">Dropdown</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)],</span> <span class="n">value</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;ASK Levels&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;initial&#39;</span><span class="p">},</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Reordering the widgets</span>
<span class="n">interactive_plot</span> <span class="o">=</span> <span class="n">interactive</span><span class="p">(</span><span class="n">interactive_signal_processing_with_natural</span><span class="p">,</span> <span class="n">n_bits</span><span class="o">=</span><span class="n">n_bits_slider1</span><span class="p">,</span> <span class="n">roll_off</span><span class="o">=</span><span class="n">roll_off_slider1</span><span class="p">,</span> <span class="n">nsamp</span><span class="o">=</span><span class="n">nsamp_slider1</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delay_slider1</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="n">L_dropdown1</span><span class="p">)</span>

<span class="n">input_widgets</span> <span class="o">=</span> <span class="n">VBox</span><span class="p">([</span><span class="n">n_bits_slider1</span><span class="p">,</span> <span class="n">roll_off_slider1</span><span class="p">,</span> <span class="n">nsamp_slider1</span><span class="p">,</span> <span class="n">delay_slider1</span><span class="p">,</span> <span class="n">L_dropdown1</span><span class="p">],</span> <span class="n">layout</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="n">flex</span><span class="o">=</span><span class="s1">&#39;1 1 auto&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">))</span>
<span class="n">plot_output</span> <span class="o">=</span> <span class="n">interactive_plot_with_natural</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># The output plot</span>

<span class="c1"># Group the loader and timer together (they will appear next to each other horizontally)</span>
<span class="n">loader_timer_box</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">loader_html3</span><span class="p">,</span> <span class="n">timer_html3</span><span class="p">],</span> <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">margin</span><span class="o">=</span><span class="s1">&#39;0 0 0 20px&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">))</span>

<span class="c1"># Create a VBox that includes both the input widgets and the loading animation</span>
<span class="n">inputs_and_loader</span> <span class="o">=</span> <span class="n">HBox</span><span class="p">([</span><span class="n">input_widgets</span><span class="p">,</span> <span class="n">loader_timer_box</span><span class="p">])</span>

<span class="c1"># Create an HBox to hold everything in a horizontal layout</span>
<span class="n">ui</span> <span class="o">=</span> <span class="n">VBox</span><span class="p">([</span><span class="n">inputs_and_loader</span><span class="p">,</span> <span class="n">plot_output</span><span class="p">])</span>

<span class="c1"># Display the UI components</span>
<span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Clear the previous output</span>
<span class="n">display</span><span class="p">(</span><span class="n">ui</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">line</span> <span class="mi">174</span>
<span class="g g-Whitespace">    </span><span class="mi">171</span> <span class="n">interactive_plot</span> <span class="o">=</span> <span class="n">interactive</span><span class="p">(</span><span class="n">interactive_signal_processing_with_natural</span><span class="p">,</span> <span class="n">n_bits</span><span class="o">=</span><span class="n">n_bits_slider1</span><span class="p">,</span> <span class="n">roll_off</span><span class="o">=</span><span class="n">roll_off_slider1</span><span class="p">,</span> <span class="n">nsamp</span><span class="o">=</span><span class="n">nsamp_slider1</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delay_slider1</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="n">L_dropdown1</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">173</span> <span class="n">input_widgets</span> <span class="o">=</span> <span class="n">VBox</span><span class="p">([</span><span class="n">n_bits_slider1</span><span class="p">,</span> <span class="n">roll_off_slider1</span><span class="p">,</span> <span class="n">nsamp_slider1</span><span class="p">,</span> <span class="n">delay_slider1</span><span class="p">,</span> <span class="n">L_dropdown1</span><span class="p">],</span> <span class="n">layout</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="n">flex</span><span class="o">=</span><span class="s1">&#39;1 1 auto&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">))</span>
<span class="ne">--&gt; </span><span class="mi">174</span> <span class="n">plot_output</span> <span class="o">=</span> <span class="n">interactive_plot_with_natural</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># The output plot</span>
<span class="g g-Whitespace">    </span><span class="mi">176</span> <span class="c1"># Group the loader and timer together (they will appear next to each other horizontally)</span>
<span class="g g-Whitespace">    </span><span class="mi">177</span> <span class="n">loader_timer_box</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">loader_html3</span><span class="p">,</span> <span class="n">timer_html3</span><span class="p">],</span> <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">margin</span><span class="o">=</span><span class="s1">&#39;0 0 0 20px&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">))</span>

<span class="ne">NameError</span>: name &#39;interactive_plot_with_natural&#39; is not defined
</pre></div>
</div>
</div>
</div>
</section>
<section id="part-5-calculation-of-system-parameters">
<h2>Part 5: Calculation of system parameters<a class="headerlink" href="#part-5-calculation-of-system-parameters" title="Permalink to this heading">#</a></h2>
<p>Adjust the parameters of the 16-ASK transmission system to the following actual data/requirements:</p>
<ul class="simple">
<li><p>Width of (baseband) bandwidth <span class="math notranslate nohighlight">\(W = 1 \text{ MHz}\)</span></p></li>
<li><p>Noise spectrum density <span class="math notranslate nohighlight">\(N_0 = 100 \text{ picowatt/Hz}\)</span> (one-sided)</p></li>
<li><p><span class="math notranslate nohighlight">\(5 \text{ Mbps}\)</span> transmission rate</p></li>
<li><p>Tolerable <span class="math notranslate nohighlight">\(BER=2 \text{ Kbps}\)</span></p></li>
</ul>
<p>Confirm the specifications in bandwidth and BER.</p>
<p><strong>Connection with theory</strong>: The required (baseband) bandwidth with Nyquist signaling, is equal to:</p>
<div class="math notranslate nohighlight">
\[W = \frac{1}{2T}(1+\alpha)\]</div>
<p>where α the roll-off factor of the Nyquist filter and <span class="math notranslate nohighlight">\( \frac{1}{T} \)</span> the symbol transmission rate (also called Baud Rate). On the other hand, the transmission rate, <span class="math notranslate nohighlight">\(R\)</span> (bits/s), is related to <span class="math notranslate nohighlight">\( \frac{1}{T} \)</span> and the size of the sign constellation, L, with the relation:</p>
<div class="math notranslate nohighlight">
\[\frac{R}{\log_2 L} = \frac{l}{T} \]</div>
<p><span class="math notranslate nohighlight">\( \frac{1}{T} \)</span> consists the connecting parameter between <span class="math notranslate nohighlight">\(W\)</span> and <span class="math notranslate nohighlight">\(R\)</span>.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "ntua-el17840/Interactive-Digital-Communications",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Digcom_Lab3.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Lab Exercise 3: Matched Filters and L-ASK</p>
      </div>
    </a>
    <a class="right-next"
       href="Digcom_Lab5.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lab Exercise 5</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup">Setup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-packages-we-will-need-later-in-python">Importing packages we will need later in Python</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1-useful-code">Part 1: Useful Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2-signal-generation-with-nyquist-filters-time-and-frequency-plots">Part 2: Signal generation with Nyquist filters – Time and frequency plots</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-3-performance-calculation-ber-vs-eb-no">Part 3: Performance calculation: BER vs Eb/No.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-4-the-effect-of-the-coding-method-gray-or-other">Part 4: The effect of the coding method: Gray or other</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-5-calculation-of-system-parameters">Part 5: Calculation of system parameters</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By ECE - NTUA
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>