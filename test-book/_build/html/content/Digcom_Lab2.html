

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Lab Exercise 2 &#8212; Interactive Digital Communtications</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script src="../_static/tabs.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/custom.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/Digcom_Lab2';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Εργαστηριακή Άσκηση 3" href="Digcom_Lab3.html" />
    <link rel="prev" title="Lab Exercise 1" href="Digcom_Lab1.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Interactive Digital Communtications - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Interactive Digital Communtications - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Intro to Digital Communications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../digital_communications_intro.html">Interactive python interpreter (IPython) notebook</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lab Exercises</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Digcom_Lab1.html">Lab Exercise 1</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Lab Exercise 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="Digcom_Lab3.html">Εργαστηριακή Άσκηση 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="Digcom_Lab4.html">Εργαστηριακή Άσκηση 4</a></li>
<li class="toctree-l1"><a class="reference internal" href="Digcom_Lab5.html">Εργαστηριακή Άσκηση 5</a></li>
<li class="toctree-l1"><a class="reference internal" href="Digcom_Lab6.html">Εργαστηριακή Άσκηση 6</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ntua-el17840/Interactive-Digital-Communications" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ntua-el17840/Interactive-Digital-Communications/issues/new?title=Issue%20on%20page%20%2Fcontent/Digcom_Lab2.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/content/Digcom_Lab2.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lab Exercise 2</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1-training">Part 1: Training</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2-theory">Part 2: Theory</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">Exercise</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-3-design-and-implementation-of-filters">Part 3: Design and implementation of filters</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-window-method">The Window Method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#equal-ripple-method">Equal Ripple Method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#experiment">Experiment</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#rectangular-window-simple-truncation-of-h">Rectangular Window (simple truncation of h)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#filter-application">Filter Application</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-4-application-a">Part 4: Application A</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1">Question 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-2">Question 2</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-5-application-b4">Part 5: Application B4</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="lab-exercise-2">
<h1>Lab Exercise 2<a class="headerlink" href="#lab-exercise-2" title="Permalink to this heading">#</a></h1>
<p>The purpose of the second series of exercises is to familiarize with the design functions of finite impulse response (FIR) filters and their implementation in Python &amp; MATLAB.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Before you start the exercise, you should carefully study Chapter 1 and, in particular, paragraph 1.3 of the course booklet.</p>
</div>
<section id="part-1-training">
<h2>Part 1: Training<a class="headerlink" href="#part-1-training" title="Permalink to this heading">#</a></h2>
<div class="admonition-live-code admonition">
<p class="admonition-title">Live Code</p>
<p>Press the following button to make python code interactive. It will connect you to a kernel once it says “ready” (might take a bit, especially the first time it runs).</p>
</div>
<div style="text-align: center;">
  <button title="Launch thebe" class="thebelab-button thebe-launch-button" onclick="initThebe()">Python Interactive Code</button>
</div></section>
<section id="part-2-theory">
<h2>Part 2: Theory<a class="headerlink" href="#part-2-theory" title="Permalink to this heading">#</a></h2>
<p>In MATLAB, the functions <span class="math notranslate nohighlight">\(fft\)</span> and <span class="math notranslate nohighlight">\(ifft\)</span> assume a pair of Fourier transforms <span class="math notranslate nohighlight">\(x(t)\)</span> and <span class="math notranslate nohighlight">\(X(f)\)</span> calculated in non-negative intervals <span class="math notranslate nohighlight">\(t=[0:N-1]ts\)</span> and <span class="math notranslate nohighlight">\(f=[0:N-1]fo. \)</span> As you have already seen in Laboratory Exercise 1, the upper half of the frequency interval corresponds to the negative frequencies of the signal, when calculating <span class="math notranslate nohighlight">\(X(f)\)</span> with the help of the <span class="math notranslate nohighlight">\(fft\)</span> function (for real-valued signals, these two halves are mirror images with respect to the middle of the interval). The same applies to the upper half of the time interval, when the signal <span class="math notranslate nohighlight">\(x(t)\)</span> results from the inverse Fourier transform through <span class="math notranslate nohighlight">\(ifft\)</span>.</p>
<p>MATLAB has the <span class="math notranslate nohighlight">\(fftshift\)</span> function to cyclically shift the values of the signal or the Fourier transform so that they correspond to zero-centered bilateral intervals, i.e., at times <span class="math notranslate nohighlight">\(tb=[-ceil((N-1)/2): floor((N-1)/2)]ts\)</span> or frequencies <span class="math notranslate nohighlight">\(fb=[–ceil((N-1)/2): floor((N-1)/2)]fo\)</span>. This way, we can produce <span class="math notranslate nohighlight">\(xb(t)\)</span> and <span class="math notranslate nohighlight">\(Xb(f)\)</span> that correspond to the bilateral representation of the signal and the Fourier transform.</p>
<p>To understand the above, consider the vector <span class="math notranslate nohighlight">\([1 2 3 4]\)</span> as the result of a length 4 <span class="math notranslate nohighlight">\(FFT\)</span>. Then, the first element (1) is the dc term, the third element (3) is the point at half the sampling frequency <span class="math notranslate nohighlight">\(fs/2\)</span>, which can be interpreted as corresponding either to <span class="math notranslate nohighlight">\(–fs/2\)</span> or <span class="math notranslate nohighlight">\(+fs/2\)</span>. The elements 2 and 4 correspond to frequencies <span class="math notranslate nohighlight">\(+fs/4\)</span> and <span class="math notranslate nohighlight">\(–fs/4\)</span>. By applying <span class="math notranslate nohighlight">\(fftshift\)</span>, the element 3 appears first, meaning that in MATLAB it corresponds to the negative frequency <span class="math notranslate nohighlight">\(–fs/2\)</span>, the next element 4 corresponds to the frequency <span class="math notranslate nohighlight">\(–fs/4\)</span> followed by the dc and the frequency <span class="math notranslate nohighlight">\(+fs/4\)</span>. For an odd-length transformation, there is no point for <span class="math notranslate nohighlight">\(±fs/2\)</span>. Thus, for the vector <span class="math notranslate nohighlight">\([1 2 3]\)</span>, applying <span class="math notranslate nohighlight">\(fftshift\)</span> will yield the elements corresponding to the frequencies <span class="math notranslate nohighlight">\(–fs/3, 0, +fs/3\)</span>.</p>
<p>Besides producing outputs with negative frequencies or times in the upper half of the vector, both <span class="math notranslate nohighlight">\(fft\)</span> and <span class="math notranslate nohighlight">\(ifft\)</span> functions expect as input a vector in the same format, since obviously the identities hold</p>
<center>
<p><span class="math notranslate nohighlight">\(h == \text{ifft}(\text{fft}(h))\)</span> and <span class="math notranslate nohighlight">\(H == \text{fft}(\text{ifft}(H))\)</span></p>
</center>
<p>The first indicates that the input of <span class="math notranslate nohighlight">\(ifft\)</span> should be reversed, as produced by <span class="math notranslate nohighlight">\(fft\)</span>, and the second that the input of <span class="math notranslate nohighlight">\(fft\)</span> should be reversed, as produced by <span class="math notranslate nohighlight">\(ifft\)</span>.</p>
<p>In the next figure, you see illustratively a sinusoidal signal that has been multiplied by a Blackman window both in the bilateral, and the unilateral representation.</p>
<img alt="../_images/lab2_1.png" class="align-center" src="../_images/lab2_1.png" />
<p>The corresponding Fourier transforms, in bilateral and unilateral representation, are shown in the next figure:</p>
<img alt="../_images/lab2_2.png" class="align-center" src="../_images/lab2_2.png" />
<p>When <span class="math notranslate nohighlight">\(x(t)\)</span> and <span class="math notranslate nohighlight">\(X(f)\)</span> are produced by MATLAB, no special attention is needed, except for the cyclic shift in case, for example, we want to plot the bilateral spectrum or signal. However, when one of <span class="math notranslate nohighlight">\(x(t)\)</span> or <span class="math notranslate nohighlight">\(X(f)\)</span> is defined by the user, more attention is required, because usually, the bilateral signals or spectra are used. You can move from one representation to the other as follows:</p>
<p><span class="math notranslate nohighlight">\(x = ifftshift(xb)\)</span>, <span class="math notranslate nohighlight">\(X = fft(x)\)</span>, <span class="math notranslate nohighlight">\(Xb = fftshift(X)\)</span>, if you start from a bilateral signal and want to end up with a bilateral spectrum, and</p>
<p><span class="math notranslate nohighlight">\(X = ifftshift(Xb)\)</span>, <span class="math notranslate nohighlight">\(x = ifft(X)\)</span>, <span class="math notranslate nohighlight">\(xb = fftshift(x)\)</span>, if you start from a bilateral spectrum and want to end up with a bilateral signal,</p>
<p>where the MATLAB function <span class="math notranslate nohighlight">\(ifftshift\)</span> performs the inverse operation of <span class="math notranslate nohighlight">\(fftshift\)</span>. When <span class="math notranslate nohighlight">\(N\)</span> is even, <span class="math notranslate nohighlight">\(fftshift\)</span> and <span class="math notranslate nohighlight">\(ifftshift\)</span> yield the same result. However, when <span class="math notranslate nohighlight">\(N\)</span> is odd, this is not the case, and care must be taken in their use. In practice, careful application of the above is important when calculating the phase of the spectrum. The amplitude of the spectrum is not affected by the cyclic shift of elements caused by <span class="math notranslate nohighlight">\(fftshift\)</span> and <span class="math notranslate nohighlight">\(ifftshift\)</span> (see DFT properties).</p>
<section id="exercise">
<h3>Exercise<a class="headerlink" href="#exercise" title="Permalink to this heading">#</a></h3>
<p>Try the following in the command window to consolidate the use of the <span class="math notranslate nohighlight">\(fftshift\)</span> and <span class="math notranslate nohighlight">\(ifftshift\)</span> functions.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Code<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Create the array X</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># equivalent to MATLAB&#39;s -2:2</span>

<span class="c1"># Apply fftshift and ifftshift</span>
<span class="n">fftshifted_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">ifftshifted_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifftshift</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Double fftshift and a combination of fftshift and ifftshift</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>

<span class="c1"># Check if arrays are equal</span>
<span class="n">X_equals_Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="n">X_equals_Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;X equals Y: </span><span class="si">{</span><span class="n">X_equals_Y</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;X equals Z: </span><span class="si">{</span><span class="n">X_equals_Z</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="nb">fftshift</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="nb">ifftshift</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">Y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">fftshift</span><span class="p">(</span><span class="nb">fftshift</span><span class="p">(</span><span class="n">X</span><span class="p">));</span>
<span class="n">Z</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">ifftshift</span><span class="p">(</span><span class="nb">fftshift</span><span class="p">(</span><span class="n">X</span><span class="p">));</span>
<span class="nb">isequal</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>
<span class="nb">isequal</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</details><p>Question 1: Which of the vectors Y and Z equals X? Write your answer in a text file lab2_nnnnn.txt, where nnnnn are the last five numbers of your registration number, using Notepad from the Windows menu (Start → Programs → Accessories → Notepad) and save it in the My Documents folder. You will submit this file electronically at the end, after answering the next questions, so you can leave it open.</p>
<p>Question 2: Repeat with <span class="math notranslate nohighlight">\(X=[-1:2]\)</span>. What do you observe? Write your answer in the text file lab2_nnnnn.txt. Try the following two examples in the command window to consolidate the use of the <span class="math notranslate nohighlight">\(fftshift\)</span> and <span class="math notranslate nohighlight">\(ifftshift\)</span> functions in combination with <span class="math notranslate nohighlight">\(fft\)</span> and <span class="math notranslate nohighlight">\(ifft\)</span>.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Code<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.fft</span> <span class="kn">import</span> <span class="n">fft</span><span class="p">,</span> <span class="n">ifft</span><span class="p">,</span> <span class="n">fftshift</span><span class="p">,</span> <span class="n">ifftshift</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">Layout</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="c1"># First part: Original signal and its FFT</span>
<span class="n">xb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">ifftshift</span><span class="p">(</span><span class="n">xb</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">Xb</span> <span class="o">=</span> <span class="n">fftshift</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>  <span class="c1"># Spectrum with DC component in the center</span>

<span class="c1"># Second part: Low-pass filter effect</span>
<span class="n">Xb_low_pass</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">X_low_pass</span> <span class="o">=</span> <span class="n">ifftshift</span><span class="p">(</span><span class="n">Xb_low_pass</span><span class="p">)</span>
<span class="n">x_low_pass</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="n">X_low_pass</span><span class="p">)</span>
<span class="n">xb_low_pass</span> <span class="o">=</span> <span class="n">fftshift</span><span class="p">(</span><span class="n">x_low_pass</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>

<span class="c1"># Function to plot</span>
<span class="k">def</span> <span class="nf">plot_signals</span><span class="p">():</span>
    <span class="n">fig1</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="n">time_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">time_range</span><span class="p">,</span> <span class="n">xb</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;r-&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original Signal&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>

    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">time_range</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Xb</span><span class="p">),</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;r-&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Magnitude Spectrum&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude&#39;</span><span class="p">)</span>

    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">time_range</span><span class="p">,</span> <span class="n">Xb_low_pass</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;r-&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Low-pass Spectrum&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude&#39;</span><span class="p">)</span>

    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">time_range</span><span class="p">,</span> <span class="n">xb_low_pass</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;mo&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;r-&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Reconstructed Signal&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plot_signals</span><span class="p">()</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="nb">close</span><span class="w"> </span><span class="nb">all</span><span class="p">;</span><span class="w"> </span><span class="n">clear</span><span class="w"> </span><span class="s">all</span><span class="p">;</span><span class="nb">clc</span><span class="p">;</span>
<span class="n">xb</span><span class="p">=[</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="c">% πραγματικό σήμα με άρτια συμμετρία</span>
<span class="nb">figure</span><span class="p">;</span><span class="w"> </span><span class="nb">subplot</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="nb">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">4</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span><span class="n">xb</span><span class="p">);</span><span class="w"> </span><span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;xb&#39;</span><span class="p">);</span>
<span class="n">x</span><span class="p">=</span><span class="nb">ifftshift</span><span class="p">(</span><span class="n">xb</span><span class="p">)</span><span class="w"> </span><span class="c">% το σήμα με τις αρνητικές συνιστώσες στο άνω μέρος</span>
<span class="n">X</span><span class="p">=</span><span class="nb">fft</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="c">% FFT</span>
<span class="n">Xb</span><span class="p">=</span><span class="nb">fftshift</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="w"> </span><span class="c">% το φάσμα με τη dc συνιστώσα στο κέντρο, πραγματικές</span>
<span class="c">% τιμές με άρτια συμμετρία όπως αναμένεται</span>
<span class="nb">subplot</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="nb">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">4</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span><span class="n">Xb</span><span class="p">);</span><span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Xb&#39;</span><span class="p">);</span>
<span class="n">close</span><span class="w"> </span><span class="s">all</span><span class="p">;</span><span class="w"> </span><span class="n">clear</span><span class="w"> </span><span class="s">all</span><span class="p">;</span><span class="nb">clc</span><span class="p">;</span>
<span class="n">Xb</span><span class="p">=[</span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="c">% φάσμα βαθυπερατού σήματος με άρτια συμμετρία</span>
<span class="nb">figure</span><span class="p">;</span><span class="w"> </span><span class="nb">subplot</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="nb">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">4</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span><span class="n">Xb</span><span class="p">);</span><span class="w"> </span><span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Xb&#39;</span><span class="p">);</span>
<span class="n">X</span><span class="p">=</span><span class="nb">ifftshift</span><span class="p">(</span><span class="n">Xb</span><span class="p">)</span><span class="w"> </span><span class="c">% το φάσμα με τις αρνητικές συνιστώσες στο άνω μέρος</span>
<span class="n">x</span><span class="p">=</span><span class="nb">ifft</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="w"> </span><span class="c">% IFFT</span>
<span class="n">xb</span><span class="p">=</span><span class="nb">fftshift</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="c">% πραγματικό σήμα με άρτια συμμετρία όπως αναμένεται</span>
<span class="nb">subplot</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="nb">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">4</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span><span class="n">xb</span><span class="p">);</span><span class="w"> </span><span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;xb&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>
</details><div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/b94f7017a7de2880ff8085bec5763c59fb534ee6e56296b2e3c8c8225501a2dd.png" src="../_images/b94f7017a7de2880ff8085bec5763c59fb534ee6e56296b2e3c8c8225501a2dd.png" />
</div>
</div>
<p>Question 3: Modify the previous example so that you start directly with the definition of the spectrum of the low-pass signal <span class="math notranslate nohighlight">\(X\)</span> as expected by the <span class="math notranslate nohighlight">\(ifft\)</span>. Write your answer in the text file lab2_nnnnn.txt.</p>
</section>
</section>
<section id="part-3-design-and-implementation-of-filters">
<h2>Part 3: Design and implementation of filters<a class="headerlink" href="#part-3-design-and-implementation-of-filters" title="Permalink to this heading">#</a></h2>
<p>We will deal with Example 1.2 of paragraph 1.5 of the course’s issue. This example presents two alternative methods for designing FIR filters:
a) the window method, and
b) the equal ripple method,
which it applies in the case of low-pass filters.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The code in Matlab is included in the course’s book in Example 1.2 (Code 1.3).</p>
</div>
<p>In the example, the filters are tested on a real signal, s, which is stored in the file sima.mat (a binary MATLAB file). This is a sonar signal with a spectrum extending up to about 4 KHz and a sampling frequency of Fs=8192 (it is also stored in the sima.mat file, along with the signal). Note that, in the code of the example, the loading of sima.mat (line 6) precedes, allowing the use of the variables s, Fs in the rest of it (lines 7-44).</p>
<section id="the-window-method">
<h3>The Window Method<a class="headerlink" href="#the-window-method" title="Permalink to this heading">#</a></h3>
<p>The window method is applied in lines 8-38 of the code. The first step is the definition of the frequency response H of an ideal low-pass filter with a cutoff frequency of <span class="math notranslate nohighlight">\(Fs/8\)</span> (line 9), using a vector of length <span class="math notranslate nohighlight">\(N=Fs\)</span>, leading to a frequency resolution of <span class="math notranslate nohighlight">\(fo = Fs /N = 1 Hz\)</span>. The H vector consists of a sequence of ones and zeros created by calling the <span class="math notranslate nohighlight">\(ones\)</span> and <span class="math notranslate nohighlight">\(zeros\)</span> functions, respectively. For more information about these functions, you can consult MATLAB documentation by typing <span class="math notranslate nohighlight">\(doc\)</span> <span class="math notranslate nohighlight">\(‘function-name’\)</span> in the command window, where <span class="math notranslate nohighlight">\(‘function-name’\)</span> is the name of the function. The first <span class="math notranslate nohighlight">\(Fs/8\)</span> elements of <span class="math notranslate nohighlight">\(H\)</span>, corresponding to frequencies <span class="math notranslate nohighlight">\([0,Fs/8)\)</span>, are ones, followed by <span class="math notranslate nohighlight">\(3Fs/4\)</span> zeros and another <span class="math notranslate nohighlight">\(Fs/8\)</span> ones corresponding to the frequency band <span class="math notranslate nohighlight">\([–Fs/8, 0)\)</span>.</p>
<p>The next step is the calculation of the Inverse Discrete Fourier Transform <span class="math notranslate nohighlight">\(IDFT\)</span>, computed by MATLAB’s <span class="math notranslate nohighlight">\(ifft\)</span> function (line 12). This is followed by a rearrangement of the inverse <span class="math notranslate nohighlight">\(DFT\)</span> result (lines 13-14), equivalent to shifting the filter’s impulse response by half its length. Then, the impulse response <span class="math notranslate nohighlight">\(h\)</span> is truncated to lengths of 32+1, 64+1, and 128+1 samples (lines 15-17). With the help of <span class="math notranslate nohighlight">\(wvtool\)</span> (Window Visualization Tool), the impulse response and the frequency response of the low-pass filter for the above lengths are displayed on the same diagram. The <span class="math notranslate nohighlight">\(wvtool\)</span> is a tool similar to <span class="math notranslate nohighlight">\(wintool\)</span> and is used for visualizing windows in both time and frequency domains. Notice that the longer the filter length, the smaller the side lobes in the frequency response.
To further reduce these side lobes and the effects of the rectangular window, <span class="math notranslate nohighlight">\(Hamming\)</span> and <span class="math notranslate nohighlight">\(Kaiser\)</span> windows are constructed (via the <span class="math notranslate nohighlight">\(hamming\)</span> and <span class="math notranslate nohighlight">\(kaiser\)</span> functions, respectively, lines 24-25) and applied to the 64+1 point length filter <span class="math notranslate nohighlight">\(h64\)</span> (lines 27-30). Through the <span class="math notranslate nohighlight">\(wvtool\)</span> (line 31), observe the significantly lower level of side lobes in the frequency response of the <span class="math notranslate nohighlight">\(Hamming\)</span> and <span class="math notranslate nohighlight">\(Kaiser\)</span> windows compared to the rectangular one. Finally, the signal s is filtered with each of the three filters (rectangular, <span class="math notranslate nohighlight">\(Hamming\)</span>, <span class="math notranslate nohighlight">\(Kaiser\)</span>), using the <span class="math notranslate nohighlight">\(conv()\)</span> function that computes the convolution between the signal and the impulse response of each filter (lines 33-38). Concurrently, the power spectrum density by <span class="math notranslate nohighlight">\(Welch\)</span> is calculated and plotted using the <span class="math notranslate nohighlight">\(pwelch\)</span> function. The result clearly shows a sharp reduction in spectral power for frequencies above <span class="math notranslate nohighlight">\(Fs/8\)</span>.</p>
</section>
<section id="equal-ripple-method">
<h3>Equal Ripple Method<a class="headerlink" href="#equal-ripple-method" title="Permalink to this heading">#</a></h3>
<p>The equal ripple method is applied in lines 40-44 of the code for the construction of a <span class="math notranslate nohighlight">\(Parks-McClellan\)</span> filter. The filter is built by calling the <span class="math notranslate nohighlight">\(firpm\)</span> function (line 41). For the definition of the input parameters of <span class="math notranslate nohighlight">\(firpm\)</span>, consult MATLAB documentation. The filter’s application to the signal is done in the same way as the previous method, using the <span class="math notranslate nohighlight">\(conv\)</span> function (line 43).</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Code<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">remez</span><span class="p">,</span> <span class="n">convolve</span><span class="p">,</span> <span class="n">welch</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy.io</span>
<span class="kn">import</span> <span class="nn">sounddevice</span> <span class="k">as</span> <span class="nn">sd</span>

<span class="c1">#6</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../files/sima.txt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">f</span><span class="p">]</span>
<span class="n">s</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">Fs</span><span class="o">=</span><span class="mi">8192</span>


<span class="c1"># 7</span>
<span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">welch</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">Fs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency [Hz]&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;PSD [V**2/Hz]&#39;</span><span class="p">)</span>

<span class="c1"># 8-9</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">Fs</span> <span class="o">//</span> <span class="mi">2</span>  <span class="c1"># Adjusted for Python indexing, assuming Fs is even</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="o">//</span><span class="mi">4</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="o">//</span><span class="mi">4</span><span class="p">)))</span>

<span class="c1"># 10-14</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">real</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>  <span class="c1"># Equivalent to MATLAB&#39;s circshift for centering the impulse response</span>

<span class="c1"># 15-17</span>
<span class="n">h32</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="o">-</span><span class="mi">16</span><span class="p">:</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">17</span><span class="p">]</span>
<span class="n">h64</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="o">-</span><span class="mi">32</span><span class="p">:</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">33</span><span class="p">]</span>
<span class="n">h128</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="o">-</span><span class="mi">64</span><span class="p">:</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">65</span><span class="p">]</span>

<span class="c1"># 18 - Stem plot for h64</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h64</span><span class="p">)),</span> <span class="n">h64</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Stem Plot of h64&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Samples&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="c1"># 19 - Frequency response of h64</span>
<span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">h64</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">Fs</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">))</span>  <span class="c1"># Normalizing frequency to Hz</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Frequency Response of h64&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="c1"># 20 - For visualizing the frequency responses of h32, h64, and h128 together</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="k">for</span> <span class="n">filt</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">h32</span><span class="p">,</span> <span class="n">h64</span><span class="p">,</span> <span class="n">h128</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;h32&#39;</span><span class="p">,</span> <span class="s1">&#39;h64&#39;</span><span class="p">,</span> <span class="s1">&#39;h128&#39;</span><span class="p">]):</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">filt</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">Fs</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Frequency Responses of h32, h64, h128&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 22-26</span>
<span class="n">wh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hamming</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h64</span><span class="p">))</span>
<span class="n">wk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">kaiser</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h64</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wh</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hamming&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wk</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Kaiser&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="c1"># 27-30</span>
<span class="n">h_hamming</span> <span class="o">=</span> <span class="n">h64</span> <span class="o">*</span> <span class="n">wh</span>
<span class="n">h_kaiser</span> <span class="o">=</span> <span class="n">h64</span> <span class="o">*</span> <span class="n">wk</span>

<span class="c1"># 31 `wvtool` equivalent visualization</span>
<span class="c1"># Plot the impulse responses</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">markers</span><span class="p">,</span> <span class="n">stemlines</span><span class="p">,</span> <span class="n">baseline</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h64</span><span class="p">)),</span> <span class="n">h64</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;C0-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;C0o&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;h64&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">markers</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>  <span class="c1"># Adjusting marker size for better visibility</span>
<span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">stemlines</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>  <span class="c1"># Adjusting stem line style</span>

<span class="n">markers</span><span class="p">,</span> <span class="n">stemlines</span><span class="p">,</span> <span class="n">baseline</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h_hamming</span><span class="p">)),</span> <span class="n">h_hamming</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;C1-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;C1o&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;h_hamming&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">markers</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">stemlines</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>

<span class="n">markers</span><span class="p">,</span> <span class="n">stemlines</span><span class="p">,</span> <span class="n">baseline</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h_kaiser</span><span class="p">)),</span> <span class="n">h_kaiser</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;C2-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;C2o&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s2">&quot;C2&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;h_kaiser&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">markers</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">stemlines</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Impulse Responses&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Samples&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Plot the frequency responses</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">filt</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">h64</span><span class="p">,</span> <span class="n">h_hamming</span><span class="p">,</span> <span class="n">h_kaiser</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;h64&#39;</span><span class="p">,</span> <span class="s1">&#39;h_hamming&#39;</span><span class="p">,</span> <span class="s1">&#39;h_kaiser&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">]):</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">filt</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">Fs</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Frequency Responses&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 32-38 Filtering and plotting PSD</span>
<span class="n">y_rect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">h64</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
<span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">welch</span><span class="p">(</span><span class="n">y_rect</span><span class="p">,</span> <span class="n">Fs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">();</span><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency [Hz]&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;PSD [V**2/Hz]&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;h64&#39;</span><span class="p">)</span>

<span class="n">y_hamm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">h_hamming</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
<span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">welch</span><span class="p">(</span><span class="n">y_hamm</span><span class="p">,</span> <span class="n">Fs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">();</span><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency [Hz]&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;PSD [V**2/Hz]&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;h_hamming&#39;</span><span class="p">)</span>

<span class="n">y_kais</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">h_kaiser</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
<span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">welch</span><span class="p">(</span><span class="n">y_kais</span><span class="p">,</span> <span class="n">Fs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency [Hz]&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;PSD [V**2/Hz]&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;h_kaiser&#39;</span><span class="p">)</span>

<span class="c1"># 40-44  Parks-McClellan low-pass filter</span>
<span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span> <span class="o">*</span> <span class="n">Fs</span>  <span class="c1"># Scale frequencies correctly</span>
<span class="n">gain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="c1"># Call firwin2 with corrected parameters and using the `fs` parameter</span>
<span class="n">hpm</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">firwin2</span><span class="p">(</span><span class="mi">65</span><span class="p">,</span> <span class="n">freq</span><span class="p">,</span> <span class="n">gain</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">Fs</span><span class="p">)</span>
<span class="n">s_pm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">hpm</span><span class="p">,</span> <span class="s1">&#39;same&#39;</span><span class="p">)</span>

<span class="c1"># Plotting or analyzing the filtered signals (y_rect, y_hamm, y_kais, s_pm) can be done similarly</span>
<span class="c1"># For example, to plot the PSD:</span>
<span class="n">f</span><span class="p">,</span> <span class="n">Pxx_spec</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">welch</span><span class="p">(</span><span class="n">s_pm</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="s1">&#39;flattop&#39;</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="n">scaling</span><span class="o">=</span><span class="s1">&#39;spectrum&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Pxx_spec</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;frequency [Hz]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Linear spectrum [V RMS]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Power spectrum (welch)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 45-46 Playing sound (s and s_pm assumed as original and filtered signal)</span>
<span class="n">sd</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="mi">20</span> <span class="o">*</span> <span class="n">s</span><span class="p">,</span> <span class="n">Fs</span><span class="p">);</span> <span class="n">sd</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
<span class="c1"># sd.play(20 * s_lp, Fs); sd.wait()  # Uncomment and adjust variable name as needed for the filtered signal</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--2-input--2" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="mf">1.</span><span class="w"> </span><span class="nb">clear</span><span class="w"> </span><span class="nb">all</span><span class="p">;</span><span class="w"> </span><span class="n">close</span><span class="w"> </span><span class="s">all</span><span class="p">;</span>
<span class="mf">2.</span><span class="w"> </span><span class="c">% Το αρχείο &quot;sima.mat&quot; περιέχει το σήμα s και τη συχνότητα</span>
<span class="mf">3.</span><span class="w"> </span><span class="c">% δειγματοληψίας Fs. Το φάσμα του σήματος εκτείνεται σχεδόν σε όλη την</span>
<span class="mf">4.</span><span class="w"> </span><span class="c">% περιοχή συχνοτήτων μέχρι 4 KHz. Πάνω από 1 KHz, όμως, είναι θόρυβος</span>
<span class="mf">5.</span><span class="w"> </span><span class="c">% και πρέπει να φιλτραριστεί.</span>
<span class="mf">6.</span><span class="w"> </span><span class="nb">load</span><span class="w"> </span><span class="n">sima</span><span class="p">;</span>
<span class="mf">7.</span><span class="w"> </span><span class="nb">figure</span><span class="p">;</span><span class="w"> </span><span class="n">pwelch</span><span class="p">(</span><span class="n">s</span><span class="p">,[],[],[],</span><span class="n">Fs</span><span class="p">);</span>
<span class="mf">8.</span><span class="w"> </span><span class="c">% Ορίζεται η ιδανική βαθυπερατή συνάρτηση Η, με συχνότ. αποκοπ. Fs/8</span>
<span class="mf">9.</span><span class="w"> </span><span class="n">H</span><span class="p">=[</span><span class="nb">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Fs</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Fs</span><span class="o">-</span><span class="n">Fs</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="nb">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Fs</span><span class="o">/</span><span class="mi">8</span><span class="p">)];</span>
<span class="mf">10.</span><span class="w"> </span><span class="c">% Υπολογίζεται η κρουστική απόκριση με αντίστροφο μετασχ. Fourier</span>
<span class="mf">11.</span><span class="w"> </span><span class="c">% Εναλλακτικά, μπορεί να χρησιμοποιηθεί η αναλυτική σχέση Sa(x)</span>
<span class="mf">12.</span><span class="w"> </span><span class="n">h</span><span class="p">=</span><span class="nb">ifft</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="s">&#39;symmetric&#39;</span><span class="p">);</span>
<span class="mf">13.</span><span class="w"> </span><span class="n">middle</span><span class="p">=</span><span class="nb">length</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
<span class="mf">14.</span><span class="w"> </span><span class="n">h</span><span class="p">=[</span><span class="n">h</span><span class="p">(</span><span class="n">middle</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="k">end</span><span class="p">)</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">middle</span><span class="p">)];</span>
<span class="mf">15.</span><span class="w"> </span><span class="n">h32</span><span class="p">=</span><span class="n">h</span><span class="p">(</span><span class="n">middle</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="mi">16</span><span class="p">:</span><span class="n">middle</span><span class="o">+</span><span class="mi">17</span><span class="p">);</span>
<span class="mf">16.</span><span class="w"> </span><span class="n">h64</span><span class="p">=</span><span class="n">h</span><span class="p">(</span><span class="n">middle</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="mi">32</span><span class="p">:</span><span class="n">middle</span><span class="o">+</span><span class="mi">33</span><span class="p">);</span>
<span class="mf">17.</span><span class="w"> </span><span class="n">h128</span><span class="p">=</span><span class="n">h</span><span class="p">(</span><span class="n">middle</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="mi">64</span><span class="p">:</span><span class="n">middle</span><span class="o">+</span><span class="mi">65</span><span class="p">);</span>
<span class="mf">18.</span><span class="w"> </span><span class="c">% figure; stem([0:length(h64)-1],h64); grid;</span>
<span class="mf">19.</span><span class="w"> </span><span class="c">% figure; freqz(h64,1); % σχεδιάζουμε την απόκριση συχνότητας της h64</span>
<span class="mf">20.</span><span class="w"> </span><span class="n">wvtool</span><span class="p">(</span><span class="n">h32</span><span class="p">,</span><span class="n">h64</span><span class="p">,</span><span class="n">h128</span><span class="p">);</span><span class="w"> </span><span class="c">% αποκρίσεις συχνότητας των περικομμένων h</span>
<span class="mf">21.</span><span class="w"> </span><span class="c">% Οι πλευρικοί λοβοί είναι υψηλοί!</span>
<span class="mf">22.</span><span class="w"> </span><span class="c">% Πολλαπλασιάζουμε την περικομμένη κρουστική απόκριση με κατάλληλο</span>
<span class="mf">23.</span><span class="w"> </span><span class="c">% παράθυρο. Χρησιμοποιούμε την h64 και παράθυρα hamming και kaiser</span>
<span class="mf">24.</span><span class="w"> </span><span class="n">wh</span><span class="p">=</span><span class="n">hamming</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">h64</span><span class="p">));</span>
<span class="mf">25.</span><span class="w"> </span><span class="n">wk</span><span class="p">=</span><span class="n">kaiser</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">h64</span><span class="p">),</span><span class="mi">5</span><span class="p">);</span>
<span class="mf">26.</span><span class="w"> </span><span class="nb">figure</span><span class="p">;</span><span class="w"> </span><span class="nb">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">64</span><span class="p">,</span><span class="n">wk</span><span class="p">,</span><span class="s">&#39;r&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">64</span><span class="p">,</span><span class="n">wh</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">);</span><span class="w"> </span><span class="nb">grid</span><span class="p">;</span>
<span class="mf">27.</span><span class="w"> </span><span class="n">h_hamming</span><span class="p">=</span><span class="n">h64</span><span class="o">.*</span><span class="n">wh</span><span class="o">&#39;</span><span class="p">;</span>
<span class="mf">28.</span><span class="w"> </span><span class="c">% figure; stem([0:length(h64)-1],h_hamming); grid;</span>
<span class="mf">29.</span><span class="w"> </span><span class="c">% figure; freqz(h_hamming,1);</span>
<span class="mf">30.</span><span class="w"> </span><span class="n">h_kaiser</span><span class="p">=</span><span class="n">h64</span><span class="o">.*</span><span class="n">wk</span><span class="o">&#39;</span><span class="p">;</span>
<span class="mf">31.</span><span class="w"> </span><span class="n">wvtool</span><span class="p">(</span><span class="n">h64</span><span class="p">,</span><span class="n">h_hamming</span><span class="p">,</span><span class="n">h_kaiser</span><span class="p">);</span>
<span class="mf">32.</span><span class="w"> </span><span class="c">% Φιλτράρουμε το σήμα μας με καθένα από τα τρία φίλτρα</span>
<span class="mf">33.</span><span class="w"> </span><span class="n">y_rect</span><span class="p">=</span><span class="nb">conv</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">h64</span><span class="p">);</span>
<span class="mf">34.</span><span class="w"> </span><span class="nb">figure</span><span class="p">;</span><span class="w"> </span><span class="n">pwelch</span><span class="p">(</span><span class="n">y_rect</span><span class="p">,[],[],[],</span><span class="n">Fs</span><span class="p">);</span>
<span class="mf">35.</span><span class="w"> </span><span class="n">y_hamm</span><span class="p">=</span><span class="nb">conv</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">h_hamming</span><span class="p">);</span>
<span class="mf">36.</span><span class="w"> </span><span class="nb">figure</span><span class="p">;</span><span class="w"> </span><span class="n">pwelch</span><span class="p">(</span><span class="n">y_hamm</span><span class="p">,[],[],[],</span><span class="n">Fs</span><span class="p">);</span>
<span class="mf">37.</span><span class="w"> </span><span class="n">y_kais</span><span class="p">=</span><span class="nb">conv</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">h_kaiser</span><span class="p">);</span>
<span class="mf">38.</span><span class="w"> </span><span class="nb">figure</span><span class="p">;</span><span class="w"> </span><span class="n">pwelch</span><span class="p">(</span><span class="n">y_kais</span><span class="p">,[],[],[],</span><span class="n">Fs</span><span class="p">);</span>
<span class="mf">39.</span><span class="w"> </span><span class="c">%</span>
<span class="mf">40.</span><span class="w"> </span><span class="c">% Βαθυπερατό Parks-MacClellan</span>
<span class="mf">41.</span><span class="w"> </span><span class="n">hpm</span><span class="p">=</span><span class="n">firpm</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="w"> </span><span class="mf">0.10</span><span class="w"> </span><span class="mf">0.15</span><span class="w"> </span><span class="mf">0.5</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="p">]);</span>
<span class="mf">42.</span><span class="w"> </span><span class="c">% figure; freqz(hpm,1);</span>
<span class="mf">43.</span><span class="w"> </span><span class="n">s_pm</span><span class="p">=</span><span class="nb">conv</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">hpm</span><span class="p">);</span>
<span class="mf">44.</span><span class="w"> </span><span class="nb">figure</span><span class="p">;</span><span class="w"> </span><span class="n">pwelch</span><span class="p">(</span><span class="n">s_pm</span><span class="p">,[],[],[],</span><span class="n">Fs</span><span class="p">);</span>
<span class="mf">45.</span><span class="w"> </span><span class="nb">sound</span><span class="p">(</span><span class="mi">20</span><span class="o">*</span><span class="n">s</span><span class="p">);</span><span class="w"> </span><span class="c">% ακούμε το αρχικό σήμα, s</span>
<span class="mf">46.</span><span class="w"> </span><span class="nb">sound</span><span class="p">(</span><span class="mi">20</span><span class="o">*</span><span class="n">s_lp</span><span class="p">);</span><span class="w"> </span><span class="c">% ακούμε το φιλτραρισμένο σήμα, s_lp</span>
</pre></div>
</div>
</div>
</div>
</div>
</details><div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/87cdea061f5a7350ffd3a7a1466cc669a3118701e26fe6259183477ffa624caf.png" src="../_images/87cdea061f5a7350ffd3a7a1466cc669a3118701e26fe6259183477ffa624caf.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 1400x400 with 0 Axes&gt;
</pre></div>
</div>
<img alt="../_images/851a1c62e8541c614c8a3bda7b70809dc73f9220064331aaa66dcbe34fd7e07c.png" src="../_images/851a1c62e8541c614c8a3bda7b70809dc73f9220064331aaa66dcbe34fd7e07c.png" />
<img alt="../_images/347c718cc0c62bd151c8544f37cae779143985e84a451d2d493b1d09df58591a.png" src="../_images/347c718cc0c62bd151c8544f37cae779143985e84a451d2d493b1d09df58591a.png" />
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">AttributeError</span><span class="g g-Whitespace">                            </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">line</span> <span class="mi">129</span>
<span class="g g-Whitespace">    </span><span class="mi">126</span> <span class="n">gain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">128</span> <span class="c1"># Call firwin2 with corrected parameters and using the `fs` parameter</span>
<span class="ne">--&gt; </span><span class="mi">129</span> <span class="n">hpm</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">firwin2</span><span class="p">(</span><span class="mi">65</span><span class="p">,</span> <span class="n">freq</span><span class="p">,</span> <span class="n">gain</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">Fs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">130</span> <span class="n">s_pm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">hpm</span><span class="p">,</span> <span class="s1">&#39;same&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">132</span> <span class="c1"># Plotting or analyzing the filtered signals (y_rect, y_hamm, y_kais, s_pm) can be done similarly</span>
<span class="g g-Whitespace">    </span><span class="mi">133</span> <span class="c1"># For example, to plot the PSD:</span>

<span class="ne">AttributeError</span>: &#39;numpy.ndarray&#39; object has no attribute &#39;firwin2&#39;
</pre></div>
</div>
<img alt="../_images/37e4539d44a8f0b682844b8dc2f91bb827ad1f75a2442d7c3b5bea80436c2ef7.png" src="../_images/37e4539d44a8f0b682844b8dc2f91bb827ad1f75a2442d7c3b5bea80436c2ef7.png" />
</div>
</div>
</section>
<section id="experiment">
<h3>Experiment<a class="headerlink" href="#experiment" title="Permalink to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Modify the code on line 14 to achieve the same result using either the ifftshift or fftshift functions.</p></li>
<li><p>Modify the code to use a low-pass filter of length 140+1 instead of 64+1. Plot the frequency response of the filter with window design, as in the example, for two cases: rectangular and Hamming.</p></li>
</ol>
<section id="rectangular-window-simple-truncation-of-h">
<h4>Rectangular Window (simple truncation of h)<a class="headerlink" href="#rectangular-window-simple-truncation-of-h" title="Permalink to this heading">#</a></h4>
<div class="cell tag_thebe-init tag_hide-code-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">clear_output</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Assuming H is defined and calculated as before</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Fs</span><span class="o">/</span><span class="mi">8</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Fs</span><span class="o">-</span><span class="n">Fs</span><span class="o">/</span><span class="mi">4</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Fs</span><span class="o">/</span><span class="mi">8</span><span class="p">))))</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">H</span><span class="p">))</span>
<span class="n">middle</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">h</span><span class="p">[</span><span class="n">middle</span><span class="p">:],</span> <span class="n">h</span><span class="p">[:</span><span class="n">middle</span><span class="p">]))</span>
<span class="n">h32</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">middle</span><span class="o">-</span><span class="mi">16</span><span class="p">:</span><span class="n">middle</span><span class="o">+</span><span class="mi">16</span><span class="p">]</span>
<span class="n">h64</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">middle</span><span class="o">-</span><span class="mi">32</span><span class="p">:</span><span class="n">middle</span><span class="o">+</span><span class="mi">32</span><span class="p">]</span>
<span class="n">h128</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">middle</span><span class="o">-</span><span class="mi">64</span><span class="p">:</span><span class="n">middle</span><span class="o">+</span><span class="mi">64</span><span class="p">]</span>
<span class="n">h160</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">middle</span><span class="o">-</span><span class="mi">80</span><span class="p">:</span><span class="n">middle</span><span class="o">+</span><span class="mi">80</span><span class="p">]</span>
<span class="n">h256</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">middle</span><span class="o">-</span><span class="mi">128</span><span class="p">:</span><span class="n">middle</span><span class="o">+</span><span class="mi">128</span><span class="p">]</span>

<span class="n">h_variants</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;h32&#39;</span><span class="p">:</span> <span class="n">h</span><span class="p">[</span><span class="n">middle</span><span class="o">-</span><span class="mi">16</span><span class="p">:</span><span class="n">middle</span><span class="o">+</span><span class="mi">16</span><span class="p">],</span>
    <span class="s1">&#39;h64&#39;</span><span class="p">:</span> <span class="n">h</span><span class="p">[</span><span class="n">middle</span><span class="o">-</span><span class="mi">32</span><span class="p">:</span><span class="n">middle</span><span class="o">+</span><span class="mi">32</span><span class="p">],</span>
    <span class="s1">&#39;h128&#39;</span><span class="p">:</span> <span class="n">h</span><span class="p">[</span><span class="n">middle</span><span class="o">-</span><span class="mi">64</span><span class="p">:</span><span class="n">middle</span><span class="o">+</span><span class="mi">64</span><span class="p">],</span>
    <span class="s1">&#39;h160&#39;</span><span class="p">:</span> <span class="n">h</span><span class="p">[</span><span class="n">middle</span><span class="o">-</span><span class="mi">80</span><span class="p">:</span><span class="n">middle</span><span class="o">+</span><span class="mi">80</span><span class="p">],</span>
    <span class="s1">&#39;h256&#39;</span><span class="p">:</span> <span class="n">h</span><span class="p">[</span><span class="n">middle</span><span class="o">-</span><span class="mi">128</span><span class="p">:</span><span class="n">middle</span><span class="o">+</span><span class="mi">128</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">output2</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">()</span>
<span class="n">output2</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="s1">&#39;0 auto&#39;</span><span class="p">)</span>

<span class="c1"># Function to plot</span>
<span class="k">def</span> <span class="nf">plot_stem</span><span class="p">(</span><span class="n">h_key</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">output2</span><span class="p">:</span>
        <span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Clear the previous plots</span>
        <span class="n">h_data</span> <span class="o">=</span> <span class="n">h_variants</span><span class="p">[</span><span class="n">h_key</span><span class="p">]</span>
        <span class="n">x_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h_data</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>  <span class="c1"># Close all existing figures</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">markerline</span><span class="p">,</span> <span class="n">stemlines</span><span class="p">,</span> <span class="n">baseline</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">h_data</span><span class="p">,</span> <span class="s1">&#39;-.&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">baseline</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Stem plot of selected filter&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># HTML Label</span>
<span class="n">html_label</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span>
    <span class="n">value</span><span class="o">=</span><span class="s2">&quot;&lt;h2 style=&#39;font-weight: bold; font-size: 30px; text-align: center;&#39;&gt;Filter Visualization&lt;/h2&gt;&quot;</span>
<span class="p">)</span>

<span class="c1"># Setup the widgets</span>
<span class="n">dropdown</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">h_variants</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;h32&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Filter:&#39;</span><span class="p">)</span>

<span class="c1"># Function that updates the plot based on dropdown</span>
<span class="k">def</span> <span class="nf">update_plot</span><span class="p">(</span><span class="n">change</span><span class="p">):</span>
    <span class="n">plot_stem</span><span class="p">(</span><span class="n">change</span><span class="p">[</span><span class="s1">&#39;new&#39;</span><span class="p">])</span>

<span class="c1"># Observe dropdown for changes</span>
<span class="n">dropdown</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">update_plot</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>

<span class="c1"># VBox layout to align items</span>
<span class="n">vbox_layout</span> <span class="o">=</span> <span class="n">Layout</span><span class="p">(</span><span class="n">display</span><span class="o">=</span><span class="s1">&#39;flex&#39;</span><span class="p">,</span> <span class="n">flex_flow</span><span class="o">=</span><span class="s1">&#39;column&#39;</span><span class="p">,</span> <span class="n">align_items</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">justify_content</span><span class="o">=</span><span class="s1">&#39;space-between&#39;</span><span class="p">)</span>
<span class="n">ui</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">html_label</span><span class="p">,</span> <span class="n">dropdown</span><span class="p">],</span> <span class="n">layout</span><span class="o">=</span><span class="n">vbox_layout</span><span class="p">)</span>

<span class="c1"># Group the dropdown, output widget, and HTML label in a vertical box layout</span>
<span class="n">vbox_final</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">ui</span><span class="p">,</span> <span class="n">output2</span><span class="p">])</span>

<span class="c1"># Display the final VBox</span>
<span class="n">display</span><span class="p">(</span><span class="n">vbox_final</span><span class="p">)</span>

<span class="c1"># Initial call to display the plot</span>
<span class="n">plot_stem</span><span class="p">(</span><span class="n">dropdown</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>  <span class="c1"># Use the dropdown&#39;s value</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "bf0da049875e4382841e02de8ac76231", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="cell tag_thebe-init tag_hide-code-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>

<span class="c1"># Compute frequency responses</span>
<span class="n">freq32</span><span class="p">,</span> <span class="n">resp32</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">h32</span><span class="p">)</span>
<span class="n">freq64</span><span class="p">,</span> <span class="n">resp64</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">h64</span><span class="p">)</span>
<span class="n">freq128</span><span class="p">,</span> <span class="n">resp128</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">h128</span><span class="p">)</span>
<span class="n">freq160</span><span class="p">,</span> <span class="n">resp160</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">h160</span><span class="p">)</span>
<span class="n">freq256</span><span class="p">,</span> <span class="n">resp256</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">h256</span><span class="p">)</span>

<span class="c1"># Function to apply window and compute frequency responses</span>
<span class="k">def</span> <span class="nf">compute_filtered_freq_responses</span><span class="p">(</span><span class="n">window_type</span><span class="o">=</span><span class="s1">&#39;Rectangular&#39;</span><span class="p">):</span>
    <span class="n">freqs</span><span class="p">,</span> <span class="n">resps</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">filt_size</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">256</span><span class="p">]:</span>
        <span class="n">filt_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;h</span><span class="si">{</span><span class="n">filt_size</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="n">filt</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">filt_name</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">window_type</span> <span class="o">==</span> <span class="s1">&#39;Hamming&#39;</span><span class="p">:</span>
            <span class="n">filt</span> <span class="o">=</span> <span class="n">filt</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">hamming</span><span class="p">(</span><span class="n">filt_size</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">window_type</span> <span class="o">==</span> <span class="s1">&#39;Kaiser&#39;</span><span class="p">:</span>
            <span class="n">beta</span> <span class="o">=</span> <span class="mi">14</span>  <span class="c1"># Example beta value for Kaiser window, adjust as needed</span>
            <span class="n">filt</span> <span class="o">=</span> <span class="n">filt</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">kaiser</span><span class="p">(</span><span class="n">filt_size</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>
            
        <span class="n">freqs</span><span class="p">[</span><span class="n">filt_name</span><span class="p">],</span> <span class="n">resps</span><span class="p">[</span><span class="n">filt_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">filt</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">freqs</span><span class="p">,</span> <span class="n">resps</span>

<span class="c1"># Initial computation with Rectangular (no window)</span>
<span class="n">freqs</span><span class="p">,</span> <span class="n">resps</span> <span class="o">=</span> <span class="n">compute_filtered_freq_responses</span><span class="p">()</span>

<span class="n">output3</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">()</span>
<span class="n">output3</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="s1">&#39;0 auto&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">update_plot1</span><span class="p">(</span><span class="n">change</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">window_type</span> <span class="o">=</span> <span class="n">window_type_dropdown</span><span class="o">.</span><span class="n">value</span>
    <span class="n">freqs</span><span class="p">,</span> <span class="n">resps</span> <span class="o">=</span> <span class="n">compute_filtered_freq_responses</span><span class="p">(</span><span class="n">window_type</span><span class="p">)</span>
    
    <span class="k">with</span> <span class="n">output3</span><span class="p">:</span>
        <span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">filt</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;h32&#39;</span><span class="p">,</span> <span class="s1">&#39;h64&#39;</span><span class="p">,</span> <span class="s1">&#39;h128&#39;</span><span class="p">,</span> <span class="s1">&#39;h160&#39;</span><span class="p">,</span> <span class="s1">&#39;h256&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">checkboxes1</span><span class="p">[</span><span class="n">filt</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">freqs</span><span class="p">[</span><span class="n">filt</span><span class="p">],</span> <span class="n">resps</span><span class="p">[</span><span class="n">filt</span><span class="p">]</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">Fs</span> <span class="o">*</span> <span class="n">w</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="n">filt</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Frequency Response with </span><span class="si">{</span><span class="n">window_type</span><span class="si">}</span><span class="s1"> Window&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Create checkboxes for each filter</span>
<span class="n">checkboxes1</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s1">&#39;h</span><span class="si">{</span><span class="n">size</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Checkbox</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;h</span><span class="si">{</span><span class="n">size</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">size</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">256</span><span class="p">]}</span>
<span class="k">for</span> <span class="n">cb</span> <span class="ow">in</span> <span class="n">checkboxes1</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
    <span class="n">cb</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">update_plot1</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>

<span class="c1"># Dropdown for selecting the window type</span>
<span class="n">window_type_dropdown</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
    <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Rectangular&#39;</span><span class="p">,</span> <span class="s1">&#39;Hamming&#39;</span><span class="p">],</span>
    <span class="n">value</span><span class="o">=</span><span class="s1">&#39;Rectangular&#39;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Window Type:&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">window_type_dropdown</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">update_plot1</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>

<span class="c1"># HTML Label</span>
<span class="n">html_label</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span>
    <span class="n">value</span><span class="o">=</span><span class="s2">&quot;&lt;h2 style=&#39;font-weight: bold; font-size: 30px; text-align: center;&#39;&gt;Filter Frequency Response Visualization&lt;/h2&gt;&quot;</span>
<span class="p">)</span>

<span class="c1"># VBox layout to align items</span>
<span class="n">vbox_layout</span> <span class="o">=</span> <span class="n">Layout</span><span class="p">(</span><span class="n">display</span><span class="o">=</span><span class="s1">&#39;flex&#39;</span><span class="p">,</span> <span class="n">flex_flow</span><span class="o">=</span><span class="s1">&#39;column&#39;</span><span class="p">,</span> <span class="n">align_items</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">justify_content</span><span class="o">=</span><span class="s1">&#39;space-between&#39;</span><span class="p">)</span>
<span class="n">vbox_checkboxes</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">checkboxes1</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">+</span> <span class="p">[</span><span class="n">window_type_dropdown</span><span class="p">],</span> <span class="n">layout</span><span class="o">=</span><span class="n">vbox_layout</span><span class="p">)</span>

<span class="c1"># Combine everything into a final VBox with the layout</span>
<span class="n">vbox_final</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">html_label</span><span class="p">,</span> <span class="n">vbox_checkboxes</span><span class="p">,</span> <span class="n">output3</span><span class="p">],</span> <span class="n">layout</span><span class="o">=</span><span class="n">vbox_layout</span><span class="p">)</span>

<span class="c1"># Display the final layout</span>
<span class="n">display</span><span class="p">(</span><span class="n">vbox_final</span><span class="p">)</span>

<span class="c1"># Initial plot update to show default visualization</span>
<span class="n">update_plot1</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "322a643efba747c7ab6404ac623c4239", "version_major": 2, "version_minor": 0}</script></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Design a Parks-McClellan filter of length 160+1, with the same edge frequencies as in the example (0.1, 0.15). Plot the frequency response of this filter and comment on the differences from the same filter of length 64+1 (from Example 1.2). Write your answer in the text file lab2_nnnnn.txt.</p></li>
</ol>
<div class="cell tag_thebe-init tag_hide-code-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">clear_output</span>

<span class="n">filters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Equiripple Filter 32+1&#39;</span><span class="p">:</span> <span class="n">signal</span><span class="o">.</span><span class="n">remez</span><span class="p">(</span><span class="mi">33</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="mf">0.15</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">Fs</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Hz</span><span class="o">=</span><span class="n">Fs</span><span class="p">),</span>
    <span class="s1">&#39;Equiripple Filter 64+1&#39;</span><span class="p">:</span> <span class="n">signal</span><span class="o">.</span><span class="n">remez</span><span class="p">(</span><span class="mi">65</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="mf">0.15</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">Fs</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Hz</span><span class="o">=</span><span class="n">Fs</span><span class="p">),</span>
    <span class="s1">&#39;Equiripple Filter 128+1&#39;</span><span class="p">:</span> <span class="n">signal</span><span class="o">.</span><span class="n">remez</span><span class="p">(</span><span class="mi">129</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="mf">0.15</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">Fs</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Hz</span><span class="o">=</span><span class="n">Fs</span><span class="p">),</span>
    <span class="s1">&#39;Equiripple Filter 160+1&#39;</span><span class="p">:</span> <span class="n">signal</span><span class="o">.</span><span class="n">remez</span><span class="p">(</span><span class="mi">161</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="mf">0.15</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">Fs</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Hz</span><span class="o">=</span><span class="n">Fs</span><span class="p">),</span>
    <span class="s1">&#39;Equiripple Filter 256+1&#39;</span><span class="p">:</span> <span class="n">signal</span><span class="o">.</span><span class="n">remez</span><span class="p">(</span><span class="mi">257</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="mf">0.15</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">Fs</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Hz</span><span class="o">=</span><span class="n">Fs</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">output_plot2</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">()</span>
<span class="n">output_plot2</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="s1">&#39;0 auto&#39;</span><span class="p">)</span>

<span class="c1"># Function to update the plot based on selected filters</span>
<span class="k">def</span> <span class="nf">update_plot2</span><span class="p">(</span><span class="n">change</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">selected_filters</span> <span class="o">=</span> <span class="p">[</span><span class="n">cb</span><span class="o">.</span><span class="n">description</span> <span class="k">for</span> <span class="n">cb</span> <span class="ow">in</span> <span class="n">checkboxes2</span> <span class="k">if</span> <span class="n">cb</span><span class="o">.</span><span class="n">value</span><span class="p">]</span>
    <span class="k">with</span> <span class="n">output_plot2</span><span class="p">:</span>
        <span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">filter_name</span> <span class="ow">in</span> <span class="n">selected_filters</span><span class="p">:</span>
            <span class="n">filter_coeffs</span> <span class="o">=</span> <span class="n">filters</span><span class="p">[</span><span class="n">filter_name</span><span class="p">]</span>
            <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">filter_coeffs</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">8000</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">w</span> <span class="o">*</span> <span class="n">Fs</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">filter_name</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Frequency Response&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Gain&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">checkboxes2</span> <span class="o">=</span> <span class="p">[</span><span class="n">widgets</span><span class="o">.</span><span class="n">Checkbox</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">filters</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
<span class="k">for</span> <span class="n">cb</span> <span class="ow">in</span> <span class="n">checkboxes2</span><span class="p">:</span>
    <span class="n">cb</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">update_plot2</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>

<span class="c1"># HTML Label</span>
<span class="n">html_label</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span>
    <span class="n">value</span><span class="o">=</span><span class="s2">&quot;&lt;h2 style=&#39;font-weight: bold; font-size: 30px; text-align: center;&#39;&gt;Equiripple Filter Frequency Response&lt;/h2&gt;&quot;</span>
<span class="p">)</span>

<span class="c1"># VBox layout to align items</span>
<span class="n">vbox_layout</span> <span class="o">=</span> <span class="n">Layout</span><span class="p">(</span><span class="n">display</span><span class="o">=</span><span class="s1">&#39;flex&#39;</span><span class="p">,</span> <span class="n">flex_flow</span><span class="o">=</span><span class="s1">&#39;column&#39;</span><span class="p">,</span> <span class="n">align_items</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">justify_content</span><span class="o">=</span><span class="s1">&#39;space-between&#39;</span><span class="p">)</span>
<span class="n">vbox_checkboxes</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">widgets</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="s1">&#39;Select Equiripple Filter Length:&#39;</span><span class="p">)]</span> <span class="o">+</span> <span class="n">checkboxes2</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">vbox_layout</span><span class="p">)</span>

<span class="c1"># Combine everything into a final VBox with the layout</span>
<span class="n">vbox_final</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">html_label</span><span class="p">,</span> <span class="n">vbox_checkboxes</span><span class="p">,</span> <span class="n">output_plot2</span><span class="p">],</span> <span class="n">layout</span><span class="o">=</span><span class="n">vbox_layout</span><span class="p">)</span>

<span class="c1"># Display the final layout</span>
<span class="n">display</span><span class="p">(</span><span class="n">vbox_final</span><span class="p">)</span>


<span class="c1"># Initial plot update to show default visualization</span>
<span class="n">update_plot2</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "0c0927868f324e26833ee9739f1c6f7a", "version_major": 2, "version_minor": 0}</script></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Change the edge frequencies of the filter from question 3 to (0.11, 0.12) and compare the frequency responses of the two filters. Save the diagrams and write your comments in the text file lab2_nnnnn.txt.</p></li>
</ol>
<div class="cell tag_hide-code-cell tag_thebe-init docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">clear_output</span>

<span class="n">filters3</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Equiripple Filter 32+1&#39;</span><span class="p">:</span> <span class="n">signal</span><span class="o">.</span><span class="n">remez</span><span class="p">(</span><span class="mi">33</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.11</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="mf">0.12</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">Fs</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Hz</span><span class="o">=</span><span class="n">Fs</span><span class="p">),</span>
    <span class="s1">&#39;Equiripple Filter 64+1&#39;</span><span class="p">:</span> <span class="n">signal</span><span class="o">.</span><span class="n">remez</span><span class="p">(</span><span class="mi">65</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.11</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="mf">0.12</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">Fs</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Hz</span><span class="o">=</span><span class="n">Fs</span><span class="p">),</span>
    <span class="s1">&#39;Equiripple Filter 128+1&#39;</span><span class="p">:</span> <span class="n">signal</span><span class="o">.</span><span class="n">remez</span><span class="p">(</span><span class="mi">129</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.11</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="mf">0.12</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">Fs</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Hz</span><span class="o">=</span><span class="n">Fs</span><span class="p">),</span>
    <span class="s1">&#39;Equiripple Filter 160+1&#39;</span><span class="p">:</span> <span class="n">signal</span><span class="o">.</span><span class="n">remez</span><span class="p">(</span><span class="mi">161</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.11</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="mf">0.12</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">Fs</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Hz</span><span class="o">=</span><span class="n">Fs</span><span class="p">),</span>
    <span class="s1">&#39;Equiripple Filter 256+1&#39;</span><span class="p">:</span> <span class="n">signal</span><span class="o">.</span><span class="n">remez</span><span class="p">(</span><span class="mi">257</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.11</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="mf">0.12</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">Fs</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Hz</span><span class="o">=</span><span class="n">Fs</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">output_plot3</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">()</span>

<span class="c1"># Function to update the plot based on selected filters</span>
<span class="k">def</span> <span class="nf">update_plot3</span><span class="p">(</span><span class="n">change</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">selected_filters</span> <span class="o">=</span> <span class="p">[</span><span class="n">cb</span><span class="o">.</span><span class="n">description</span> <span class="k">for</span> <span class="n">cb</span> <span class="ow">in</span> <span class="n">checkboxes3</span> <span class="k">if</span> <span class="n">cb</span><span class="o">.</span><span class="n">value</span><span class="p">]</span>
    <span class="k">with</span> <span class="n">output_plot3</span><span class="p">:</span>
        <span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">filter_name</span> <span class="ow">in</span> <span class="n">selected_filters</span><span class="p">:</span>
            <span class="n">filter_coeffs</span> <span class="o">=</span> <span class="n">filters3</span><span class="p">[</span><span class="n">filter_name</span><span class="p">]</span>
            <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">filter_coeffs</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">8000</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">w</span> <span class="o">*</span> <span class="n">Fs</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">filter_name</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Frequency Response&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Gain&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">checkboxes3</span> <span class="o">=</span> <span class="p">[</span><span class="n">widgets</span><span class="o">.</span><span class="n">Checkbox</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">filters</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
<span class="k">for</span> <span class="n">cb</span> <span class="ow">in</span> <span class="n">checkboxes3</span><span class="p">:</span>
    <span class="n">cb</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">update_plot3</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>

<span class="c1"># HTML Label</span>
<span class="n">html_label3</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span>
    <span class="n">value</span><span class="o">=</span><span class="s2">&quot;&lt;h2 style=&#39;font-weight: bold; font-size: 30px; text-align: center;&#39;&gt;Equiripple Filter Frequency Response&lt;/h2&gt;&quot;</span>
<span class="p">)</span>

<span class="c1"># VBox layout to align items</span>
<span class="n">vbox_layout3</span> <span class="o">=</span> <span class="n">Layout</span><span class="p">(</span><span class="n">display</span><span class="o">=</span><span class="s1">&#39;flex&#39;</span><span class="p">,</span> <span class="n">flex_flow</span><span class="o">=</span><span class="s1">&#39;column&#39;</span><span class="p">,</span> <span class="n">align_items</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">justify_content</span><span class="o">=</span><span class="s1">&#39;space-between&#39;</span><span class="p">)</span>
<span class="n">vbox_checkboxes3</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">widgets</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="s1">&#39;Select Equiripple Filter Length:&#39;</span><span class="p">)]</span> <span class="o">+</span> <span class="n">checkboxes3</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">vbox_layout3</span><span class="p">)</span>

<span class="c1"># Combine everything into a final VBox with the layout</span>
<span class="n">vbox_final3</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">html_label3</span><span class="p">,</span> <span class="n">vbox_checkboxes3</span><span class="p">,</span> <span class="n">output_plot3</span><span class="p">],</span> <span class="n">layout</span><span class="o">=</span><span class="n">vbox_layout3</span><span class="p">)</span>

<span class="c1"># Display the final layout</span>
<span class="n">display</span><span class="p">(</span><span class="n">vbox_final3</span><span class="p">)</span>

<span class="c1"># Initial plot update to show default visualization</span>
<span class="n">update_plot3</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "826d4a8f4d6a47d394f32eaf2b75990a", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
<section id="filter-application">
<h4>Filter Application<a class="headerlink" href="#filter-application" title="Permalink to this heading">#</a></h4>
<div class="cell tag_thebe-init tag_hide-code-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">from</span> <span class="nn">scipy.io.wavfile</span> <span class="kn">import</span> <span class="n">write</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">Audio</span><span class="p">,</span> <span class="n">clear_output</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">import</span> <span class="nn">io</span>

<span class="n">lp_filtersl</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;lpass32&#39;</span><span class="p">:</span> <span class="n">signal</span><span class="o">.</span><span class="n">remez</span><span class="p">(</span><span class="mi">33</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="mf">0.15</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">Fs</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Hz</span><span class="o">=</span><span class="n">Fs</span><span class="p">),</span>
    <span class="s1">&#39;lpass64&#39;</span><span class="p">:</span> <span class="n">signal</span><span class="o">.</span><span class="n">remez</span><span class="p">(</span><span class="mi">65</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="mf">0.15</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">Fs</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Hz</span><span class="o">=</span><span class="n">Fs</span><span class="p">),</span>
    <span class="s1">&#39;lpass128&#39;</span><span class="p">:</span> <span class="n">signal</span><span class="o">.</span><span class="n">remez</span><span class="p">(</span><span class="mi">129</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="mf">0.15</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">Fs</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Hz</span><span class="o">=</span><span class="n">Fs</span><span class="p">),</span>
    <span class="s1">&#39;lpass160&#39;</span><span class="p">:</span> <span class="n">signal</span><span class="o">.</span><span class="n">remez</span><span class="p">(</span><span class="mi">161</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="mf">0.15</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">Fs</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Hz</span><span class="o">=</span><span class="n">Fs</span><span class="p">),</span>
    <span class="s1">&#39;lpass256&#39;</span><span class="p">:</span> <span class="n">signal</span><span class="o">.</span><span class="n">remez</span><span class="p">(</span><span class="mi">257</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="mf">0.15</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">Fs</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Hz</span><span class="o">=</span><span class="n">Fs</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># Prepare audio data</span>
<span class="n">audio_data</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">lp_filter_coeffs</span> <span class="ow">in</span> <span class="n">lp_filtersl</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="c1"># Apply the filter to the signal</span>
    <span class="n">s_lp_filtered</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">lp_filter_coeffs</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">lp_filter_coeffs</span><span class="p">)</span>
    
    <span class="c1"># Normalize the filtered signal to prevent clipping</span>
    <span class="n">s_lp_filtered_normalized</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">((</span><span class="n">s_lp_filtered</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">s_lp_filtered</span><span class="p">)))</span> <span class="o">*</span> <span class="mi">32767</span><span class="p">)</span>
    
    <span class="c1"># Write to an in-memory file</span>
    <span class="n">audio_buf</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
    <span class="n">write</span><span class="p">(</span><span class="n">audio_buf</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="n">s_lp_filtered_normalized</span><span class="p">)</span>
    <span class="n">audio_buf</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Go back to the beginning of the BytesIO object</span>
    
    <span class="c1"># Store the audio buffer</span>
    <span class="n">audio_data</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">audio_buf</span>

<span class="c1"># Function to display the frequency response of the filtered signal</span>
<span class="k">def</span> <span class="nf">plot_freq_response</span><span class="p">(</span><span class="n">filter_name</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">plot_output</span><span class="p">:</span>
        <span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Apply the filter to the original signal</span>
        <span class="n">s_lp_filtered</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">lp_filtersl</span><span class="p">[</span><span class="n">filter_name</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">lp_filtersl</span><span class="p">[</span><span class="n">filter_name</span><span class="p">])</span>
        
        <span class="c1"># Calculate FFT</span>
        <span class="n">freqs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s_lp_filtered</span><span class="p">),</span> <span class="mi">1</span><span class="o">/</span><span class="n">Fs</span><span class="p">)</span>
        <span class="n">fft_mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">s_lp_filtered</span><span class="p">))</span>
        
        <span class="c1"># Convert magnitude to dB</span>
        <span class="n">fft_mag_db</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fft_mag</span><span class="p">)</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">fft_mag_db</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Frequency Response of Filtered Signal with </span><span class="si">{</span><span class="n">filter_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Fs</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Audio playback function</span>
<span class="k">def</span> <span class="nf">show_audio_player</span><span class="p">(</span><span class="n">filter_name</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">audio_output</span><span class="p">:</span>
        <span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">display</span><span class="p">(</span><span class="n">Audio</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">audio_data</span><span class="p">[</span><span class="n">filter_name</span><span class="p">]</span><span class="o">.</span><span class="n">getvalue</span><span class="p">(),</span> <span class="n">rate</span><span class="o">=</span><span class="n">Fs</span><span class="p">))</span>

<span class="c1"># Widget setup</span>
<span class="n">filter_dropdown</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
    <span class="n">options</span><span class="o">=</span><span class="p">[(</span><span class="n">name</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">lp_filtersl</span><span class="o">.</span><span class="n">keys</span><span class="p">()],</span>
    <span class="n">value</span><span class="o">=</span><span class="s1">&#39;lpass32&#39;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Filter:&#39;</span>
<span class="p">)</span>

<span class="n">plot_output</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">()</span>
<span class="n">audio_output</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">on_filter_change</span><span class="p">(</span><span class="n">change</span><span class="p">):</span>
    <span class="n">filter_name</span> <span class="o">=</span> <span class="n">change</span><span class="p">[</span><span class="s1">&#39;new&#39;</span><span class="p">]</span>
    <span class="n">plot_freq_response</span><span class="p">(</span><span class="n">filter_name</span><span class="p">)</span>
    <span class="n">show_audio_player</span><span class="p">(</span><span class="n">filter_name</span><span class="p">)</span>

<span class="n">filter_dropdown</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">on_filter_change</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>

<span class="c1"># HTML Label for enhanced UI</span>
<span class="n">html_label</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span>
    <span class="n">value</span><span class="o">=</span><span class="s2">&quot;&lt;h2 style=&#39;font-weight: bold; font-size: 30px; text-align: center;&#39;&gt;Low Pass Filter Application and Audio Playback&lt;/h2&gt;&quot;</span>
<span class="p">)</span>

<span class="c1"># VBox layout for alignment and presentation</span>
<span class="n">vbox_layout</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">display</span><span class="o">=</span><span class="s1">&#39;flex&#39;</span><span class="p">,</span> <span class="n">flex_flow</span><span class="o">=</span><span class="s1">&#39;column&#39;</span><span class="p">,</span> <span class="n">align_items</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">justify_content</span><span class="o">=</span><span class="s1">&#39;space-between&#39;</span><span class="p">)</span>
<span class="n">vbox_final5</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">html_label</span><span class="p">,</span> <span class="n">filter_dropdown</span><span class="p">,</span> <span class="n">plot_output</span><span class="p">,</span> <span class="n">audio_output</span><span class="p">],</span> <span class="n">layout</span><span class="o">=</span><span class="n">vbox_layout</span><span class="p">)</span>

<span class="c1"># Display the final layout</span>
<span class="n">display</span><span class="p">(</span><span class="n">vbox_final5</span><span class="p">)</span>

<span class="c1"># Initialize</span>
<span class="n">on_filter_change</span><span class="p">({</span><span class="s1">&#39;new&#39;</span><span class="p">:</span> <span class="n">filter_dropdown</span><span class="o">.</span><span class="n">value</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "3949be225d424ccb8b89383afcb72cc1", "version_major": 2, "version_minor": 0}</script></div>
</div>
<ol class="arabic simple" start="5">
<li><p>Replace the signal s with the sum of four sinusoidal functions of unit amplitude, frequencies 700, 900, 1400, and 2500 Hz, and duration of 1.0 sec. Keep the same Fs = 8192 Hz. Plot the spectral density of the signal (with pwelch) and observe the result of filtering with the two Parks-McClellan filters from questions 3 and 4. Save the spectral diagrams in the text file lab2_nnnnn.txt.</p></li>
</ol>
<div class="cell tag_remove-input tag_thebe-init docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9ef6ecd9199142169a360434306d4f0f", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "205eec192365405f8c819dbb2a78bb21", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
</section>
</section>
<section id="part-4-application-a">
<h2>Part 4: Application A<a class="headerlink" href="#part-4-application-a" title="Permalink to this heading">#</a></h2>
<section id="question-1">
<h3>Question 1<a class="headerlink" href="#question-1" title="Permalink to this heading">#</a></h3>
<p>Execute Exercise 1.2 of paragraph 1.6 of the course’s issue, appropriately modifying the code from Example 1.2 (which you have saved in the file lab2_1_nnnnn.m). The purpose of the exercise is the design of a band-pass filter with a passband of (0.6 KHz, 1.1 KHz) using the two methods described above and their application to the signal s from Example 1.2 (also see Example 2 at the end of the presentation “DSP in Telecommunications”). Verify the correct design of your filter by checking both its frequency response and the result of filtering on the signal s.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Code<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--3-input--1" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">convolve</span><span class="p">,</span> <span class="n">kaiser</span><span class="p">,</span> <span class="n">welch</span><span class="p">,</span> <span class="n">freqz</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Sample values for f1 and f2, replace with your desired frequencies</span>
<span class="n">f1</span> <span class="o">=</span> <span class="mi">600</span>
<span class="n">f2</span> <span class="o">=</span> <span class="mi">1100</span>

<span class="k">def</span> <span class="nf">process_signal</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">):</span>
    <span class="c1"># Load the signal from a file</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../files/sima.txt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">f</span><span class="p">]</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">Fs</span> <span class="o">=</span> <span class="mi">8192</span>  <span class="c1"># Sampling frequency</span>

    <span class="n">f2m1</span> <span class="o">=</span> <span class="n">f2</span> <span class="o">-</span> <span class="n">f1</span>
    <span class="n">f2p1</span> <span class="o">=</span> <span class="p">(</span><span class="n">f2</span> <span class="o">+</span> <span class="n">f1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">256</span>
    <span class="n">Ts</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">Fs</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">N</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">Ts</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="c1"># Bandpass filter</span>
    <span class="n">hbp</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">Fs</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f2p1</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sinc</span><span class="p">(</span><span class="n">f2m1</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">hbpw</span> <span class="o">=</span> <span class="n">hbp</span> <span class="o">*</span> <span class="n">kaiser</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hbp</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span>

    <span class="c1"># Compute frequency responses</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">freqz</span><span class="p">(</span><span class="n">hbp</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">8000</span><span class="p">)</span>
    <span class="n">w_w</span><span class="p">,</span> <span class="n">h_w</span> <span class="o">=</span> <span class="n">freqz</span><span class="p">(</span><span class="n">hbpw</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">8000</span><span class="p">)</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="n">Fs</span>  <span class="c1"># Sampling frequency for normalization</span>

    <span class="c1"># Plotting</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hbp</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Bandpass Filter&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hbpw</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Windowed Bandpass Filter&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">fs</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Bandpass Filter&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w_w</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">fs</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">h_w</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Windowed Bandpass Filter&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Convolution with the signal</span>
    <span class="n">sima_bp</span> <span class="o">=</span> <span class="n">convolve</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">hbp</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
    <span class="n">sima_bpw</span> <span class="o">=</span> <span class="n">convolve</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">hbpw</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>

    <span class="c1"># Power Spectral Density</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span> <span class="o">=</span> <span class="n">welch</span><span class="p">(</span><span class="n">sima_bp</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">1024</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span><span class="p">)</span>
    
    <span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span> <span class="o">=</span> <span class="n">welch</span><span class="p">(</span><span class="n">sima_bpw</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">1024</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Call process_signal with your values</span>
<span class="n">process_signal</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">)</span>

</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--3-input--2" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">%% Bandpass FIR filter – closed-form and windowing</span>
<span class="nb">clear</span><span class="w"> </span><span class="nb">all</span><span class="p">;</span><span class="w"> </span><span class="n">close</span><span class="w"> </span><span class="s">all</span><span class="p">;</span>
<span class="n">load</span><span class="w"> </span><span class="s">sima</span><span class="p">;</span><span class="w"> </span><span class="c">% Fs=8192;</span>
<span class="n">f1</span><span class="p">=</span><span class="mi">800</span><span class="p">;</span><span class="w"> </span><span class="n">f2</span><span class="p">=</span><span class="mi">1600</span><span class="p">;</span>
<span class="n">Ts</span><span class="p">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Fs</span><span class="p">;</span>
<span class="n">f2m1</span><span class="p">=(</span><span class="n">f2</span><span class="o">-</span><span class="n">f1</span><span class="p">);</span><span class="w"> </span><span class="n">f2p1</span><span class="p">=(</span><span class="n">f2</span><span class="o">+</span><span class="n">f1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="n">N</span><span class="p">=</span><span class="mi">256</span><span class="p">;</span><span class="w"> </span><span class="c">%</span>
<span class="n">t</span><span class="p">=[</span><span class="o">-</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span><span class="mi">2</span><span class="p">:</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">Ts</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
<span class="n">hbp</span><span class="p">=</span><span class="mi">2</span><span class="o">/</span><span class="n">Fs</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="n">f2p1</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">.*</span><span class="nb">sin</span><span class="p">(</span><span class="nb">pi</span><span class="o">*</span><span class="n">f2m1</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="nb">pi</span><span class="o">./</span><span class="n">t</span><span class="p">;</span>
<span class="n">hbpw</span><span class="p">=</span><span class="n">hbp</span><span class="o">.*</span><span class="n">kaiser</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">hbp</span><span class="p">),</span><span class="mi">5</span><span class="p">)</span><span class="o">&#39;</span><span class="p">;</span>
<span class="n">wvtool</span><span class="p">(</span><span class="n">hbp</span><span class="p">,</span><span class="n">hbpw</span><span class="p">);</span>
<span class="n">sima_bp</span><span class="p">=</span><span class="nb">conv</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">hbp</span><span class="p">);</span>
<span class="nb">figure</span><span class="p">;</span><span class="w"> </span><span class="n">pwelch</span><span class="p">(</span><span class="n">sima_bp</span><span class="p">,[],[],[],</span><span class="n">Fs</span><span class="p">);</span>
<span class="n">sima_bpw</span><span class="p">=</span><span class="nb">conv</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">hbpw</span><span class="p">);</span>
<span class="nb">figure</span><span class="p">;</span><span class="w"> </span><span class="n">pwelch</span><span class="p">(</span><span class="n">sima_bpw</span><span class="p">,[],[],[],</span><span class="n">Fs</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>
</details><div class="cell tag_thebe-init tag_hide-code-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">convolve</span><span class="p">,</span> <span class="n">kaiser</span><span class="p">,</span> <span class="n">welch</span><span class="p">,</span> <span class="n">remez</span>
<span class="kn">from</span> <span class="nn">scipy.io</span> <span class="kn">import</span> <span class="n">loadmat</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">freqz</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">f1_input1</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntText</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;f1 (Hz):&#39;</span><span class="p">,</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">f2_input1</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntText</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">1100</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;f2 (Hz):&#39;</span><span class="p">,</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Define a button</span>
<span class="n">button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Process Signal&quot;</span><span class="p">)</span>

<span class="c1"># Define an output area for the plots</span>
<span class="n">plot_output</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">process_signal</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">plot_output</span><span class="p">:</span>
        <span class="c1"># Clear the previous figures</span>
        <span class="n">plot_output</span><span class="o">.</span><span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>  <span class="c1"># Close all existing figures to prevent memory leaks</span>
    

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../files/sima.txt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">f</span><span class="p">]</span>
        <span class="n">s</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="n">Fs</span><span class="o">=</span><span class="mi">8192</span>

        <span class="n">f2m1</span> <span class="o">=</span> <span class="n">f2</span> <span class="o">-</span> <span class="n">f1</span>
        <span class="n">f2p1</span> <span class="o">=</span> <span class="p">(</span><span class="n">f2</span> <span class="o">+</span> <span class="n">f1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">N</span> <span class="o">=</span> <span class="mi">256</span>
        <span class="n">Ts</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">Fs</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">N</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">Ts</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="c1"># Bandpass filter</span>
        <span class="n">hbp</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">Fs</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f2p1</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sinc</span><span class="p">(</span><span class="n">f2m1</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
        <span class="n">hbpw</span> <span class="o">=</span> <span class="n">hbp</span> <span class="o">*</span> <span class="n">kaiser</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hbp</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span>


        <span class="c1"># Compute frequency responses</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">freqz</span><span class="p">(</span><span class="n">hbp</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">8000</span><span class="p">)</span>
        <span class="n">w_w</span><span class="p">,</span> <span class="n">h_w</span> <span class="o">=</span> <span class="n">freqz</span><span class="p">(</span><span class="n">hbpw</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">8000</span><span class="p">)</span>
        <span class="n">fs</span> <span class="o">=</span> <span class="n">Fs</span>  <span class="c1"># Sampling frequency for normalization</span>

        <span class="c1"># Creating a figure and a 1x2 subplot layout</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

        <span class="c1"># Plotting the impulse responses on the first subplot</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hbp</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Bandpass Filter&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hbpw</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Windowed Bandpass Filter&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Impulse Responses&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Sample&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Plotting the frequency responses on the second subplot</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">fs</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Bandpass Filter&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w_w</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">fs</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">h_w</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Windowed Bandpass Filter&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Frequency Responses&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency [Hz]&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude [dB]&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Adjust the layout so that the plots do not overlap</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="c1"># Convolution with the signal</span>
        <span class="n">sima_bp</span> <span class="o">=</span> <span class="n">convolve</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">hbp</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
        <span class="n">sima_bpw</span> <span class="o">=</span> <span class="n">convolve</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">hbpw</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

        <span class="c1"># Plotting the Power Spectral Density</span>
        
        <span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span> <span class="o">=</span> <span class="n">welch</span><span class="p">(</span><span class="n">sima_bp</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">1024</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Power Spectral Density of Bandpass Filtered Signal&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency [Hz]&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PSD [V**2/Hz]&#39;</span><span class="p">)</span>

        <span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span> <span class="o">=</span> <span class="n">welch</span><span class="p">(</span><span class="n">sima_bpw</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">1024</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Pxx</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Power Spectral Density of Windowed Bandpass Filtered Signal&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency [Hz]&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PSD [V**2/Hz]&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">on_button_clicked</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
    <span class="c1"># Call your signal processing function with the current values of f1 and f2</span>
    <span class="n">process_signal</span><span class="p">(</span><span class="n">f1_input1</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">f2_input1</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="n">button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="n">on_button_clicked</span><span class="p">)</span>

<span class="c1"># Display widgets</span>
<span class="n">ui_layout</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">f1_input1</span><span class="p">,</span> <span class="n">f2_input1</span><span class="p">,</span> <span class="n">button</span><span class="p">,</span> <span class="n">plot_output</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">ui_layout</span><span class="p">)</span>

<span class="c1"># Call process_signal initially with the default or initial values</span>
<span class="n">process_signal</span><span class="p">(</span><span class="n">f1_input1</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">f2_input1</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "6d73c88157914edf9c1a8818260ef006", "version_major": 2, "version_minor": 0}</script></div>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Code<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--4-input--1" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">freqz</span><span class="p">,</span> <span class="n">convolve</span><span class="p">,</span> <span class="n">welch</span><span class="p">,</span> <span class="n">firwin2</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="k">def</span> <span class="nf">process_signal_without_widgets</span><span class="p">(</span><span class="n">f1</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">f2</span><span class="o">=</span><span class="mi">1100</span><span class="p">):</span>
    <span class="c1"># Design the bandpass FIR filter with the given f1 and f2 values</span>
    <span class="n">freq11</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">*</span> <span class="mf">0.95</span><span class="p">,</span> <span class="n">f1</span> <span class="o">*</span> <span class="mf">1.05</span><span class="p">,</span> <span class="n">f2</span> <span class="o">*</span> <span class="mf">0.95</span><span class="p">,</span> <span class="n">f2</span> <span class="o">*</span> <span class="mf">1.05</span><span class="p">,</span> <span class="n">Fs</span> <span class="o">/</span> <span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">Fs</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">gain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">hbp_pm</span> <span class="o">=</span> <span class="n">firwin2</span><span class="p">(</span><span class="mi">129</span><span class="p">,</span> <span class="n">freq11</span><span class="p">,</span> <span class="n">gain</span><span class="p">)</span>

    <span class="c1"># Compute the frequency response of the filter</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">freqz</span><span class="p">(</span><span class="n">hbp_pm</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">8000</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">Fs</span><span class="p">)</span>

    <span class="c1"># Plotting</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

    <span class="c1"># Impulse Response</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hbp_pm</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Impulse Response&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Sample&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>

    <span class="c1"># Frequency Response</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)))</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Frequency Response of the Bandpass FIR Filter&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency [Hz]&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude [dB]&#39;</span><span class="p">)</span>

    <span class="c1"># Convolve the signal with the filter coefficients</span>
    <span class="n">s_pm</span> <span class="o">=</span> <span class="n">convolve</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">hbp_pm</span><span class="p">,</span> <span class="s1">&#39;same&#39;</span><span class="p">)</span>

    <span class="c1"># Power Spectral Density (PSD)</span>
    <span class="n">f</span><span class="p">,</span> <span class="n">Pxx_spec</span> <span class="o">=</span> <span class="n">welch</span><span class="p">(</span><span class="n">s_pm</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="s1">&#39;flattop&#39;</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="n">scaling</span><span class="o">=</span><span class="s1">&#39;spectrum&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Pxx_spec</span><span class="p">))</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency [Hz]&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Linear spectrum [V RMS]&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Power spectrum (Welch)&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Call the function with your desired f1 and f2 values</span>
<span class="n">process_signal_without_widgets</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">1100</span><span class="p">)</span>

</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--4-input--2" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">%% Bandpass FIR filter –</span>
<span class="c">%% Equiripple design (Parks Mc Clellan)</span>
<span class="nb">clear</span><span class="w"> </span><span class="nb">all</span><span class="p">;</span><span class="w"> </span><span class="n">close</span><span class="w"> </span><span class="s">all</span><span class="p">;</span>
<span class="n">load</span><span class="w"> </span><span class="s">sima</span><span class="p">;</span><span class="w"> </span><span class="c">% Fs=8192;</span>
<span class="n">f1</span><span class="p">=</span><span class="mi">800</span><span class="p">;</span><span class="w"> </span><span class="n">f2</span><span class="p">=</span><span class="mi">1600</span><span class="p">;</span>
<span class="n">f</span><span class="p">=</span><span class="mi">2</span><span class="o">*</span><span class="p">[</span><span class="mi">0</span><span class="w"> </span><span class="n">f1</span><span class="o">*</span><span class="mf">0.95</span><span class="w"> </span><span class="n">f1</span><span class="o">*</span><span class="mf">1.05</span><span class="w"> </span><span class="n">f2</span><span class="o">*</span><span class="mf">0.95</span><span class="w"> </span><span class="n">f2</span><span class="o">*</span><span class="mf">1.05</span><span class="w"> </span><span class="n">Fs</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">Fs</span><span class="p">;</span>
<span class="n">hbp_pm</span><span class="p">=</span><span class="n">firpm</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="p">]);</span>
<span class="c">% figure; freqz(hpm,1);</span>
<span class="n">wvtool</span><span class="p">(</span><span class="n">hbp_pm</span><span class="p">);</span>
<span class="n">sima_bp</span><span class="p">=</span><span class="nb">conv</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">hbp_pm</span><span class="p">);</span>
<span class="nb">figure</span><span class="p">;</span><span class="w"> </span><span class="n">pwelch</span><span class="p">(</span><span class="n">sima_bp</span><span class="p">,[],[],[],</span><span class="n">Fs</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>
</details><div class="cell tag_thebe-init tag_hide-code-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">freqz</span><span class="p">,</span> <span class="n">convolve</span><span class="p">,</span> <span class="n">welch</span><span class="p">,</span> <span class="n">firwin2</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>

<span class="c1"># Define the interactive widgets</span>
<span class="n">f1_input2</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntText</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;f1 (Hz):&#39;</span><span class="p">,</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">f2_input2</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntText</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">1100</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;f2 (Hz):&#39;</span><span class="p">,</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">process_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Process Signal&quot;</span><span class="p">)</span>
<span class="n">output_area</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">()</span>

<span class="c1"># Load your signal here (use an example or mock if necessary)</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5000</span><span class="p">)</span>  <span class="c1"># Example signal; replace with file loading outside the function</span>
<span class="n">Fs</span> <span class="o">=</span> <span class="mi">8192</span>  <span class="c1"># Sampling frequency</span>

<span class="k">def</span> <span class="nf">process_signal2</span><span class="p">(</span><span class="n">btn</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="c1"># Read the values from the input widgets</span>
    <span class="n">f1</span><span class="p">,</span> <span class="n">f2</span> <span class="o">=</span> <span class="n">f1_input2</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">f2_input2</span><span class="o">.</span><span class="n">value</span>
    
    <span class="c1"># Design the bandpass FIR filter with the new f1 and f2 values</span>
    <span class="n">freq11</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">*</span> <span class="mf">0.95</span><span class="p">,</span> <span class="n">f1</span> <span class="o">*</span> <span class="mf">1.05</span><span class="p">,</span> <span class="n">f2</span> <span class="o">*</span> <span class="mf">0.95</span><span class="p">,</span> <span class="n">f2</span> <span class="o">*</span> <span class="mf">1.05</span><span class="p">,</span> <span class="n">Fs</span> <span class="o">/</span> <span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">Fs</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">gain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">hbp_pm</span> <span class="o">=</span> <span class="n">firwin2</span><span class="p">(</span><span class="mi">129</span><span class="p">,</span> <span class="n">freq11</span><span class="p">,</span> <span class="n">gain</span><span class="p">)</span>

    <span class="c1"># Compute the frequency response of the filter</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">freqz</span><span class="p">(</span><span class="n">hbp_pm</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">8000</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">Fs</span><span class="p">)</span>

    <span class="c1"># Use the output widget to manage the plots</span>
    <span class="k">with</span> <span class="n">output_area</span><span class="p">:</span>
        <span class="n">output_area</span><span class="o">.</span><span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Clear the previous plots</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

        <span class="c1"># Plot the impulse response</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hbp_pm</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Windowed Bandpass Filter&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Impulse Response&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Sample&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Plot the frequency response</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)))</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Frequency Response of the Bandpass FIR Filter&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency [Hz]&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude [dB]&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Convolve the signal with the filter coefficients</span>
        <span class="n">s_pm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">hbp_pm</span><span class="p">,</span> <span class="s1">&#39;same&#39;</span><span class="p">)</span>

        <span class="c1"># Plot the Power Spectral Density (PSD) of the filtered signal</span>
        <span class="n">f</span><span class="p">,</span> <span class="n">Pxx_spec</span> <span class="o">=</span> <span class="n">welch</span><span class="p">(</span><span class="n">s_pm</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="s1">&#39;flattop&#39;</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="n">scaling</span><span class="o">=</span><span class="s1">&#39;spectrum&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Pxx_spec</span><span class="p">))</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;frequency [Hz]&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Linear spectrum [V RMS]&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Power spectrum (Welch)&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Set the button click action</span>
<span class="n">process_button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="n">process_signal2</span><span class="p">)</span>

<span class="c1"># Layout the widgets and output area</span>
<span class="n">widgets_layout</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">f1_input2</span><span class="p">,</span> <span class="n">f2_input2</span><span class="p">,</span> <span class="n">process_button</span><span class="p">,</span> <span class="n">output_area</span><span class="p">])</span>


<span class="c1"># Display the layout</span>
<span class="n">display</span><span class="p">(</span><span class="n">widgets_layout</span><span class="p">)</span>

<span class="n">process_signal2</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5ab9770a902746568bd70cb6374b7c50", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
<section id="question-2">
<h3>Question 2<a class="headerlink" href="#question-2" title="Permalink to this heading">#</a></h3>
<p>For the bandpass filter from question 1 above, using the Parks-McClellan method, select an appropriate filter order to achieve at least 60 dB attenuation in the stop bands. Apply this filter to the four sine wave signal from question 5 of Part B.</p>
<div class="cell tag_thebe-init tag_hide-code-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">remez</span><span class="p">,</span> <span class="n">freqz</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">Fs</span> <span class="o">=</span> <span class="mi">8192</span>  <span class="c1"># Συχνότητα δειγματοληψίας</span>
<span class="n">f1</span><span class="p">,</span> <span class="n">f2</span> <span class="o">=</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">1100</span>  <span class="c1"># Ζώνες διέλευσης</span>
<span class="n">delta_f</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># Περιθώριο στις ζώνες αποκοπής για να διασφαλιστεί η επιθυμητή απόσβεση</span>

<span class="c1"># Καθορισμός των ζωνών για το φίλτρο</span>
<span class="c1"># Η δομή είναι [0, f_stop1, f_pass1, f_pass2, f_stop2, Fs/2]</span>
<span class="n">bands</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">-</span> <span class="n">delta_f</span><span class="p">,</span> <span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="n">f2</span> <span class="o">+</span> <span class="n">delta_f</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">Fs</span><span class="p">]</span>

<span class="c1"># Επιθυμητές τιμές στις ζώνες: 0 για τις ζώνες αποκοπής και 1 για τις ζώνες διέλευσης</span>
<span class="n">desired</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="c1"># Καθορισμός των βαρών για κάθε ζώνη, ώστε να δώσουμε περισσότερη έμφαση στις ζώνες αποκοπής</span>
<span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>

<span class="c1"># Εκτίμηση του αριθμού των taps (τάξη του φίλτρου). Μπορεί να χρειαστεί προσαρμογή για βελτιστοποίηση.</span>
<span class="n">numtaps</span> <span class="o">=</span> <span class="mi">400</span>

<span class="c1"># Σχεδιασμός του φίλτρου FIR με την εντολή remez</span>
<span class="n">filter_taps</span> <span class="o">=</span> <span class="n">remez</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="n">bands</span><span class="p">,</span> <span class="n">desired</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">Fs</span><span class="p">)</span>

<span class="c1"># Υπολογισμός της απόκρισης συχνότητας του φίλτρου</span>
<span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">freqz</span><span class="p">(</span><span class="n">filter_taps</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">8000</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">Fs</span><span class="p">)</span>

<span class="c1"># Εμφάνιση της απόκρισης συχνότητας</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Bandpass Filter&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Frequency Response&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency [Hz]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude [dB]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;60 dB Attenuation&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e39e35c2fc2ced3ee338cdb211c1a5ec148471908d51b61d578ff9ab2c439ec2.png" src="../_images/e39e35c2fc2ced3ee338cdb211c1a5ec148471908d51b61d578ff9ab2c439ec2.png" />
</div>
</div>
</section>
</section>
<section id="part-5-application-b4">
<h2>Part 5: Application B4<a class="headerlink" href="#part-5-application-b4" title="Permalink to this heading">#</a></h2>
<p>Design and implement in MATLAB a filter, as in Application A, with two passbands: (0 Hz, 500 Hz) and (1100 Hz, 3000 Hz).</p>
<div class="cell tag_thebe-init tag_hide-code-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">firwin2</span><span class="p">,</span> <span class="n">freqz</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">Fs</span> <span class="o">=</span> <span class="mi">8192</span>  <span class="c1"># Sampling frequency</span>

<span class="c1"># Define our target frequency response.</span>
<span class="c1"># We want to pass frequencies between 0-500 Hz and 1100-3000 Hz.</span>
<span class="n">target_freqs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">1100</span><span class="p">,</span> <span class="mi">1200</span><span class="p">,</span> <span class="mi">2900</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="n">Fs</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>
<span class="n">target_response</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># 1 in passbands, 0 in stopbands</span>

<span class="c1"># Trying with an increased filter order</span>
<span class="n">numtaps</span> <span class="o">=</span> <span class="mi">350</span>  <span class="c1"># Adjust the filter order as needed</span>

<span class="c1"># Design the FIR filter using the firwin2 function</span>
<span class="n">filter_taps</span> <span class="o">=</span> <span class="n">firwin2</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="n">target_freqs</span><span class="p">,</span> <span class="n">target_response</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">Fs</span><span class="p">)</span>

<span class="c1"># Calculate the frequency response of the filter</span>
<span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">freqz</span><span class="p">(</span><span class="n">filter_taps</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">Fs</span><span class="p">)</span>

<span class="c1"># Display the frequency response</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Bandpass Filter with firwin2&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Frequency Response&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency [Hz]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude [dB]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;60 dB Attenuation&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;500 Hz&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">1100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;1100 Hz&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">3000</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;3000 Hz&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c5ebfec2c8dda68d2ccabd3ba3e77f774f4066a05fda92cd93b08fec949b1817.png" src="../_images/c5ebfec2c8dda68d2ccabd3ba3e77f774f4066a05fda92cd93b08fec949b1817.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "ntua-el17840/Interactive-Digital-Communications",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Digcom_Lab1.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Lab Exercise 1</p>
      </div>
    </a>
    <a class="right-next"
       href="Digcom_Lab3.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Εργαστηριακή Άσκηση 3</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1-training">Part 1: Training</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2-theory">Part 2: Theory</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">Exercise</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-3-design-and-implementation-of-filters">Part 3: Design and implementation of filters</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-window-method">The Window Method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#equal-ripple-method">Equal Ripple Method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#experiment">Experiment</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#rectangular-window-simple-truncation-of-h">Rectangular Window (simple truncation of h)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#filter-application">Filter Application</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-4-application-a">Part 4: Application A</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1">Question 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-2">Question 2</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-5-application-b4">Part 5: Application B4</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By ECE - NTUA
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>